<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Project Lab 13. 게시판 개발(무한 스크롤) - 9" /><meta property="og:locale" content="en" /><meta name="description" content="무한 스크롤 게시글 개발 과정을 소개한다." /><meta property="og:description" content="무한 스크롤 게시글 개발 과정을 소개한다." /><link rel="canonical" href="https://scribnote5.github.io/posts/Project-Lab13/" /><meta property="og:url" content="https://scribnote5.github.io/posts/Project-Lab13/" /><meta property="og:site_name" content="끄적이판" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-09-05T00:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Project Lab 13. 게시판 개발(무한 스크롤) - 9" /><meta name="twitter:site" content="@" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"무한 스크롤 게시글 개발 과정을 소개한다.","url":"https://scribnote5.github.io/posts/Project-Lab13/","headline":"Project Lab 13. 게시판 개발(무한 스크롤) - 9","@type":"BlogPosting","dateModified":"2021-06-16T00:00:00+09:00","datePublished":"2020-09-05T00:00:00+09:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://scribnote5.github.io/posts/Project-Lab13/"},"@context":"https://schema.org"}</script><title>Project Lab 13. 게시판 개발(무한 스크롤) - 9 | 끄적이판</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="끄적이판"><meta name="application-name" content="끄적이판"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/banners/home.jpeg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">끄적이판</a></div><div class="site-subtitle font-italic">지금까지 공부한 것을 끄적이는 블로그</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/scribnote5" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['scribnote5','gmail.com'].join('@')" aria-label="email" class="order-4" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-5" > <i class="fas fa-rss"></i> </a> <a href="https://www.linkedin.com/in/daeyoung-song-175486167" aria-label="linkedin" class="order-6" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Project Lab 13. 게시판 개발(무한 스크롤) - 9</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Project Lab 13. 게시판 개발(무한 스크롤) - 9</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> scribnote5 </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sat, Sep 5, 2020, 12:00 AM +0900" >Sep 5, 2020<i class="unloaded">2020-09-05T00:00:00+09:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Wed, Jun 16, 2021, 12:00 AM +0000" >Jun 16, 2021<i class="unloaded">2021-06-16T00:00:00+09:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="5419 words">30 min read</span></div></div><div class="post-content"><ul><li><p>무한 스크롤 게시글 개발 과정을 소개한다.</p><li>github: <a href="https://github.com/scribnote5/lab">https://github.com/scribnote5/lab</a><li><p>github commit: <a href="https://github.com/scribnote5/lab/commit/2efc38ac4ddb4344d3537e7e478fbed9f9adefcd">https://github.com/scribnote5/lab/commit/2efc38ac4ddb4344d3537e7e478fbed9f9adefcd</a></p><li>최신 프로젝트 코드와 형상이 다를 수 있습니다. 게시글 코드는 참고만 하시되, 최신 코드는 github에서 확인 부탁드립니다.</ul><h2 id="무한-스크롤-게시판">무한 스크롤 게시판</h2><ul><li>페이스북의 타임 라인처럼 스크롤이 특정 위치에 도달하면 다음 데이터를 가져와 view에 출력하는 게시판으로서, 모바일 사용자에게 친화적인 UI를 제공한다. 특정 위치에 스크롤이 도달할 때 ajax를 통하여 데이터를 요청하는 과정이 필요하다.<li>리스트 페이지에서 논문 출판 지역(국내, 국제)과 논문 종류(Regular, Poster, Journal 등) 데이터를 검색하는 기능을 radio button으로 제공하며, 해당 기능은 QueryDsl의 동적쿼리(BooleanExpression)로 구현하였다.<li><span style="color:red; font-weight: bold">무한 스크롤 게시판을 구현할 때 가장 중요한 것은 조회한 리스트의 마지막 요소의 idx(pk)다.<span> 스크롤 이벤트가 발생할 때 조회하는 데이터의 시작을 리스트의 마지막 요소의 idx를 사용하여 알 수 있기 때문이다.</span></span></ul><p>출처: <a href="https://victorydntmd.tistory.com/194">https://victorydntmd.tistory.com/194</a></p><h2 id="table-설계">Table 설계</h2><ul><li>프로젝트에서 사용할 논문 게시판 table을 생성한다.</ul><div class="language-sql highlighter-rouge"><div class="code-header"> <span text-data=" Sql "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="n">publication</span> <span class="k">table</span><span class="o">&gt;</span>

<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">publication</span>
<span class="p">(</span>
   <span class="n">idx</span>                <span class="nb">bigint</span> <span class="n">auto_increment</span>    <span class="k">primary</span> <span class="k">key</span><span class="p">,</span>
   <span class="n">created_by</span>         <span class="nb">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span>     <span class="k">null</span><span class="p">,</span>
   <span class="n">created_date</span>       <span class="nb">datetime</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>      <span class="k">null</span><span class="p">,</span>
   <span class="n">last_modified_by</span>   <span class="nb">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span>     <span class="k">null</span><span class="p">,</span>
   <span class="n">last_modified_date</span> <span class="nb">datetime</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>      <span class="k">null</span><span class="p">,</span>
   <span class="n">active_status</span>      <span class="nb">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span>     <span class="k">null</span><span class="p">,</span>
   <span class="n">title</span>              <span class="nb">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span>     <span class="k">null</span><span class="p">,</span>
   <span class="n">authors</span>            <span class="nb">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span>     <span class="k">null</span><span class="p">,</span>
   <span class="n">publication_type</span>   <span class="nb">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span>     <span class="k">null</span><span class="p">,</span>
   <span class="n">publishing_area</span>    <span class="nb">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span>     <span class="k">null</span><span class="p">,</span>
   <span class="n">published_in</span>       <span class="nb">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span>     <span class="k">null</span><span class="p">,</span>
   <span class="n">impact_factor</span>      <span class="nb">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span>     <span class="k">null</span><span class="p">,</span>
   <span class="n">published_date</span>     <span class="nb">datetime</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>      <span class="k">null</span><span class="p">,</span>
   <span class="n">pages</span>              <span class="nb">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span>     <span class="k">null</span><span class="p">,</span>
   <span class="n">volume</span>             <span class="nb">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span>     <span class="k">null</span><span class="p">,</span>
   <span class="n">number</span>             <span class="nb">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span>     <span class="k">null</span><span class="p">,</span>
   <span class="n">doi</span>                <span class="nb">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span>     <span class="k">null</span><span class="p">,</span>
   <span class="n">uri</span>                <span class="nb">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span>     <span class="k">null</span><span class="p">,</span>
   <span class="n">isbn_issn</span>          <span class="nb">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span>     <span class="k">null</span><span class="p">,</span>
   <span class="n">remark</span>             <span class="nb">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span>     <span class="k">null</span>
<span class="p">);</span>
</pre></table></code></div></div><p><br /></p><ul><li>프로젝트에서 사용할 논문 게시판 첨부 파일 table을 생성한다.</ul><div class="language-sql highlighter-rouge"><div class="code-header"> <span text-data=" Sql "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="n">publication_attached_file</span> <span class="k">table</span><span class="o">&gt;</span>

<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">publication_attached_file</span> <span class="p">(</span>
  <span class="n">idx</span>               <span class="nb">bigint</span> <span class="n">auto_increment</span>    <span class="k">primary</span> <span class="k">key</span><span class="p">,</span>
  <span class="n">created_by</span>        <span class="nb">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span>    <span class="k">null</span><span class="p">,</span>
  <span class="n">created_date</span>      <span class="nb">datetime</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>     <span class="k">null</span><span class="p">,</span>
  <span class="n">file_name</span>         <span class="nb">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span>    <span class="k">null</span><span class="p">,</span>
  <span class="n">saved_file_name</span>   <span class="nb">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span>    <span class="k">null</span><span class="p">,</span>
  <span class="n">publication_idx</span>  <span class="nb">bigint</span>          <span class="k">null</span><span class="p">,</span>
  <span class="n">file_size</span>         <span class="nb">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span>    <span class="k">null</span>
<span class="p">);</span>

<span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">publication_attached_file</span> <span class="n">AUTO_INCREMENT</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
<span class="k">DROP</span> <span class="k">TABLE</span> <span class="n">publication_attached_file</span><span class="p">;</span>
</pre></table></code></div></div><h2 id="config">Config</h2><ul><li>View에서 전달한 문자열을 enum 자료형으로 매핑하는 converter을 사용하여, 논문 검색 조건을 문자열 대신 PublicationSearchType enum 자료형으로 받으려고 한다.<li>해당 클래스는 view에서 전달한 문자열을 enum 자료형으로 바인딩하는 사용자 정의 converter다.(View String type -&gt; Controller enum type)</ul><p>출처: <a href="https://medium.com/@lifecluee/string%EC%9D%84-%EA%B3%A0%EC%A7%91%ED%95%98%EB%8A%94-controller-%EA%B0%9C%EC%84%A0%EA%B8%B0-721cba570756">https://medium.com/@lifecluee/string%EC%9D%84-%EA%B3%A0%EC%A7%91%ED%95%98%EB%8A%94-controller-%EA%B0%9C%EC%84%A0%EA%B8%B0-721cba570756</a></p><div class="language-java highlighter-rouge"><div class="code-header"> <span text-data=" Java "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="n">module</span><span class="o">-</span><span class="n">domain</span><span class="o">-</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">java</span><span class="o">/</span><span class="n">kr</span><span class="o">/</span><span class="n">ac</span><span class="o">/</span><span class="n">univ</span><span class="o">/</span><span class="n">common</span><span class="o">/</span><span class="n">converter</span><span class="o">/</span><span class="nc">StringToPublicationSearchType</span><span class="o">.</span><span class="na">java</span><span class="o">&gt;</span>

<span class="kn">package</span> <span class="nn">kr.ac.univ.common.converter</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">kr.ac.univ.publication.dto.enums.PublicationSearchType</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.core.convert.converter.Converter</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">StringToPublicationSearchType</span> <span class="kd">implements</span> <span class="nc">Converter</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">PublicationSearchType</span><span class="o">&gt;</span> <span class="o">{</span>
   <span class="nd">@Override</span>
   <span class="kd">public</span> <span class="nc">PublicationSearchType</span> <span class="nf">convert</span><span class="o">(</span><span class="nc">String</span> <span class="n">source</span><span class="o">)</span> <span class="o">{</span>
       <span class="k">return</span> <span class="nc">PublicationSearchType</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">source</span><span class="o">.</span><span class="na">toUpperCase</span><span class="o">());</span>
   <span class="o">}</span>

<span class="o">}</span>
</pre></table></code></div></div><p><br /></p><ul><li>앞에서 구현한 사용자 정의 StringToPublicationSearchType 클래스(converter)를 module-app-web 모듈과 module-app-api 모듈의 WebConfig 설정 파일에 등록한다.</ul><div class="language-java highlighter-rouge"><div class="code-header"> <span text-data=" Java "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="n">module</span><span class="o">-</span><span class="n">app</span><span class="o">-</span><span class="n">api</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">java</span><span class="o">/</span><span class="n">kr</span><span class="o">/</span><span class="n">ac</span><span class="o">/</span><span class="n">univ</span><span class="o">/</span><span class="n">config</span><span class="o">/</span><span class="nc">WebConfig</span><span class="o">.</span><span class="na">java</span><span class="o">&gt;</span>

<span class="kn">package</span> <span class="nn">kr.ac.univ.config</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">kr.ac.univ.common.converter.StringToPublicationSearchType</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.context.annotation.Configuration</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.format.FormatterRegistry</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.servlet.config.annotation.WebMvcConfigurer</span><span class="o">;</span>

<span class="nd">@Configuration</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">WebConfig</span> <span class="kd">implements</span> <span class="nc">WebMvcConfigurer</span> <span class="o">{</span>
   <span class="nd">@Override</span>
   <span class="kd">public</span> <span class="kt">void</span> <span class="nf">addFormatters</span><span class="o">(</span><span class="nc">FormatterRegistry</span> <span class="n">registry</span><span class="o">)</span> <span class="o">{</span>
       <span class="c1">// PublicationSearchType</span>
       <span class="n">registry</span><span class="o">.</span><span class="na">addConverter</span><span class="o">(</span><span class="k">new</span> <span class="nc">StringToPublicationSearchType</span><span class="o">());</span>
   <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><div class="language-java highlighter-rouge"><div class="code-header"> <span text-data=" Java "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="n">module</span><span class="o">-</span><span class="n">app</span><span class="o">-</span><span class="n">web</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">java</span><span class="o">/</span><span class="n">kr</span><span class="o">/</span><span class="n">ac</span><span class="o">/</span><span class="n">univ</span><span class="o">/</span><span class="n">config</span><span class="o">/</span><span class="nc">WebConfig</span><span class="o">.</span><span class="na">java</span><span class="o">&gt;</span>

<span class="kn">package</span> <span class="nn">kr.ac.univ.config</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">kr.ac.univ.common.converter.StringToPublicationSearchType</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.context.annotation.Configuration</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.format.FormatterRegistry</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.servlet.config.annotation.WebMvcConfigurer</span><span class="o">;</span>

<span class="nd">@Configuration</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">WebConfig</span> <span class="kd">implements</span> <span class="nc">WebMvcConfigurer</span> <span class="o">{</span>
   <span class="nd">@Override</span>
   <span class="kd">public</span> <span class="kt">void</span> <span class="nf">addFormatters</span><span class="o">(</span><span class="nc">FormatterRegistry</span> <span class="n">registry</span><span class="o">)</span> <span class="o">{</span>
       <span class="c1">// PublicationSearchType</span>
       <span class="n">registry</span><span class="o">.</span><span class="na">addConverter</span><span class="o">(</span><span class="k">new</span> <span class="nc">StringToPublicationSearchType</span><span class="o">());</span>
   <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><h2 id="domain-및-dto">Domain 및 DTO</h2><ul><li>Publication에서 사용하는 Domain과 Domain의 enum 자료형이다.</ul><div class="language-java highlighter-rouge"><div class="code-header"> <span text-data=" Java "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="n">module</span><span class="o">-</span><span class="n">domain</span><span class="o">-</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">java</span><span class="o">/</span><span class="n">kr</span><span class="o">/</span><span class="n">ac</span><span class="o">/</span><span class="n">univ</span><span class="o">/</span><span class="n">publication</span><span class="o">/</span><span class="n">domain</span><span class="o">/</span><span class="n">enums</span><span class="o">/</span><span class="nc">PublicationType</span><span class="o">.</span><span class="na">java</span><span class="o">&gt;</span>

<span class="kn">package</span> <span class="nn">kr.ac.univ.publication.domain.enums</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">enum</span> <span class="nc">PublicationType</span> <span class="o">{</span>
    <span class="no">JOURNAL</span><span class="o">(</span><span class="s">"Journal"</span><span class="o">),</span>
    <span class="no">CONFERENCE</span><span class="o">(</span><span class="s">"Conference"</span><span class="o">),</span>

    <span class="c1">// Journal은 KCI, SCOPUS, SCIE로 구분된다.</span>
    <span class="no">JOURNAL_KCI</span><span class="o">(</span><span class="s">"Journal - KCI"</span><span class="o">),</span>
    <span class="no">JOURNAL_SCOPUS</span><span class="o">(</span><span class="s">"Journal - SCOPUS"</span><span class="o">),</span>
    <span class="no">JOURNAL_SCIE</span><span class="o">(</span><span class="s">"Journal - SCIE"</span><span class="o">),</span>

    <span class="c1">// Conference는 Poster, Regular, Demo, Workshop으로 구분된다.</span>
    <span class="no">CONFERENCE_POSTER</span><span class="o">(</span><span class="s">"Conference - Poster"</span><span class="o">),</span>
    <span class="no">CONFERENCE_REGULAR</span><span class="o">(</span><span class="s">"Conference - Regular"</span><span class="o">),</span>
    <span class="no">CONFERENCE_DEMO</span><span class="o">(</span><span class="s">"Conference - Demo"</span><span class="o">),</span>
    <span class="no">CONFERENCE_WORKSHOP</span><span class="o">(</span><span class="s">"Conference - Workshop"</span><span class="o">);</span>

    <span class="kd">private</span> <span class="nc">String</span> <span class="n">publicationType</span><span class="o">;</span>

    <span class="kd">private</span> <span class="nf">PublicationType</span><span class="o">(</span><span class="nc">String</span> <span class="n">publicationType</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">publicationType</span> <span class="o">=</span> <span class="n">publicationType</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getPublicationType</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">publicationType</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><div class="language-java highlighter-rouge"><div class="code-header"> <span text-data=" Java "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="n">module</span><span class="o">-</span><span class="n">domain</span><span class="o">-</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">java</span><span class="o">/</span><span class="n">kr</span><span class="o">/</span><span class="n">ac</span><span class="o">/</span><span class="n">univ</span><span class="o">/</span><span class="n">publication</span><span class="o">/</span><span class="n">domain</span><span class="o">/</span><span class="n">enums</span><span class="o">/</span><span class="nc">PublishingArea</span><span class="o">.</span><span class="na">java</span><span class="o">&gt;</span>

<span class="kn">package</span> <span class="nn">kr.ac.univ.publication.domain.enums</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">enum</span> <span class="nc">PublishingArea</span> <span class="o">{</span>
   <span class="no">INTERNATIONAL</span><span class="o">(</span><span class="s">"International"</span><span class="o">),</span>
   <span class="no">DOMESTIC</span><span class="o">(</span><span class="s">"Domestic"</span><span class="o">);</span>

   <span class="kd">private</span> <span class="nc">String</span> <span class="n">publishingArea</span><span class="o">;</span>

   <span class="kd">private</span> <span class="nf">PublishingArea</span><span class="o">(</span><span class="nc">String</span> <span class="n">publishingArea</span><span class="o">)</span> <span class="o">{</span>
       <span class="k">this</span><span class="o">.</span><span class="na">publishingArea</span> <span class="o">=</span> <span class="n">publishingArea</span><span class="o">;</span>
   <span class="o">}</span>

   <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getPublishingArea</span><span class="o">()</span> <span class="o">{</span>
       <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">publishingArea</span><span class="o">;</span>
   <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p><br /></p><div class="language-java highlighter-rouge"><div class="code-header"> <span text-data=" Java "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="n">module</span><span class="o">-</span><span class="n">domain</span><span class="o">-</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">java</span><span class="o">/</span><span class="n">kr</span><span class="o">/</span><span class="n">ac</span><span class="o">/</span><span class="n">univ</span><span class="o">/</span><span class="n">publication</span><span class="o">/</span><span class="n">domain</span><span class="o">/</span><span class="nc">Publication</span><span class="o">.</span><span class="na">java</span><span class="o">&gt;</span>

<span class="kn">package</span> <span class="nn">kr.ac.univ.publication.domain</span><span class="o">;</span>


<span class="kn">import</span> <span class="nn">java.time.LocalDate</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.persistence.*</span><span class="o">;</span>


<span class="kn">import</span> <span class="nn">kr.ac.univ.common.domain.CommonAudit</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.common.domain.enums.ActiveStatus</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.publication.domain.enums.PublicationType</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.publication.domain.enums.PublishingArea</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.publication.listener.PublicationListener</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.Builder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.Getter</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.NoArgsConstructor</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.ToString</span><span class="o">;</span>

<span class="nd">@Getter</span>
<span class="nd">@NoArgsConstructor</span>
<span class="nd">@Entity</span>
<span class="nd">@Table</span>
<span class="nd">@ToString</span>
<span class="nd">@EntityListeners</span><span class="o">(</span><span class="nc">PublicationListener</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Publication</span> <span class="kd">extends</span> <span class="nc">CommonAudit</span> <span class="o">{</span>
   <span class="kd">private</span> <span class="nc">String</span> <span class="n">title</span><span class="o">;</span>

   <span class="kd">private</span> <span class="nc">String</span> <span class="n">authors</span><span class="o">;</span>

   <span class="nd">@Enumerated</span><span class="o">(</span><span class="nc">EnumType</span><span class="o">.</span><span class="na">STRING</span><span class="o">)</span>
   <span class="kd">private</span> <span class="nc">PublicationType</span> <span class="n">publicationType</span><span class="o">;</span>

   <span class="nd">@Enumerated</span><span class="o">(</span><span class="nc">EnumType</span><span class="o">.</span><span class="na">STRING</span><span class="o">)</span>
   <span class="kd">private</span> <span class="nc">PublishingArea</span> <span class="n">publishingArea</span><span class="o">;</span>

   <span class="kd">private</span> <span class="nc">String</span> <span class="n">publishedIn</span><span class="o">;</span>

   <span class="kd">private</span> <span class="nc">String</span> <span class="n">impactFactor</span><span class="o">;</span>

   <span class="kd">private</span> <span class="nc">LocalDate</span> <span class="n">publishedDate</span><span class="o">;</span>

   <span class="kd">private</span> <span class="nc">String</span> <span class="n">pages</span><span class="o">;</span>

   <span class="kd">private</span> <span class="nc">String</span> <span class="n">volume</span><span class="o">;</span>

   <span class="kd">private</span> <span class="nc">String</span> <span class="n">number</span><span class="o">;</span>

   <span class="kd">private</span> <span class="nc">String</span> <span class="n">doi</span><span class="o">;</span>

   <span class="kd">private</span> <span class="nc">String</span> <span class="n">uri</span><span class="o">;</span>

   <span class="kd">private</span> <span class="nc">String</span> <span class="n">isbnIssn</span><span class="o">;</span>

   <span class="kd">private</span> <span class="nc">String</span> <span class="n">remark</span><span class="o">;</span>

   <span class="nd">@Builder</span>
   <span class="kd">public</span> <span class="nf">Publication</span><span class="o">(</span><span class="nc">Long</span> <span class="n">idx</span><span class="o">,</span> <span class="nc">String</span> <span class="n">createdBy</span><span class="o">,</span> <span class="nc">String</span> <span class="n">lastModifiedBy</span><span class="o">,</span> <span class="nc">String</span> <span class="n">title</span><span class="o">,</span> <span class="nc">ActiveStatus</span> <span class="n">activeStatus</span><span class="o">,</span>
                      <span class="nc">String</span> <span class="n">authors</span><span class="o">,</span> <span class="nc">PublicationType</span> <span class="n">publicationType</span><span class="o">,</span> <span class="nc">PublishingArea</span> <span class="n">publishingArea</span><span class="o">,</span>
                      <span class="nc">String</span> <span class="n">publishedIn</span><span class="o">,</span> <span class="nc">String</span> <span class="n">impactFactor</span><span class="o">,</span> <span class="nc">LocalDate</span> <span class="n">publishedDate</span><span class="o">,</span> <span class="nc">String</span> <span class="n">pages</span><span class="o">,</span> <span class="nc">String</span> <span class="n">volume</span><span class="o">,</span>
                      <span class="nc">String</span> <span class="n">number</span><span class="o">,</span> <span class="nc">String</span> <span class="n">doi</span><span class="o">,</span> <span class="nc">String</span> <span class="n">uri</span><span class="o">,</span> <span class="nc">String</span> <span class="n">isbnIssn</span><span class="o">,</span> <span class="nc">String</span> <span class="n">remark</span><span class="o">)</span> <span class="o">{</span>
       <span class="n">setIdx</span><span class="o">(</span><span class="n">idx</span><span class="o">);</span>
       <span class="n">setCreatedBy</span><span class="o">(</span><span class="n">createdBy</span><span class="o">);</span>
       <span class="n">setLastModifiedBy</span><span class="o">(</span><span class="n">lastModifiedBy</span><span class="o">);</span>
       <span class="n">setActiveStatus</span><span class="o">(</span><span class="n">activeStatus</span><span class="o">);</span>
       <span class="k">this</span><span class="o">.</span><span class="na">title</span> <span class="o">=</span> <span class="n">title</span><span class="o">;</span>
       <span class="k">this</span><span class="o">.</span><span class="na">authors</span> <span class="o">=</span> <span class="n">authors</span><span class="o">;</span>
       <span class="k">this</span><span class="o">.</span><span class="na">publicationType</span> <span class="o">=</span> <span class="n">publicationType</span><span class="o">;</span>
       <span class="k">this</span><span class="o">.</span><span class="na">publishingArea</span> <span class="o">=</span> <span class="n">publishingArea</span><span class="o">;</span>
       <span class="k">this</span><span class="o">.</span><span class="na">publishedIn</span> <span class="o">=</span> <span class="n">publishedIn</span><span class="o">;</span>
       <span class="k">this</span><span class="o">.</span><span class="na">impactFactor</span> <span class="o">=</span> <span class="n">impactFactor</span><span class="o">;</span>
       <span class="k">this</span><span class="o">.</span><span class="na">publishedDate</span> <span class="o">=</span> <span class="n">publishedDate</span><span class="o">;</span>
       <span class="k">this</span><span class="o">.</span><span class="na">pages</span> <span class="o">=</span> <span class="n">pages</span><span class="o">;</span>
       <span class="k">this</span><span class="o">.</span><span class="na">volume</span> <span class="o">=</span> <span class="n">volume</span><span class="o">;</span>
       <span class="k">this</span><span class="o">.</span><span class="na">number</span> <span class="o">=</span> <span class="n">number</span><span class="o">;</span>
       <span class="k">this</span><span class="o">.</span><span class="na">doi</span> <span class="o">=</span> <span class="n">doi</span><span class="o">;</span>
       <span class="k">this</span><span class="o">.</span><span class="na">uri</span> <span class="o">=</span> <span class="n">uri</span><span class="o">;</span>
       <span class="k">this</span><span class="o">.</span><span class="na">isbnIssn</span> <span class="o">=</span> <span class="n">isbnIssn</span><span class="o">;</span>
       <span class="k">this</span><span class="o">.</span><span class="na">remark</span> <span class="o">=</span> <span class="n">remark</span><span class="o">;</span>
   <span class="o">}</span>

   <span class="kd">public</span> <span class="kt">void</span> <span class="nf">update</span><span class="o">(</span><span class="nc">Publication</span> <span class="n">publication</span><span class="o">)</span> <span class="o">{</span>
       <span class="n">setActiveStatus</span><span class="o">(</span><span class="n">publication</span><span class="o">.</span><span class="na">getActiveStatus</span><span class="o">());</span>
       <span class="k">this</span><span class="o">.</span><span class="na">title</span> <span class="o">=</span> <span class="n">publication</span><span class="o">.</span><span class="na">getTitle</span><span class="o">();</span>
       <span class="k">this</span><span class="o">.</span><span class="na">authors</span> <span class="o">=</span> <span class="n">publication</span><span class="o">.</span><span class="na">getAuthors</span><span class="o">();</span>
       <span class="k">this</span><span class="o">.</span><span class="na">publicationType</span> <span class="o">=</span> <span class="n">publication</span><span class="o">.</span><span class="na">getPublicationType</span><span class="o">();</span>
       <span class="k">this</span><span class="o">.</span><span class="na">publishingArea</span> <span class="o">=</span> <span class="n">publication</span><span class="o">.</span><span class="na">getPublishingArea</span><span class="o">();</span>
       <span class="k">this</span><span class="o">.</span><span class="na">publishedIn</span> <span class="o">=</span> <span class="n">publication</span><span class="o">.</span><span class="na">getPublishedIn</span><span class="o">();</span>
       <span class="k">this</span><span class="o">.</span><span class="na">impactFactor</span> <span class="o">=</span> <span class="n">publication</span><span class="o">.</span><span class="na">getImpactFactor</span><span class="o">();</span>
       <span class="k">this</span><span class="o">.</span><span class="na">publishedDate</span> <span class="o">=</span> <span class="n">publication</span><span class="o">.</span><span class="na">getPublishedDate</span><span class="o">();</span>
       <span class="k">this</span><span class="o">.</span><span class="na">pages</span> <span class="o">=</span> <span class="n">publication</span><span class="o">.</span><span class="na">getPages</span><span class="o">();</span>
       <span class="k">this</span><span class="o">.</span><span class="na">volume</span> <span class="o">=</span> <span class="n">publication</span><span class="o">.</span><span class="na">getVolume</span><span class="o">();</span>
       <span class="k">this</span><span class="o">.</span><span class="na">number</span> <span class="o">=</span> <span class="n">publication</span><span class="o">.</span><span class="na">getNumber</span><span class="o">();</span>
       <span class="k">this</span><span class="o">.</span><span class="na">doi</span> <span class="o">=</span> <span class="n">publication</span><span class="o">.</span><span class="na">getDoi</span><span class="o">();</span>
       <span class="k">this</span><span class="o">.</span><span class="na">uri</span> <span class="o">=</span> <span class="n">publication</span><span class="o">.</span><span class="na">getUri</span><span class="o">();</span>
       <span class="k">this</span><span class="o">.</span><span class="na">isbnIssn</span> <span class="o">=</span> <span class="n">publication</span><span class="o">.</span><span class="na">getIsbnIssn</span><span class="o">();</span>
       <span class="k">this</span><span class="o">.</span><span class="na">remark</span> <span class="o">=</span> <span class="n">publication</span><span class="o">.</span><span class="na">getRemark</span><span class="o">();</span>
   <span class="o">}</span>

<span class="o">}</span>
</pre></table></code></div></div><p><br /></p><ul><li>NoticeBoard DTO &lt;-&gt; Entity간 객체 mapping 소스 코드가 Mapstruct에 의해 생성되도록 메소드를 선언 및 정의하는 클래스다.<li>default 메소드는 사용자가 정의한 메소드로, Entity 파일 리스트를 DTO의 파일 리스트로 매핑한다.</ul><div class="language-java highlighter-rouge"><div class="code-header"> <span text-data=" Java "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="n">module</span><span class="o">-</span><span class="n">domain</span><span class="o">-</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">java</span><span class="o">/</span><span class="n">kr</span><span class="o">/</span><span class="n">ac</span><span class="o">/</span><span class="n">univ</span><span class="o">/</span><span class="n">publication</span><span class="o">/</span><span class="n">dto</span><span class="o">/</span><span class="n">mapper</span><span class="o">/</span><span class="nc">PublicationMapper</span><span class="o">.</span><span class="na">java</span><span class="o">&gt;</span>

<span class="kn">package</span> <span class="nn">kr.ac.univ.publication.dto.mapper</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">kr.ac.univ.common.dto.mapper.EntityMapper</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.publication.domain.Publication</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.publication.domain.PublicationAttachedFile</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.publication.dto.PublicationDto</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.mapstruct.Mapper</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.mapstruct.factory.Mappers</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="nd">@Mapper</span><span class="o">(</span><span class="n">componentModel</span> <span class="o">=</span> <span class="s">"spring"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">PublicationMapper</span> <span class="kd">extends</span> <span class="nc">EntityMapper</span><span class="o">&lt;</span><span class="nc">PublicationDto</span><span class="o">,</span> <span class="nc">Publication</span><span class="o">&gt;</span> <span class="o">{</span>
   <span class="nc">PublicationMapper</span> <span class="no">INSTANCE</span> <span class="o">=</span> <span class="nc">Mappers</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="nc">PublicationMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

   <span class="k">default</span> <span class="nc">PublicationDto</span> <span class="nf">toDto</span><span class="o">(</span><span class="nc">PublicationDto</span> <span class="n">publicationDto</span><span class="o">,</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">PublicationAttachedFile</span><span class="o">&gt;</span> <span class="n">attachedFileList</span><span class="o">)</span> <span class="o">{</span>
       <span class="k">for</span> <span class="o">(</span><span class="nc">PublicationAttachedFile</span> <span class="n">attachedFile</span> <span class="o">:</span> <span class="n">attachedFileList</span><span class="o">)</span> <span class="o">{</span>
           <span class="n">publicationDto</span><span class="o">.</span><span class="na">getAttachedFileList</span><span class="o">().</span><span class="na">add</span><span class="o">(</span><span class="n">attachedFile</span><span class="o">);</span>
       <span class="o">}</span>

       <span class="k">return</span> <span class="n">publicationDto</span><span class="o">;</span>
   <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p><br /></p><ul><li>Publication에서 사용하는 DTO다.</ul><div class="language-java highlighter-rouge"><div class="code-header"> <span text-data=" Java "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="n">module</span><span class="o">-</span><span class="n">domain</span><span class="o">-</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">java</span><span class="o">/</span><span class="n">kr</span><span class="o">/</span><span class="n">ac</span><span class="o">/</span><span class="n">univ</span><span class="o">/</span><span class="n">publication</span><span class="o">/</span><span class="n">dto</span><span class="o">/</span><span class="nc">PublicationDto</span><span class="o">.</span><span class="na">java</span><span class="o">&gt;</span>

<span class="kn">package</span> <span class="nn">kr.ac.univ.publication.dto</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.time.LocalDate</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.ArrayList</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">kr.ac.univ.common.dto.CommonDto</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.publication.domain.PublicationAttachedFile</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.publication.domain.enums.PublicationType</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.publication.domain.enums.PublishingArea</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.Getter</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.NoArgsConstructor</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.Setter</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.ToString</span><span class="o">;</span>

<span class="nd">@Getter</span>
<span class="nd">@Setter</span>
<span class="nd">@NoArgsConstructor</span>
<span class="nd">@ToString</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PublicationDto</span> <span class="kd">extends</span> <span class="nc">CommonDto</span> <span class="o">{</span>
   <span class="cm">/* CommonDto: JPA Audit */</span>

   <span class="cm">/* 기본 정보 */</span>
   <span class="kd">private</span> <span class="nc">String</span> <span class="n">title</span><span class="o">;</span>
   <span class="kd">private</span> <span class="nc">String</span> <span class="n">authors</span><span class="o">;</span>
   <span class="kd">private</span> <span class="nc">PublicationType</span> <span class="n">publicationType</span><span class="o">;</span>
   <span class="kd">private</span> <span class="nc">PublishingArea</span> <span class="n">publishingArea</span><span class="o">;</span>
   <span class="kd">private</span> <span class="nc">String</span> <span class="n">publishedIn</span><span class="o">;</span>
   <span class="kd">private</span> <span class="nc">String</span> <span class="n">impactFactor</span><span class="o">;</span>
   <span class="kd">private</span> <span class="nc">LocalDate</span> <span class="n">publishedDate</span><span class="o">;</span>
   <span class="kd">private</span> <span class="nc">String</span> <span class="n">pages</span><span class="o">;</span>
   <span class="kd">private</span> <span class="nc">String</span> <span class="n">volume</span><span class="o">;</span>
   <span class="kd">private</span> <span class="nc">String</span> <span class="n">number</span><span class="o">;</span>
   <span class="kd">private</span> <span class="nc">String</span> <span class="n">doi</span><span class="o">;</span>
   <span class="kd">private</span> <span class="nc">String</span> <span class="n">uri</span><span class="o">;</span>
   <span class="kd">private</span> <span class="nc">String</span> <span class="n">isbnIssn</span><span class="o">;</span>
   <span class="kd">private</span> <span class="nc">String</span> <span class="n">remark</span><span class="o">;</span>

   <span class="cm">/* 첨부 파일 */</span>
   <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">PublicationAttachedFile</span><span class="o">&gt;</span> <span class="n">attachedFileList</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">PublicationAttachedFile</span><span class="o">&gt;();</span>
<span class="o">}</span>
</pre></table></code></div></div><p><br /></p><ul><li>PublicationSearchType enum 자료형은 검색에서 사용되며, View String type -&gt; Controller enum type로 앞에서 등록한 사용자 정의 converter에 의해 변환된다.<li>Publication domain의 논문 종류(PublicationType enum 자료형)와 논문 출판 지역(PublishingArea enum 자료형)의 모든 경우의 수를 하나의 enum 자료형으로 정의하였다.</ul><div class="language-java highlighter-rouge"><div class="code-header"> <span text-data=" Java "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="n">module</span><span class="o">-</span><span class="n">domain</span><span class="o">-</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">java</span><span class="o">/</span><span class="n">kr</span><span class="o">/</span><span class="n">ac</span><span class="o">/</span><span class="n">univ</span><span class="o">/</span><span class="n">publication</span><span class="o">/</span><span class="n">dto</span><span class="o">/</span><span class="n">enums</span><span class="o">/</span><span class="nc">PublicationSearchType</span><span class="o">.</span><span class="na">java</span><span class="o">&gt;</span>

<span class="kn">package</span> <span class="nn">kr.ac.univ.publication.dto.enums</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">enum</span> <span class="nc">PublicationSearchType</span> <span class="o">{</span>
    <span class="no">SHOW_ALL</span><span class="o">(</span><span class="s">"Show All"</span><span class="o">),</span>

    <span class="c1">// International Journal은 KCI, SCOPUS, SCIE로 구분된다.</span>
    <span class="no">INTERNATIONAL_JOURNAL</span><span class="o">(</span><span class="s">"International Journal"</span><span class="o">),</span>
    <span class="no">INTERNATIONAL_JOURNAL_SCOPUS</span><span class="o">(</span><span class="s">"International Journal - SCOPUS"</span><span class="o">),</span>
    <span class="no">INTERNATIONAL_JOURNAL_SCIE</span><span class="o">(</span><span class="s">"International Journal - SCIE"</span><span class="o">),</span>

    <span class="c1">// Conference는 Poster, Regular, Demo, Workshop으로 구분된다.</span>
    <span class="no">INTERNATIONAL_CONFERENCE</span><span class="o">(</span><span class="s">"International Conference"</span><span class="o">),</span>
    <span class="no">INTERNATIONAL_POSTER</span><span class="o">(</span><span class="s">"International Conference - Poster"</span><span class="o">),</span>
    <span class="no">INTERNATIONAL_REGULAR</span><span class="o">(</span><span class="s">"International Conference - Regular"</span><span class="o">),</span>
    <span class="no">INTERNATIONAL_DEMO</span><span class="o">(</span><span class="s">"International Conference - Demo"</span><span class="o">),</span>
    <span class="no">INTERNATIONAL_WORKSHOP</span><span class="o">(</span><span class="s">"International Conference - Workshop"</span><span class="o">),</span>
    <span class="no">INTERNATIONAL_WORKINPROCESSS</span><span class="o">(</span><span class="s">"International Conference - Work In Process"</span><span class="o">),</span>

    <span class="c1">// Domestic Journal은 KCI로 구분된다.</span>
    <span class="no">DOMESTIC_JOURNAL</span><span class="o">(</span><span class="s">"Domestic Journal"</span><span class="o">),</span>
    <span class="no">DOMESTIC_JOURNAL_KCI</span><span class="o">(</span><span class="s">"International Journal - KCI"</span><span class="o">),</span>

    <span class="c1">// Conference는 Poster, Regular, Demo, Workshop으로 구분된다.</span>
    <span class="no">DOMESTIC_CONFERENCE</span><span class="o">(</span><span class="s">"Domestic Conference - Conference"</span><span class="o">),</span>
    <span class="no">DOMESTIC_POSTER</span><span class="o">(</span><span class="s">"Domestic Conference - Poster"</span><span class="o">),</span>
    <span class="no">DOMESTIC_REGULAR</span><span class="o">(</span><span class="s">"Domestic Conference - Regular"</span><span class="o">),</span>
    <span class="no">DOMESTIC_DEMO</span><span class="o">(</span><span class="s">"Domestic Conference - Demo"</span><span class="o">),</span>
    <span class="no">DOMESTIC_WORKSHOP</span><span class="o">(</span><span class="s">"Domestic Conference - Workshop"</span><span class="o">);</span>

    <span class="kd">private</span> <span class="nc">String</span> <span class="n">publicationSearchType</span><span class="o">;</span>

    <span class="kd">private</span> <span class="nf">PublicationSearchType</span><span class="o">(</span><span class="nc">String</span> <span class="n">publicationSearchType</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">publicationSearchType</span> <span class="o">=</span> <span class="n">publicationSearchType</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getSearchPublicationType</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">publicationSearchType</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p><br /></p><ul><li>Publication 검색에서 사용하는 DTO다.<li>검색 종류, 검색 키워드 데이터가 있는 SearchDto를 상속 받았으며, publicationSearchType 멤버 필드는 논문 출판 지역과 논문 종류를 정의한 enum 자료형이다.</ul><div class="language-java highlighter-rouge"><div class="code-header"> <span text-data=" Java "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="n">module</span><span class="o">-</span><span class="n">domain</span><span class="o">-</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">java</span><span class="o">/</span><span class="n">kr</span><span class="o">/</span><span class="n">ac</span><span class="o">/</span><span class="n">univ</span><span class="o">/</span><span class="n">publication</span><span class="o">/</span><span class="n">dto</span><span class="o">/</span><span class="nc">PublicationSearchDto</span><span class="o">.</span><span class="na">java</span><span class="o">&gt;</span>

<span class="kn">package</span> <span class="nn">kr.ac.univ.publication.dto</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">kr.ac.univ.common.dto.SearchDto</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.publication.dto.enums.PublicationSearchType</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.Getter</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.NoArgsConstructor</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.Setter</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.ToString</span><span class="o">;</span>

<span class="nd">@Getter</span>
<span class="nd">@Setter</span>
<span class="nd">@NoArgsConstructor</span>
<span class="nd">@ToString</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PublicationSearchDto</span> <span class="kd">extends</span> <span class="nc">SearchDto</span> <span class="o">{</span>
   <span class="cm">/* 검색 정보 */</span>
   <span class="kd">private</span> <span class="nc">PublicationSearchType</span> <span class="n">publicationSearchType</span> <span class="o">=</span> <span class="nc">PublicationSearchType</span><span class="o">.</span><span class="na">SHOW_ALL</span><span class="o">;</span>
<span class="o">}</span>
</pre></table></code></div></div><h2 id="repository">Repository</h2><ul><li>QueryDsl를 사용하여 다음과 같은 쿼리를 작성하였다.<li>findTop10: lastIdx(조회한 리스트의 마지막 요소의 idx)보다 작거나 같은 데이터를 10개 조회한다.(테스트 용도)<li>findMaxPublicationIdx: 논문 idx의 최대값을 조회한다.<li>findTop15ByPublicationSearchDto: lastIdx(조회한 리스트의 마지막 요소의 idx)보다 작거나 같고 PublicationSearchDto를 비교하여 조건에 일치하는 리스트를 15개 조회한다. QueryDsl은 BooleanExpression을 통하여 동적 쿼리를 사용할 수 있으며, 해당 쿼리에 적용된 동적 조건은 2가지다. eqSearchType는 검색 종류와 검색 키워드를, eqPublicationSearchType는 논문 출판 지역과 논문 종류를 각 조건을 판별한다.</ul><div class="language-java highlighter-rouge"><div class="code-header"> <span text-data=" Java "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="n">module</span><span class="o">-</span><span class="n">domain</span><span class="o">-</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">java</span><span class="o">/</span><span class="n">kr</span><span class="o">/</span><span class="n">ac</span><span class="o">/</span><span class="n">univ</span><span class="o">/</span><span class="n">publication</span><span class="o">/</span><span class="n">repository</span><span class="o">/</span><span class="nc">PublicationRepositoryImpl</span><span class="o">.</span><span class="na">java</span><span class="o">&gt;</span>

<span class="kn">package</span> <span class="nn">kr.ac.univ.publication.repository</span><span class="o">;</span>


<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.transaction.Transactional</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.querydsl.core.types.dsl.BooleanExpression</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.publication.domain.Publication</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.publication.domain.QPublication</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.publication.domain.enums.PublicationType</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.publication.domain.enums.PublishingArea</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.publication.dto.PublicationSearchDto</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.publication.dto.enums.PublicationSearchType</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.data.jpa.repository.support.QuerydslRepositorySupport</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Repository</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">static</span> <span class="n">kr</span><span class="o">.</span><span class="na">ac</span><span class="o">.</span><span class="na">univ</span><span class="o">.</span><span class="na">publication</span><span class="o">.</span><span class="na">domain</span><span class="o">.</span><span class="na">QPublication</span><span class="o">.</span><span class="na">publication</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.querydsl.jpa.impl.JPAQueryFactory</span><span class="o">;</span>


<span class="nd">@Repository</span>
<span class="nd">@Transactional</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PublicationRepositoryImpl</span> <span class="kd">extends</span> <span class="nc">QuerydslRepositorySupport</span> <span class="o">{</span>
   <span class="kd">private</span> <span class="kd">final</span> <span class="nc">JPAQueryFactory</span> <span class="n">queryFactory</span><span class="o">;</span>

   <span class="kd">public</span> <span class="nf">PublicationRepositoryImpl</span><span class="o">(</span><span class="nc">JPAQueryFactory</span> <span class="n">queryFactory</span><span class="o">)</span> <span class="o">{</span>
       <span class="kd">super</span><span class="o">(</span><span class="nc">Publication</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
       <span class="k">this</span><span class="o">.</span><span class="na">queryFactory</span> <span class="o">=</span> <span class="n">queryFactory</span><span class="o">;</span>
   <span class="o">}</span>

   <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Publication</span><span class="o">&gt;</span> <span class="nf">findTop10</span><span class="o">(</span><span class="nc">Long</span> <span class="n">lastIdx</span><span class="o">)</span> <span class="o">{</span>
       <span class="cm">/* SELECT *
        *   FROM publication
        *  WHERE idx &lt; 'lastIdx'
        *  LIMIT 10
        */</span>
       <span class="k">return</span> <span class="n">queryFactory</span>
               <span class="o">.</span><span class="na">selectFrom</span><span class="o">(</span><span class="n">publication</span><span class="o">)</span>
               <span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="n">publication</span><span class="o">.</span><span class="na">idx</span><span class="o">.</span><span class="na">loe</span><span class="o">(</span><span class="n">lastIdx</span><span class="o">))</span>
               <span class="o">.</span><span class="na">orderBy</span><span class="o">(</span><span class="n">publication</span><span class="o">.</span><span class="na">idx</span><span class="o">.</span><span class="na">desc</span><span class="o">())</span>
               <span class="o">.</span><span class="na">limit</span><span class="o">(</span><span class="mi">10</span><span class="o">)</span>
               <span class="o">.</span><span class="na">fetch</span><span class="o">();</span>
   <span class="o">}</span>


   <span class="kd">public</span> <span class="nc">Publication</span> <span class="nf">findMaxPublicationIdx</span><span class="o">()</span> <span class="o">{</span>
       <span class="cm">/*
        * SELECT MAX(idx)
        * FROM publication
        */</span>
       <span class="k">return</span> <span class="n">queryFactory</span>
               <span class="o">.</span><span class="na">selectFrom</span><span class="o">(</span><span class="n">publication</span><span class="o">)</span>
               <span class="o">.</span><span class="na">orderBy</span><span class="o">(</span><span class="n">publication</span><span class="o">.</span><span class="na">idx</span><span class="o">.</span><span class="na">desc</span><span class="o">())</span>
               <span class="o">.</span><span class="na">fetchFirst</span><span class="o">();</span>
   <span class="o">}</span>

   <span class="kd">private</span> <span class="nc">BooleanExpression</span> <span class="nf">eqSearchType</span><span class="o">(</span><span class="nc">PublicationSearchDto</span> <span class="n">publicationSearchDto</span><span class="o">)</span> <span class="o">{</span>
       <span class="cm">/*
        * SELECT *
        * FROM publication
        * WHERE searchType LIKE '%keyword%';
        */</span>
       <span class="nc">BooleanExpression</span> <span class="n">result</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

       <span class="k">switch</span> <span class="o">(</span><span class="n">publicationSearchDto</span><span class="o">.</span><span class="na">getSearchType</span><span class="o">())</span> <span class="o">{</span>
           <span class="k">case</span> <span class="s">"TITLE"</span><span class="o">:</span>
               <span class="n">result</span> <span class="o">=</span> <span class="n">publication</span><span class="o">.</span><span class="na">title</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="n">publicationSearchDto</span><span class="o">.</span><span class="na">getKeyword</span><span class="o">());</span>
               <span class="k">break</span><span class="o">;</span>
           <span class="k">case</span> <span class="s">"AUTHORS"</span><span class="o">:</span>
               <span class="n">result</span> <span class="o">=</span> <span class="n">publication</span><span class="o">.</span><span class="na">authors</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="n">publicationSearchDto</span><span class="o">.</span><span class="na">getKeyword</span><span class="o">());</span>
               <span class="k">break</span><span class="o">;</span>
           <span class="k">case</span> <span class="s">"PUBLISHED_IN"</span><span class="o">:</span>
               <span class="n">result</span> <span class="o">=</span> <span class="n">publication</span><span class="o">.</span><span class="na">publishedIn</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="n">publicationSearchDto</span><span class="o">.</span><span class="na">getKeyword</span><span class="o">());</span>
               <span class="k">break</span><span class="o">;</span>
           <span class="k">default</span><span class="o">:</span>
               <span class="k">break</span><span class="o">;</span>
       <span class="o">}</span>

       <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
   <span class="o">}</span>

   <span class="kd">private</span> <span class="nc">BooleanExpression</span> <span class="nf">eqPublicationSearchType</span><span class="o">(</span><span class="nc">PublicationSearchDto</span> <span class="n">publicationSearchDto</span><span class="o">)</span> <span class="o">{</span>
       <span class="cm">/*
        * SELECT *
        *   FROM publication
        *  WHERE publishing_area = 'publishingArea'
        *    AND publication_type = 'publicationType'
        */</span>
       <span class="nc">BooleanExpression</span> <span class="n">result</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

       <span class="k">if</span><span class="o">(</span><span class="n">publicationSearchDto</span><span class="o">.</span><span class="na">getPublicationSearchType</span><span class="o">()</span> <span class="o">==</span> <span class="nc">PublicationSearchType</span><span class="o">.</span><span class="na">INTERNATIONAL_JOURNAL</span><span class="o">)</span> <span class="o">{</span>
           <span class="n">result</span> <span class="o">=</span> <span class="n">publication</span><span class="o">.</span><span class="na">publishingArea</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="nc">PublishingArea</span><span class="o">.</span><span class="na">INTERNATIONAL</span><span class="o">).</span><span class="na">and</span><span class="o">(</span><span class="n">publication</span><span class="o">.</span><span class="na">publicationType</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="nc">PublicationType</span><span class="o">.</span><span class="na">JOURNAL</span><span class="o">));</span>
       <span class="o">}</span>
       <span class="k">else</span> <span class="nf">if</span> <span class="o">(</span><span class="n">publicationSearchDto</span><span class="o">.</span><span class="na">getPublicationSearchType</span><span class="o">()</span> <span class="o">==</span> <span class="nc">PublicationSearchType</span><span class="o">.</span><span class="na">INTERNATIONAL_CONFERENCE</span><span class="o">){</span>
           <span class="n">result</span> <span class="o">=</span> <span class="n">publication</span><span class="o">.</span><span class="na">publishingArea</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="nc">PublishingArea</span><span class="o">.</span><span class="na">INTERNATIONAL</span><span class="o">).</span><span class="na">and</span><span class="o">(</span><span class="n">publication</span><span class="o">.</span><span class="na">publicationType</span><span class="o">.</span><span class="na">ne</span><span class="o">(</span><span class="nc">PublicationType</span><span class="o">.</span><span class="na">JOURNAL</span><span class="o">));</span>
       <span class="o">}</span>
       <span class="k">else</span> <span class="nf">if</span> <span class="o">(</span><span class="n">publicationSearchDto</span><span class="o">.</span><span class="na">getPublicationSearchType</span><span class="o">()</span> <span class="o">==</span> <span class="nc">PublicationSearchType</span><span class="o">.</span><span class="na">DOMESTIC_JOURNAL</span><span class="o">){</span>
           <span class="n">result</span> <span class="o">=</span> <span class="n">publication</span><span class="o">.</span><span class="na">publishingArea</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="nc">PublishingArea</span><span class="o">.</span><span class="na">DOMESTIC</span><span class="o">).</span><span class="na">and</span><span class="o">(</span><span class="n">publication</span><span class="o">.</span><span class="na">publicationType</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="nc">PublicationType</span><span class="o">.</span><span class="na">JOURNAL</span><span class="o">));</span>
       <span class="o">}</span>
       <span class="k">else</span> <span class="nf">if</span> <span class="o">(</span><span class="n">publicationSearchDto</span><span class="o">.</span><span class="na">getPublicationSearchType</span><span class="o">()</span> <span class="o">==</span> <span class="nc">PublicationSearchType</span><span class="o">.</span><span class="na">DOMESTIC_CONFERENCE</span><span class="o">){</span>
           <span class="n">result</span> <span class="o">=</span> <span class="n">publication</span><span class="o">.</span><span class="na">publishingArea</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="nc">PublishingArea</span><span class="o">.</span><span class="na">DOMESTIC</span><span class="o">).</span><span class="na">and</span><span class="o">(</span><span class="n">publication</span><span class="o">.</span><span class="na">publicationType</span><span class="o">.</span><span class="na">ne</span><span class="o">(</span><span class="nc">PublicationType</span><span class="o">.</span><span class="na">JOURNAL</span><span class="o">));</span>
       <span class="o">}</span>

       <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
   <span class="o">}</span>

   <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Publication</span><span class="o">&gt;</span> <span class="nf">findTop10ByPublicationSearchDto</span><span class="o">(</span><span class="nc">Long</span> <span class="n">lastIdx</span><span class="o">,</span> <span class="nc">PublicationSearchDto</span> <span class="n">publicationSearchDto</span><span class="o">)</span> <span class="o">{</span>
       <span class="nc">QPublication</span> <span class="n">publication</span> <span class="o">=</span> <span class="nc">QPublication</span><span class="o">.</span><span class="na">publication</span><span class="o">;</span>
       <span class="cm">/*
        * SELECT *
        *   FROM publication
        *  WHERE idx &lt;= lastIdx
        *    AND publishing_area = 'INTERNATIONAL'
        *    AND publication_type = 'JOURNAL'
        *    AND title LIKE '%'
        *  LIMIT 10;
        */</span>
       <span class="k">return</span> <span class="n">queryFactory</span>
               <span class="o">.</span><span class="na">selectFrom</span><span class="o">(</span><span class="n">publication</span><span class="o">)</span>
               <span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="n">publication</span><span class="o">.</span><span class="na">idx</span><span class="o">.</span><span class="na">loe</span><span class="o">(</span><span class="n">lastIdx</span><span class="o">),</span>
                       <span class="n">eqSearchType</span><span class="o">(</span><span class="n">publicationSearchDto</span><span class="o">),</span>
                       <span class="n">eqPublicationSearchType</span><span class="o">(</span><span class="n">publicationSearchDto</span><span class="o">))</span>
               <span class="o">.</span><span class="na">orderBy</span><span class="o">(</span><span class="n">publication</span><span class="o">.</span><span class="na">idx</span><span class="o">.</span><span class="na">desc</span><span class="o">())</span>
               <span class="o">.</span><span class="na">limit</span><span class="o">(</span><span class="mi">10</span><span class="o">)</span>
               <span class="o">.</span><span class="na">fetch</span><span class="o">();</span>
   <span class="o">}</span>

<span class="o">}</span>
</pre></table></code></div></div><h2 id="service">Service</h2><ul><li>Publication의 비즈니스 로직이다.<li>findPublicationListScroll: 무한 스크롤 게시판에서 스크롤 이벤트가 발생할 때 사용된다.</ul><div class="language-java highlighter-rouge"><div class="code-header"> <span text-data=" Java "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="n">module</span><span class="o">-</span><span class="n">domain</span><span class="o">-</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">java</span><span class="o">/</span><span class="n">kr</span><span class="o">/</span><span class="n">ac</span><span class="o">/</span><span class="n">univ</span><span class="o">/</span><span class="n">publication</span><span class="o">/</span><span class="n">service</span><span class="o">/</span><span class="nc">PublicationService</span><span class="o">.</span><span class="na">java</span><span class="o">&gt;</span>

<span class="kn">package</span> <span class="nn">kr.ac.univ.publication.service</span><span class="o">;</span>


<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">kr.ac.univ.common.dto.SearchDto</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.noticeBoard.domain.NoticeBoard</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.noticeBoard.dto.NoticeBoardDto</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.noticeBoard.dto.mapper.NoticeBoardMapper</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.publication.domain.Publication</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.publication.domain.enums.PublicationType</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.publication.domain.enums.PublishingArea</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.publication.dto.PublicationDto</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.publication.dto.PublicationSearchDto</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.publication.dto.enums.PublicationSearchType</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.publication.dto.mapper.PublicationMapper</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.publication.repository.PublicationRepository</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.publication.repository.PublicationRepositoryImpl</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.user.repository.UserRepository</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.util.AccessCheck</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.data.domain.Page</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.data.domain.PageImpl</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.data.domain.PageRequest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.data.domain.Pageable</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.data.domain.Sort</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Service</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.transaction.Transactional</span><span class="o">;</span>


<span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PublicationService</span> <span class="o">{</span>
   <span class="kd">private</span> <span class="kd">final</span> <span class="nc">PublicationRepository</span> <span class="n">publicationRepository</span><span class="o">;</span>
   <span class="kd">private</span> <span class="kd">final</span> <span class="nc">PublicationRepositoryImpl</span> <span class="n">publicationRepositoryImpl</span><span class="o">;</span>
   <span class="kd">private</span> <span class="kd">final</span> <span class="nc">UserRepository</span> <span class="n">userRepository</span><span class="o">;</span>

   <span class="kd">public</span> <span class="nf">PublicationService</span><span class="o">(</span><span class="nc">PublicationRepository</span> <span class="n">publicationRepository</span><span class="o">,</span> <span class="nc">PublicationRepositoryImpl</span> <span class="n">publicationRepositoryImpl</span><span class="o">,</span> <span class="nc">UserRepository</span> <span class="n">userRepository</span><span class="o">)</span> <span class="o">{</span>
       <span class="k">this</span><span class="o">.</span><span class="na">publicationRepository</span> <span class="o">=</span> <span class="n">publicationRepository</span><span class="o">;</span>
       <span class="k">this</span><span class="o">.</span><span class="na">publicationRepositoryImpl</span> <span class="o">=</span> <span class="n">publicationRepositoryImpl</span><span class="o">;</span>
       <span class="k">this</span><span class="o">.</span><span class="na">userRepository</span> <span class="o">=</span> <span class="n">userRepository</span><span class="o">;</span>
   <span class="o">}</span>

   <span class="kd">public</span> <span class="nc">Page</span><span class="o">&lt;</span><span class="nc">PublicationDto</span><span class="o">&gt;</span> <span class="nf">findPublicationList</span><span class="o">(</span><span class="nc">Pageable</span> <span class="n">pageable</span><span class="o">,</span> <span class="nc">PublicationSearchDto</span> <span class="n">publicationSearchDto</span><span class="o">)</span> <span class="o">{</span>
       <span class="nc">Page</span><span class="o">&lt;</span><span class="nc">Publication</span><span class="o">&gt;</span> <span class="n">publicationList</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
       <span class="nc">Page</span><span class="o">&lt;</span><span class="nc">PublicationDto</span><span class="o">&gt;</span> <span class="n">publicationDtoList</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

       <span class="n">pageable</span> <span class="o">=</span> <span class="nc">PageRequest</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">pageable</span><span class="o">.</span><span class="na">getPageNumber</span><span class="o">()</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="n">pageable</span><span class="o">.</span><span class="na">getPageNumber</span><span class="o">()</span> <span class="o">-</span> <span class="mi">1</span><span class="o">,</span> <span class="n">pageable</span><span class="o">.</span><span class="na">getPageSize</span><span class="o">(),</span> <span class="nc">Sort</span><span class="o">.</span><span class="na">Direction</span><span class="o">.</span><span class="na">DESC</span><span class="o">,</span> <span class="s">"idx"</span><span class="o">);</span>

       <span class="k">if</span><span class="o">(</span><span class="s">"Show All"</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">publicationSearchDto</span><span class="o">.</span><span class="na">getPublicationSearchType</span><span class="o">().</span><span class="na">getSearchPublicationType</span><span class="o">()))</span> <span class="o">{</span>
           <span class="k">switch</span> <span class="o">(</span><span class="n">publicationSearchDto</span><span class="o">.</span><span class="na">getSearchType</span><span class="o">())</span> <span class="o">{</span>
               <span class="k">case</span> <span class="s">"TITLE"</span><span class="o">:</span>
                   <span class="n">publicationList</span> <span class="o">=</span> <span class="n">publicationRepository</span><span class="o">.</span><span class="na">findAllByTitleContaining</span><span class="o">(</span><span class="n">pageable</span><span class="o">,</span> <span class="n">publicationSearchDto</span><span class="o">.</span><span class="na">getKeyword</span><span class="o">());</span>
                   <span class="k">break</span><span class="o">;</span>
               <span class="k">case</span> <span class="s">"AUTHORS"</span><span class="o">:</span>
                   <span class="n">publicationList</span> <span class="o">=</span> <span class="n">publicationRepository</span><span class="o">.</span><span class="na">findAllByAuthorsContaining</span><span class="o">(</span><span class="n">pageable</span><span class="o">,</span> <span class="n">publicationSearchDto</span><span class="o">.</span><span class="na">getKeyword</span><span class="o">());</span>
                   <span class="k">break</span><span class="o">;</span>
               <span class="k">case</span> <span class="s">"PUBLISHED_IN"</span><span class="o">:</span>
                   <span class="n">publicationList</span> <span class="o">=</span> <span class="n">publicationRepository</span><span class="o">.</span><span class="na">findAllByPublishedInContaining</span><span class="o">(</span><span class="n">pageable</span><span class="o">,</span> <span class="n">publicationSearchDto</span><span class="o">.</span><span class="na">getKeyword</span><span class="o">());</span>
                   <span class="k">break</span><span class="o">;</span>
               <span class="k">default</span><span class="o">:</span>
                   <span class="n">publicationList</span> <span class="o">=</span> <span class="n">publicationRepository</span><span class="o">.</span><span class="na">findAll</span><span class="o">(</span><span class="n">pageable</span><span class="o">);</span>
                   <span class="k">break</span><span class="o">;</span>
           <span class="o">}</span>
       <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
           <span class="nc">String</span><span class="o">[]</span> <span class="n">str</span> <span class="o">=</span> <span class="n">publicationSearchDto</span><span class="o">.</span><span class="na">getPublicationSearchType</span><span class="o">().</span><span class="na">getSearchPublicationType</span><span class="o">().</span><span class="na">split</span><span class="o">(</span><span class="s">" "</span><span class="o">);</span>

           <span class="nc">PublishingArea</span> <span class="n">publishingArea</span> <span class="o">=</span> <span class="nc">PublishingArea</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">str</span><span class="o">[</span><span class="mi">0</span><span class="o">].</span><span class="na">toUpperCase</span><span class="o">());</span>
           <span class="nc">PublicationType</span> <span class="n">publicationType</span> <span class="o">=</span> <span class="nc">PublicationType</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">str</span><span class="o">[</span><span class="mi">1</span><span class="o">].</span><span class="na">toUpperCase</span><span class="o">());</span>

           <span class="k">switch</span> <span class="o">(</span><span class="n">publicationSearchDto</span><span class="o">.</span><span class="na">getSearchType</span><span class="o">())</span> <span class="o">{</span>
               <span class="k">case</span> <span class="s">"TITLE"</span><span class="o">:</span>
                   <span class="n">publicationList</span> <span class="o">=</span> <span class="n">publicationRepository</span><span class="o">.</span><span class="na">findAllByTitleContainingAndPublicationTypeAndPublishingArea</span><span class="o">(</span><span class="n">pageable</span><span class="o">,</span> <span class="n">publicationSearchDto</span><span class="o">.</span><span class="na">getKeyword</span><span class="o">(),</span> <span class="n">publicationType</span><span class="o">,</span> <span class="n">publishingArea</span><span class="o">);</span>
                   <span class="k">break</span><span class="o">;</span>
               <span class="k">case</span> <span class="s">"AUTHORS"</span><span class="o">:</span>
                   <span class="n">publicationList</span> <span class="o">=</span> <span class="n">publicationRepository</span><span class="o">.</span><span class="na">findAllByAuthorsContainingAndPublicationTypeAndPublishingArea</span><span class="o">(</span><span class="n">pageable</span><span class="o">,</span> <span class="n">publicationSearchDto</span><span class="o">.</span><span class="na">getKeyword</span><span class="o">(),</span> <span class="n">publicationType</span><span class="o">,</span> <span class="n">publishingArea</span><span class="o">);</span>
                   <span class="k">break</span><span class="o">;</span>
               <span class="k">case</span> <span class="s">"PUBLISHED_IN"</span><span class="o">:</span>
                   <span class="n">publicationList</span> <span class="o">=</span> <span class="n">publicationRepository</span><span class="o">.</span><span class="na">findAllByPublishedInContainingAndPublicationTypeAndPublishingArea</span><span class="o">(</span><span class="n">pageable</span><span class="o">,</span> <span class="n">publicationSearchDto</span><span class="o">.</span><span class="na">getKeyword</span><span class="o">(),</span> <span class="n">publicationType</span><span class="o">,</span> <span class="n">publishingArea</span><span class="o">);</span>
                   <span class="k">break</span><span class="o">;</span>
               <span class="k">default</span><span class="o">:</span>
                   <span class="n">publicationList</span> <span class="o">=</span> <span class="n">publicationRepository</span><span class="o">.</span><span class="na">findAllByPublicationTypeAndPublishingArea</span><span class="o">(</span><span class="n">pageable</span><span class="o">,</span> <span class="n">publicationType</span><span class="o">,</span> <span class="n">publishingArea</span><span class="o">);</span>
                   <span class="k">break</span><span class="o">;</span>
           <span class="o">}</span>
       <span class="o">}</span>

       <span class="n">publicationDtoList</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">PageImpl</span><span class="o">&lt;</span><span class="nc">PublicationDto</span><span class="o">&gt;(</span><span class="nc">PublicationMapper</span><span class="o">.</span><span class="na">INSTANCE</span><span class="o">.</span><span class="na">toDto</span><span class="o">(</span><span class="n">publicationList</span><span class="o">.</span><span class="na">getContent</span><span class="o">()),</span> <span class="n">pageable</span><span class="o">,</span> <span class="n">publicationList</span><span class="o">.</span><span class="na">getTotalElements</span><span class="o">());</span>

       <span class="k">return</span> <span class="n">publicationDtoList</span><span class="o">;</span>
   <span class="o">}</span>

   <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">PublicationDto</span><span class="o">&gt;</span> <span class="nf">findPublicationListScroll</span><span class="o">(</span><span class="nc">Long</span> <span class="n">lastIdx</span><span class="o">,</span> <span class="nc">PublicationSearchDto</span> <span class="n">publicationSearchDto</span><span class="o">)</span> <span class="o">{</span>
       <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Publication</span><span class="o">&gt;</span> <span class="n">publicationList</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
       <span class="nc">List</span><span class="o">&lt;</span><span class="nc">PublicationDto</span><span class="o">&gt;</span> <span class="n">publicationDtoList</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

       <span class="n">publicationList</span> <span class="o">=</span> <span class="n">publicationRepositoryImpl</span><span class="o">.</span><span class="na">findTop10ByPublicationSearchDto</span><span class="o">(</span><span class="n">lastIdx</span><span class="o">,</span> <span class="n">publicationSearchDto</span><span class="o">);</span>

       <span class="c1">// Publication -&gt; PublicationDto</span>
       <span class="n">publicationDtoList</span> <span class="o">=</span> <span class="nc">PublicationMapper</span><span class="o">.</span><span class="na">INSTANCE</span><span class="o">.</span><span class="na">toDto</span><span class="o">(</span><span class="n">publicationList</span><span class="o">);</span>

       <span class="k">return</span> <span class="n">publicationDtoList</span><span class="o">;</span>
   <span class="o">}</span>

   <span class="kd">public</span> <span class="nc">Long</span> <span class="nf">insertPublication</span><span class="o">(</span><span class="nc">Publication</span> <span class="n">publication</span><span class="o">)</span> <span class="o">{</span>

       <span class="k">return</span> <span class="n">publicationRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">publication</span><span class="o">).</span><span class="na">getIdx</span><span class="o">();</span>
   <span class="o">}</span>

   <span class="kd">public</span> <span class="nc">PublicationDto</span> <span class="nf">findPublicationByIdx</span><span class="o">(</span><span class="nc">Long</span> <span class="n">idx</span><span class="o">)</span> <span class="o">{</span>
       <span class="nc">PublicationDto</span> <span class="n">publicationDto</span> <span class="o">=</span> <span class="nc">PublicationMapper</span><span class="o">.</span><span class="na">INSTANCE</span><span class="o">.</span><span class="na">toDto</span><span class="o">(</span><span class="n">publicationRepository</span><span class="o">.</span><span class="na">findById</span><span class="o">(</span><span class="n">idx</span><span class="o">).</span><span class="na">orElse</span><span class="o">(</span><span class="k">new</span> <span class="nc">Publication</span><span class="o">()));</span>

       <span class="c1">// 권한 설정</span>
       <span class="c1">// Register: 로그인한 사용자 Register 접근 가능</span>
       <span class="k">if</span> <span class="o">(</span><span class="n">idx</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
           <span class="n">publicationDto</span><span class="o">.</span><span class="na">setAccess</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
       <span class="o">}</span>
       <span class="c1">// Update: isAccess 메소드에 따라 접근 가능 및 불가</span>
       <span class="k">else</span> <span class="nf">if</span> <span class="o">(</span><span class="nc">AccessCheck</span><span class="o">.</span><span class="na">isAccess</span><span class="o">(</span><span class="n">publicationDto</span><span class="o">.</span><span class="na">getCreatedBy</span><span class="o">(),</span> <span class="n">userRepository</span><span class="o">.</span><span class="na">findByUsername</span><span class="o">(</span><span class="n">publicationDto</span><span class="o">.</span><span class="na">getCreatedBy</span><span class="o">()).</span><span class="na">getAuthorityType</span><span class="o">().</span><span class="na">getAuthorityType</span><span class="o">()))</span> <span class="o">{</span>
           <span class="n">publicationDto</span><span class="o">.</span><span class="na">setAccess</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
       <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
           <span class="n">publicationDto</span><span class="o">.</span><span class="na">setAccess</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span>
       <span class="o">}</span>

       <span class="k">return</span> <span class="n">publicationDto</span><span class="o">;</span>
   <span class="o">}</span>

   <span class="nd">@Transactional</span>
   <span class="kd">public</span> <span class="nc">Long</span> <span class="nf">updatePublication</span><span class="o">(</span><span class="nc">Long</span> <span class="n">idx</span><span class="o">,</span> <span class="nc">PublicationDto</span> <span class="n">publicationDto</span><span class="o">)</span> <span class="o">{</span>
       <span class="nc">Publication</span> <span class="n">persistPublication</span> <span class="o">=</span> <span class="n">publicationRepository</span><span class="o">.</span><span class="na">getOne</span><span class="o">(</span><span class="n">idx</span><span class="o">);</span>
       <span class="nc">Publication</span> <span class="n">publication</span> <span class="o">=</span> <span class="nc">PublicationMapper</span><span class="o">.</span><span class="na">INSTANCE</span><span class="o">.</span><span class="na">toEntity</span><span class="o">(</span><span class="n">publicationDto</span><span class="o">);</span>

       <span class="n">persistPublication</span><span class="o">.</span><span class="na">update</span><span class="o">(</span><span class="n">publication</span><span class="o">);</span>

       <span class="k">return</span> <span class="n">publicationRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">publication</span><span class="o">).</span><span class="na">getIdx</span><span class="o">();</span>
   <span class="o">}</span>


   <span class="kd">public</span> <span class="nc">Long</span> <span class="nf">findMaxPublicationIdx</span><span class="o">()</span> <span class="o">{</span>
       <span class="k">return</span> <span class="n">publicationRepositoryImpl</span><span class="o">.</span><span class="na">findMaxPublicationIdx</span><span class="o">().</span><span class="na">getIdx</span><span class="o">();</span>
   <span class="o">}</span>

   <span class="kd">public</span> <span class="kt">void</span> <span class="nf">deletePublicationByIdx</span><span class="o">(</span><span class="nc">Long</span> <span class="n">idx</span><span class="o">)</span> <span class="o">{</span>
       <span class="n">publicationRepository</span><span class="o">.</span><span class="na">deleteById</span><span class="o">(</span><span class="n">idx</span><span class="o">);</span>
   <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><h2 id="controller">Controller</h2><ul><li>Publication 관련 클라이언트의 요청을 view로 매핑한다.<li>publicationHomeList: 무한 스크롤 게시판에 접근할 때 응답한다.</ul><div class="language-java highlighter-rouge"><div class="code-header"> <span text-data=" Java "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="n">module</span><span class="o">-</span><span class="n">app</span><span class="o">-</span><span class="n">web</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">java</span><span class="o">/</span><span class="n">kr</span><span class="o">/</span><span class="n">ac</span><span class="o">/</span><span class="n">univ</span><span class="o">/</span><span class="n">controller</span><span class="o">/</span><span class="nc">PublicationController</span><span class="o">.</span><span class="na">java</span><span class="o">&gt;</span>

<span class="kn">package</span> <span class="nn">kr.ac.univ.controller</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">kr.ac.univ.publication.dto.PublicationDto</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.publication.dto.PublicationSearchDto</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.publication.service.PublicationAttachedFileService</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.publication.service.PublicationService</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.data.domain.Pageable</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.data.web.PageableDefault</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Controller</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.ui.Model</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.GetMapping</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMapping</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestParam</span><span class="o">;</span>

<span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/publication"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PublicationController</span> <span class="o">{</span>
   <span class="kd">private</span> <span class="kd">final</span> <span class="nc">PublicationService</span> <span class="n">publicationService</span><span class="o">;</span>
   <span class="kd">private</span> <span class="kd">final</span> <span class="nc">PublicationAttachedFileService</span> <span class="n">publicationAttachedFileService</span><span class="o">;</span>

   <span class="kd">public</span> <span class="nf">PublicationController</span><span class="o">(</span><span class="nc">PublicationService</span> <span class="n">publicationService</span><span class="o">,</span> <span class="nc">PublicationAttachedFileService</span> <span class="n">publicationAttachedFileService</span><span class="o">)</span> <span class="o">{</span>
       <span class="k">this</span><span class="o">.</span><span class="na">publicationService</span> <span class="o">=</span> <span class="n">publicationService</span><span class="o">;</span>
       <span class="k">this</span><span class="o">.</span><span class="na">publicationAttachedFileService</span> <span class="o">=</span> <span class="n">publicationAttachedFileService</span><span class="o">;</span>
   <span class="o">}</span>

   <span class="o">...</span>

   <span class="c1">// List Scroll</span>
   <span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/list_scroll"</span><span class="o">)</span>
   <span class="kd">public</span> <span class="nc">String</span> <span class="nf">publicationHomeList</span><span class="o">(</span><span class="nc">PublicationSearchDto</span> <span class="n">publicationSearchDto</span><span class="o">,</span>
                                     <span class="nc">Model</span> <span class="n">model</span><span class="o">)</span> <span class="o">{</span>
       <span class="c1">// 방어 코드: lastIdx는 충분히 큰 값을 전달하면 된다.</span>
       <span class="nc">Long</span> <span class="n">lastIdx</span> <span class="o">=</span> <span class="n">publicationService</span><span class="o">.</span><span class="na">findMaxPublicationIdx</span><span class="o">();</span>

       <span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">"publicationDtoList"</span><span class="o">,</span> <span class="n">publicationService</span><span class="o">.</span><span class="na">findPublicationListScroll</span><span class="o">(</span><span class="n">lastIdx</span><span class="o">,</span> <span class="n">publicationSearchDto</span><span class="o">));</span>

       <span class="k">return</span> <span class="s">"/publication/list_scroll"</span><span class="o">;</span>
   <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><h2 id="restcontroller">RestController</h2><ul><li>Publication 관련 클라이언트의 요청을 json 타입으로 응답한다.<li>publicationListScroll: 스크롤 이벤트가 발생할 때 응답하며, lastIdx(조회한 리스트의 마지막 요소의 idx)를 기준으로 publication 데이터를 검색한다.</ul><div class="language-java highlighter-rouge"><div class="code-header"> <span text-data=" Java "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="n">module</span><span class="o">-</span><span class="n">app</span><span class="o">-</span><span class="n">api</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">java</span><span class="o">/</span><span class="n">kr</span><span class="o">/</span><span class="n">ac</span><span class="o">/</span><span class="n">univ</span><span class="o">/</span><span class="n">controller</span><span class="o">/</span><span class="nc">PublicationRestController</span><span class="o">.</span><span class="na">java</span><span class="o">&gt;</span>

<span class="kn">package</span> <span class="nn">kr.ac.univ.controller</span><span class="o">;</span>


<span class="kn">import</span> <span class="nn">kr.ac.univ.publication.domain.Publication</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.publication.dto.PublicationDto</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.publication.dto.PublicationSearchDto</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.publication.service.PublicationAttachedFileService</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.publication.service.PublicationService</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.http.HttpStatus</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.http.ResponseEntity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.ui.Model</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.multipart.MultipartFile</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="nd">@RestController</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/api/publications"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PublicationRestController</span> <span class="o">{</span>
   <span class="kd">private</span> <span class="kd">final</span> <span class="nc">PublicationService</span> <span class="n">publicationService</span><span class="o">;</span>
   <span class="kd">private</span> <span class="kd">final</span> <span class="nc">PublicationAttachedFileService</span> <span class="n">publicationAttachedFileService</span><span class="o">;</span>

   <span class="kd">public</span> <span class="nf">PublicationRestController</span><span class="o">(</span><span class="nc">PublicationService</span> <span class="n">publicationService</span><span class="o">,</span> <span class="nc">PublicationAttachedFileService</span> <span class="n">publicationAttachedFileService</span><span class="o">)</span> <span class="o">{</span>
       <span class="k">this</span><span class="o">.</span><span class="na">publicationService</span> <span class="o">=</span> <span class="n">publicationService</span><span class="o">;</span>
       <span class="k">this</span><span class="o">.</span><span class="na">publicationAttachedFileService</span> <span class="o">=</span> <span class="n">publicationAttachedFileService</span><span class="o">;</span>
   <span class="o">}</span>

   <span class="o">...</span>

   <span class="c1">// List Scroll</span>
   <span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/list_scroll"</span><span class="o">)</span>
   <span class="kd">public</span> <span class="nc">ResponseEntity</span><span class="o">&lt;?&gt;</span> <span class="n">publicationListScroll</span><span class="o">(</span><span class="nd">@RequestParam</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"lastIdx"</span><span class="o">,</span> <span class="n">defaultValue</span> <span class="o">=</span> <span class="s">"-1"</span><span class="o">)</span> <span class="nc">Long</span> <span class="n">lastIdx</span><span class="o">,</span>
                                                  <span class="nc">PublicationSearchDto</span> <span class="n">publicationSearchDto</span><span class="o">,</span>
                                                  <span class="nc">Model</span> <span class="n">model</span><span class="o">)</span> <span class="o">{</span>
       <span class="c1">// 방어 코드: lastIdx가 들어오지 않은 경우 충분히 큰 값을 전달하면 된다.</span>
       <span class="k">if</span> <span class="o">(</span><span class="n">lastIdx</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1L</span><span class="o">)</span> <span class="o">{</span>
           <span class="n">lastIdx</span> <span class="o">=</span> <span class="n">publicationService</span><span class="o">.</span><span class="na">findMaxPublicationIdx</span><span class="o">();</span>
       <span class="o">}</span>

       <span class="k">return</span> <span class="k">new</span> <span class="nc">ResponseEntity</span><span class="o">&lt;&gt;(</span><span class="n">publicationService</span><span class="o">.</span><span class="na">findPublicationListScroll</span><span class="o">(</span><span class="n">lastIdx</span><span class="o">,</span> <span class="n">publicationSearchDto</span><span class="o">),</span> <span class="nc">HttpStatus</span><span class="o">.</span><span class="na">OK</span><span class="o">);</span>
   <span class="o">}</span>

<span class="o">}</span>
</pre></table></code></div></div><h2 id="view">View</h2><ul><li>Publication 관련 데이터를 화면에 출력한다.<li>해당 페이지에 접근하면 조회한 리스트의 마지막 요소의 idx(pk)를 계산한다.<li>이후 스크롤을 화면 가장 하단 - 100 높이만큼 이동시키면 스크롤 이벤트가 발생하며, 요청 URI는 util 함수인 getUriParams 함수(쿼리 스트링의 파라미터를 분리)와 makeGetUri 함수(URI 생성)를 사용하여 생성한다. 생성된 URI는 ajax를 통하여 서버에 요청 후 응답받은 데이터 리스트의 마지막 요소의 idx(pk)를 계산한 다음 데이터 리스트를 화면에 출력한다.<li>데이터 조회에 성공하는 경우 loading bar는 hide되고, 조회된 데이터를 포맷에 맞게 파싱하여 출력한다.<li>무한 스크롤 이벤트 발생 자바스크립트 소스 코드는 하단 출처를 참고하였다.</ul><p>출처: <a href="https://c10106.tistory.com/4173">https://c10106.tistory.com/4173</a></p><div class="language-html highlighter-rouge"><div class="code-header"> <span text-data=" HTML "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
</pre><td class="rouge-code"><pre><span class="nt">&lt;module-app-web</span><span class="err">/</span><span class="na">src</span><span class="err">/</span><span class="na">main</span><span class="err">/</span><span class="na">resources</span><span class="err">/</span><span class="na">templates</span><span class="err">/</span><span class="na">publication</span><span class="err">/</span><span class="na">list_scroll.html</span><span class="nt">&gt;</span>

<span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">"en"</span> <span class="na">xmlns:th=</span><span class="s">"http://www.thymeleaf.org"</span><span class="nt">&gt;</span>
<span class="nt">&lt;head&gt;</span>
    <span class="c">&lt;!-- css --&gt;</span>
    <span class="nt">&lt;th:block</span> <span class="na">th:replace=</span><span class="s">"layout/css.html"</span><span class="nt">&gt;&lt;/th:block&gt;</span>

    <span class="nt">&lt;title</span> <span class="na">th:text=</span><span class="s">"${@environment.getProperty('title')} + ' | Publication List'"</span><span class="nt">&gt;&lt;/title&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"wrapper"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"page-content-wrapper"</span><span class="nt">&gt;</span>
        <span class="c">&lt;!-- header --&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">th:replace=</span><span class="s">"layout/header::header"</span><span class="nt">&gt;&lt;/div&gt;</span>

        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container publication"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;form</span> <span class="na">name=</span><span class="s">"form"</span> <span class="na">id=</span><span class="s">"form"</span> <span class="na">th:object=</span><span class="s">"${publicationSearchDto}"</span> <span class="na">action=</span><span class="s">"#"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"page-header breadcrumbs"</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"d-flex justify-content-between align-items-center"</span> <span class="na">data-aos=</span><span class="s">"fade-up"</span><span class="nt">&gt;</span>
                        <span class="nt">&lt;h2&gt;</span>Publication List<span class="nt">&lt;/h2&gt;</span>
                        <span class="nt">&lt;ol&gt;</span>
                            <span class="nt">&lt;li&gt;</span>Home<span class="nt">&lt;/li&gt;</span>
                            <span class="nt">&lt;li&gt;</span>Publication List<span class="nt">&lt;/li&gt;</span>
                        <span class="nt">&lt;/ol&gt;</span>
                    <span class="nt">&lt;/div&gt;</span>
                <span class="nt">&lt;/div&gt;</span>

                <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"loading"</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;img</span> <span class="na">th:src=</span><span class="s">"@{/images/loading.gif}"</span> <span class="na">alt=</span><span class="s">"Loading…"</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;/div&gt;</span>

                <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"page-search"</span> <span class="na">data-aos=</span><span class="s">"fade-up"</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"row justify-content-end mt-4"</span><span class="nt">&gt;</span>
                        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"custom-control custom-radio col-auto"</span><span class="nt">&gt;</span>
                            <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"radio"</span> <span class="na">class=</span><span class="s">"custom-control-input"</span> <span class="na">name=</span><span class="s">"publicationSearchType"</span> <span class="na">id=</span><span class="s">"showAll"</span>
                                   <span class="na">th:value=</span><span class="s">"SHOW_ALL"</span>
                                   <span class="na">th:checked=</span><span class="s">"*{publicationSearchType?.name() == 'SHOW_ALL' ||  publicationSearchType?.name() == null}"</span><span class="nt">&gt;</span>
                            <span class="nt">&lt;label</span> <span class="na">class=</span><span class="s">"custom-control-label"</span> <span class="na">th:for=</span><span class="s">"showAll"</span><span class="nt">&gt;</span> Show All <span class="nt">&lt;/label&gt;</span>
                        <span class="nt">&lt;/div&gt;</span>
                        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"custom-control custom-radio col-auto"</span><span class="nt">&gt;</span>
                            <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"radio"</span> <span class="na">class=</span><span class="s">"custom-control-input"</span> <span class="na">name=</span><span class="s">"publicationSearchType"</span> <span class="na">id=</span><span class="s">"internationalJournal"</span>
                                   <span class="na">th:value=</span><span class="s">"INTERNATIONAL_JOURNAL"</span>
                                   <span class="na">th:checked=</span><span class="s">"*{publicationSearchType?.name() == 'INTERNATIONAL_JOURNAL'}"</span><span class="nt">&gt;</span>
                            <span class="nt">&lt;label</span> <span class="na">class=</span><span class="s">"custom-control-label"</span> <span class="na">th:for=</span><span class="s">"internationalJournal"</span><span class="nt">&gt;</span> International Journal <span class="nt">&lt;/label&gt;</span>
                        <span class="nt">&lt;/div&gt;</span>
                        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"custom-control custom-radio col-auto"</span><span class="nt">&gt;</span>
                            <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"radio"</span> <span class="na">class=</span><span class="s">"custom-control-input"</span> <span class="na">name=</span><span class="s">"publicationSearchType"</span>
                                   <span class="na">id=</span><span class="s">"internationalConference"</span>
                                   <span class="na">th:value=</span><span class="s">"INTERNATIONAL_CONFERENCE"</span>
                                   <span class="na">th:checked=</span><span class="s">"*{publicationSearchType?.name() == 'INTERNATIONAL_CONFERENCE'}"</span><span class="nt">&gt;</span>
                            <span class="nt">&lt;label</span> <span class="na">class=</span><span class="s">"custom-control-label"</span> <span class="na">th:for=</span><span class="s">"internationalConference"</span><span class="nt">&gt;</span> International Conference <span class="nt">&lt;/label&gt;</span>
                        <span class="nt">&lt;/div&gt;</span>
                        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"custom-control custom-radio col-auto"</span><span class="nt">&gt;</span>
                            <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"radio"</span> <span class="na">class=</span><span class="s">"custom-control-input"</span> <span class="na">name=</span><span class="s">"publicationSearchType"</span> <span class="na">id=</span><span class="s">"domesticJournal"</span>
                                   <span class="na">th:value=</span><span class="s">"DOMESTIC_JOURNAL"</span>
                                   <span class="na">th:checked=</span><span class="s">"*{publicationSearchType?.name() == 'DOMESTIC_JOURNAL'}"</span><span class="nt">&gt;</span>
                            <span class="nt">&lt;label</span> <span class="na">class=</span><span class="s">"custom-control-label"</span> <span class="na">th:for=</span><span class="s">"domesticJournal"</span><span class="nt">&gt;</span> Domestic Journal <span class="nt">&lt;/label&gt;</span>
                        <span class="nt">&lt;/div&gt;</span>
                        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"custom-control custom-radio col-auto"</span><span class="nt">&gt;</span>
                            <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"radio"</span> <span class="na">class=</span><span class="s">"custom-control-input"</span> <span class="na">name=</span><span class="s">"publicationSearchType"</span> <span class="na">id=</span><span class="s">"domesticConference"</span>
                                   <span class="na">th:value=</span><span class="s">"DOMESTIC_CONFERENCE"</span>
                                   <span class="na">th:checked=</span><span class="s">"*{publicationSearchType?.name() == 'DOMESTIC_CONFERENCE'}"</span><span class="nt">&gt;</span>
                            <span class="nt">&lt;label</span> <span class="na">class=</span><span class="s">"custom-control-label"</span> <span class="na">th:for=</span><span class="s">"domesticConference"</span><span class="nt">&gt;</span> Domestic Conference <span class="nt">&lt;/label&gt;</span>
                        <span class="nt">&lt;/div&gt;</span>
                    <span class="nt">&lt;/div&gt;</span>

                    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"row justify-content-end mt-2"</span><span class="nt">&gt;</span>
                        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"pt-2 pr-3"</span><span class="nt">&gt;</span>
                            <span class="nt">&lt;select</span> <span class="na">class=</span><span class="s">"custom-select custom-select-sm"</span> <span class="na">name=</span><span class="s">"searchType"</span> <span class="na">th:field=</span><span class="s">"*{searchType}"</span><span class="nt">&gt;</span>
                                <span class="nt">&lt;option</span> <span class="na">th:value=</span><span class="s">"TITLE"</span><span class="nt">&gt;</span>Title<span class="nt">&lt;/option&gt;</span>
                                <span class="nt">&lt;option</span> <span class="na">th:value=</span><span class="s">"AUTHORS"</span><span class="nt">&gt;</span>Authors<span class="nt">&lt;/option&gt;</span>
                                <span class="nt">&lt;option</span> <span class="na">th:value=</span><span class="s">"PUBLISHED_IN"</span><span class="nt">&gt;</span>ID<span class="nt">&lt;/option&gt;</span>
                            <span class="nt">&lt;/select&gt;</span>
                        <span class="nt">&lt;/div&gt;</span>
                        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"pt-2 pr-2"</span><span class="nt">&gt;</span>
                            <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"search"</span> <span class="na">class=</span><span class="s">"custom-search-input"</span> <span class="na">name=</span><span class="s">"keyword"</span> <span class="na">placeholder=</span><span class="s">"Search"</span> <span class="na">th:value=</span><span class="s">"${searchDto?.keyword}"</span><span class="nt">&gt;</span>
                        <span class="nt">&lt;/div&gt;</span>
                        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"pt-2"</span><span class="nt">&gt;</span>
                            <span class="nt">&lt;i</span> <span class="na">id=</span><span class="s">"search"</span> <span class="na">class=</span><span class="s">"fas fa-search search-icon"</span><span class="nt">&gt;&lt;/i&gt;</span>
                        <span class="nt">&lt;/div&gt;</span>
                    <span class="nt">&lt;/div&gt;</span>
                <span class="nt">&lt;/div&gt;</span>

                <span class="c">&lt;!-- Common --&gt;</span>
                <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"page-content"</span> <span class="na">data-aos=</span><span class="s">"fade-up"</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"publications"</span> <span class="na">class=</span><span class="s">"mt-4"</span><span class="nt">&gt;</span>
                        <span class="nt">&lt;div</span> <span class="na">th:id=</span><span class="s">"publicationData0"</span> <span class="na">th:each=</span><span class="s">"publicationDto : ${publicationDtoList}"</span> <span class="na">class=</span><span class="s">"publication-wrap mt-4"</span><span class="nt">&gt;</span>
                            <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"my-1"</span><span class="nt">&gt;</span>
                                <span class="nt">&lt;a</span> <span class="na">th:if=</span><span class="s">"!${#strings.isEmpty(publicationDto.doi)}"</span> <span class="na">th:href=</span><span class="s">"'https://doi.org/' + ${publicationDto.doi}"</span> <span class="na">th:id=</span><span class="s">"publicationTitle"</span> <span class="na">th:text=</span><span class="s">"${publicationDto.title}"</span> <span class="na">th:class=</span><span class="s">"title"</span> <span class="na">target=</span><span class="s">"_blank"</span><span class="nt">&gt;&lt;/a&gt;</span>
                                <span class="nt">&lt;a</span> <span class="na">th:if=</span><span class="s">"${#strings.isEmpty(publicationDto.doi) and !#strings.isEmpty(publicationDto.uri)}"</span> <span class="na">th:href=</span><span class="s">"${publicationDto.uri}"</span> <span class="na">th:id=</span><span class="s">"publicationTitle"</span> <span class="na">th:text=</span><span class="s">"${publicationDto.title}"</span> <span class="na">th:class=</span><span class="s">"title"</span>
                                   <span class="na">target=</span><span class="s">"_blank"</span><span class="nt">&gt;&lt;/a&gt;</span>
                                <span class="nt">&lt;span</span> <span class="na">th:if=</span><span class="s">"${#strings.isEmpty(publicationDto.doi) and #strings.isEmpty(publicationDto.uri)}"</span> <span class="na">th:id=</span><span class="s">"publicationTitle"</span> <span class="na">th:text=</span><span class="s">"${publicationDto.title}"</span> <span class="na">th:class=</span><span class="s">"title"</span><span class="nt">&gt;&lt;/span&gt;&lt;br&gt;</span>
                            <span class="nt">&lt;/span&gt;</span>

                            <span class="nt">&lt;span</span> <span class="na">th:text=</span><span class="s">"${publicationDto.authors}"</span> <span class="na">th:id=</span><span class="s">"publicationAuthors"</span> <span class="na">class=</span><span class="s">"authors my-1"</span><span class="nt">&gt;&lt;/span&gt;&lt;br&gt;</span>

                            <span class="nt">&lt;span</span> <span class="na">th:if=</span><span class="s">"!${#strings.isEmpty(publicationDto.publishedIn)}"</span> <span class="na">th:text=</span><span class="s">"${publicationDto.publishedIn}"</span><span class="nt">&gt;&lt;/span&gt;</span>
                            <span class="nt">&lt;span</span> <span class="na">th:if=</span><span class="s">"!${#strings.isEmpty(publicationDto.publishedDate)}"</span> <span class="na">th:text=</span><span class="s">"', ' + ${#temporals.format(publicationDto.publishedDate, 'MMM', new java.util.Locale('en', 'EN'))}"</span><span class="nt">&gt;&lt;/span&gt;</span>
                            <span class="nt">&lt;span</span> <span class="na">th:if=</span><span class="s">"!${#strings.isEmpty(publicationDto.publishedDate)}"</span> <span class="na">th:text=</span><span class="s">"', ' + ${#temporals.format(publicationDto.publishedDate, 'yyyy')}"</span><span class="nt">&gt;&lt;/span&gt;</span>
                            <span class="nt">&lt;span</span> <span class="na">th:if=</span><span class="s">"!${#strings.isEmpty(publicationDto.volume)}"</span> <span class="na">th:text=</span><span class="s">"', Vol. ' + ${publicationDto.volume} "</span><span class="nt">&gt;&lt;/span&gt;</span>
                            <span class="nt">&lt;span</span> <span class="na">th:if=</span><span class="s">"!${#strings.isEmpty(publicationDto.number)}"</span> <span class="na">th:text=</span><span class="s">"', No. ' + ${publicationDto.number}"</span><span class="nt">&gt;&lt;/span&gt;</span>
                            <span class="nt">&lt;span</span> <span class="na">th:if=</span><span class="s">"!${#strings.isEmpty(publicationDto.pages)}"</span> <span class="na">th:text=</span><span class="s">"', pp. ' + ${publicationDto.pages}"</span><span class="nt">&gt;&lt;/span&gt;</span>
                            <span class="nt">&lt;span</span> <span class="na">th:if=</span><span class="s">"!${#strings.isEmpty(publicationDto.isbnIssn)}"</span> <span class="na">th:text=</span><span class="s">"', ' + ${publicationDto.isbnIssn}"</span><span class="nt">&gt;&lt;/span&gt;</span>

                            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"mt-2"</span><span class="nt">&gt;</span>
                                <span class="nt">&lt;span</span> <span class="na">th:if=</span><span class="s">"${#strings.equals(publicationDto.publishingArea, 'INTERNATIONAL') &amp;&amp; (#strings.equals(publicationDto.publicationType, 'JOURNAL_SCIE') || #strings.equals(publicationDto.publicationType, 'JOURNAL_SCOPUS'))}"</span>
                                      <span class="na">th:text=</span><span class="s">"${publicationDto.publishingArea.publishingArea} + ' ' + ${publicationDto.publicationType.publicationType} + (${#strings.isEmpty(publicationDto.impactFactor)} ? '' : '(' + ${publicationDto.impactFactor} + ')')"</span>
                                      <span class="na">class=</span><span class="s">"btn-primary btn-sm"</span><span class="nt">&gt;&lt;/span&gt;</span>
                                <span class="nt">&lt;span</span> <span class="na">th:if=</span><span class="s">"${#strings.equals(publicationDto.publishingArea, 'INTERNATIONAL') &amp;&amp; !(#strings.equals(publicationDto.publicationType, 'JOURNAL_SCIE') || #strings.equals(publicationDto.publicationType, 'JOURNAL_SCOPUS'))}"</span>
                                      <span class="na">th:text=</span><span class="s">"${publicationDto.publishingArea.publishingArea} + ' ' + ${publicationDto.publicationType.publicationType}"</span>
                                      <span class="na">class=</span><span class="s">"btn-info btn-sm"</span><span class="nt">&gt;&lt;/span&gt;</span>
                                <span class="nt">&lt;span</span> <span class="na">th:if=</span><span class="s">"${#strings.equals(publicationDto.publishingArea, 'DOMESTIC') &amp;&amp; #strings.equals(publicationDto.publicationType, 'JOURNAL')}"</span>
                                      <span class="na">th:text=</span><span class="s">"${publicationDto.publishingArea.publishingArea} + ' ' + ${publicationDto.publicationType.publicationType} "</span>
                                      <span class="na">class=</span><span class="s">"btn-success btn-sm"</span><span class="nt">&gt;&lt;/span&gt;</span>
                                <span class="nt">&lt;span</span> <span class="na">th:if=</span><span class="s">"${#strings.equals(publicationDto.publishingArea, 'DOMESTIC') &amp;&amp; !(#strings.equals(publicationDto.publicationType, 'JOURNAL'))}"</span>
                                      <span class="na">th:text=</span><span class="s">"${publicationDto.publishingArea.publishingArea} + ' ' + ${publicationDto.publicationType.publicationType}"</span>
                                      <span class="na">class=</span><span class="s">"btn-warning btn-sm"</span><span class="nt">&gt;&lt;/span&gt;</span>
                            <span class="nt">&lt;/div&gt;</span>
                        <span class="nt">&lt;/div&gt;</span>
                        <span class="nt">&lt;div</span> <span class="na">th:if=</span><span class="s">"${#lists.size(publicationDtoList) == 0}"</span><span class="nt">&gt;</span>
                            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"no-posts"</span><span class="nt">&gt;</span>
                                No posts founded.
                            <span class="nt">&lt;/div&gt;</span>
                        <span class="nt">&lt;/div&gt;</span>

                        <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"loadingScroll"</span> <span class="na">class=</span><span class="s">"row justify-content-center"</span><span class="nt">&gt;</span>
                            <span class="nt">&lt;img</span> <span class="na">th:src=</span><span class="s">"@{/images/loading.gif}"</span> <span class="na">alt=</span><span class="s">"Loading…"</span><span class="nt">/&gt;</span>
                        <span class="nt">&lt;/div&gt;</span>
                    <span class="nt">&lt;/div&gt;</span>

                    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"row mt-4 mb-4"</span><span class="nt">&gt;&lt;/div&gt;</span>
                <span class="nt">&lt;/div&gt;</span>
            <span class="nt">&lt;/form&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>

<span class="c">&lt;!-- footer --&gt;</span>
<span class="nt">&lt;div</span> <span class="na">th:replace=</span><span class="s">"layout/footer::footer"</span><span class="nt">&gt;&lt;/div&gt;</span>

<span class="c">&lt;!-- script file --&gt;</span>
<span class="nt">&lt;th:block</span> <span class="na">th:replace=</span><span class="s">"layout/script.html"</span><span class="nt">&gt;&lt;/th:block&gt;</span>

<span class="nt">&lt;script </span><span class="na">th:inline=</span><span class="s">"javascript"</span><span class="nt">&gt;</span>
    <span class="kd">var</span> <span class="nx">list</span> <span class="o">=</span> <span class="p">([[</span><span class="nx">$</span><span class="p">{</span><span class="nx">publicationDtoList</span><span class="p">}]]);</span>
    <span class="kd">var</span> <span class="nx">lastIdx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">isLast</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">uri</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

    <span class="c1">// 조회하는 데이터가 10개 보다 적은 경우 loading.gif를 hide</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">list</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;</span> <span class="mi">15</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">$</span><span class="p">(</span><span class="dl">"</span><span class="s2">#loadingScroll</span><span class="dl">"</span><span class="p">).</span><span class="nx">hide</span><span class="p">();</span>
        <span class="nx">isLast</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="c1">// 처음 발생하는 scroll event에서 데이터를 가져오는 기준이 된다.(마지막 배열 요소의 idx)</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">lastIdx</span> <span class="o">=</span> <span class="nx">list</span><span class="p">[</span><span class="nx">list</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="nx">idx</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">win</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">publicationId</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

        <span class="c1">// Each time the user scrolls</span>
        <span class="nx">win</span><span class="p">.</span><span class="nx">scroll</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">).</span><span class="nx">scrollTop</span><span class="p">()</span> <span class="o">+</span> <span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">).</span><span class="nx">height</span><span class="p">()</span> <span class="o">&gt;</span> <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">height</span><span class="p">()</span> <span class="o">-</span> <span class="mi">100</span><span class="p">)</span> <span class="p">{</span>
                <span class="c1">// 더이상 가져오는 데이터가 없는 경우</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">isLast</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">$</span><span class="p">(</span><span class="dl">'</span><span class="s1">#loadingScroll</span><span class="dl">'</span><span class="p">).</span><span class="nx">hide</span><span class="p">();</span>
                    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
                <span class="p">}</span>

                <span class="nx">$</span><span class="p">(</span><span class="dl">'</span><span class="s1">#loadingScroll</span><span class="dl">'</span><span class="p">).</span><span class="nx">show</span><span class="p">();</span>

                <span class="c1">// 처음과 마지막 데이터가 중복되는 경우를 제거하기 위해서 lastIdx에서 1을 뺀다.</span>
                <span class="nx">uri</span> <span class="o">=</span> <span class="p">{</span><span class="na">lastIdx</span><span class="p">:</span> <span class="nx">lastIdx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">};</span>

                <span class="c1">// URI 생성</span>
                <span class="nb">Object</span><span class="p">.</span><span class="nx">assign</span><span class="p">(</span><span class="nx">uri</span><span class="p">,</span> <span class="nx">getUriParams</span><span class="p">());</span>
                <span class="nx">uri</span> <span class="o">=</span> <span class="nx">makeGetUri</span><span class="p">(</span><span class="nx">moduleAppApiAddress</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">/api/publications/list_scroll</span><span class="dl">"</span><span class="p">,</span> <span class="nx">uri</span><span class="p">);</span>

                <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
                    <span class="na">url</span><span class="p">:</span> <span class="nx">uri</span><span class="p">,</span>
                    <span class="na">type</span><span class="p">:</span> <span class="dl">"</span><span class="s2">get</span><span class="dl">"</span><span class="p">,</span>
                    <span class="na">dataType</span><span class="p">:</span> <span class="dl">"</span><span class="s2">text</span><span class="dl">"</span><span class="p">,</span>
                    <span class="na">contentType</span><span class="p">:</span> <span class="dl">"</span><span class="s2">application/json</span><span class="dl">"</span><span class="p">,</span>
                    <span class="na">async</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
                <span class="p">})</span>
                    <span class="p">.</span><span class="nx">done</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">msg</span><span class="p">)</span> <span class="p">{</span>
                        <span class="kd">var</span> <span class="nx">publicationList</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">msg</span><span class="p">);</span>
                        <span class="c1">// 가져오는 데이터가 없는 경우</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nx">publicationList</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                            <span class="nx">isLast</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                            <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
                        <span class="p">}</span>

                        <span class="c1">// 다음 발생하는 scroll event에서 데이터를 가져오는 기준이 된다.(마지막 배열 요소의 idx)</span>
                        <span class="nx">lastIdx</span> <span class="o">=</span> <span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">msg</span><span class="p">))[(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">msg</span><span class="p">)).</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="nx">idx</span><span class="p">;</span>

                        <span class="kd">var</span> <span class="nx">monthNames</span> <span class="o">=</span> <span class="p">[</span><span class="dl">"</span><span class="s2">January</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">February</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">March</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">April</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">May</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">June</span><span class="dl">"</span><span class="p">,</span>
                            <span class="dl">"</span><span class="s2">July</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">August</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">September</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">October</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">November</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">December</span><span class="dl">"</span>
                        <span class="p">];</span>

                        <span class="nx">$</span><span class="p">(</span><span class="dl">"</span><span class="s2">#loadingScroll</span><span class="dl">"</span><span class="p">).</span><span class="nx">hide</span><span class="p">();</span>

                        <span class="c1">// ajax를 통하여 받은 데이터를 html에 출력한다.</span>
                        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">publicationList</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                            <span class="kd">var</span> <span class="nx">str</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
                            <span class="kd">var</span> <span class="nx">publishedDate</span> <span class="o">=</span> <span class="nx">publicationList</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">publishedDate</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">'</span><span class="s1">-</span><span class="dl">'</span><span class="p">);</span>
                            <span class="nx">publishedDate</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nx">monthNames</span><span class="p">[</span><span class="nx">publishedDate</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span>

                            <span class="k">if</span> <span class="p">(</span><span class="nx">publicationList</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">publishingArea</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">INTERNATIONAL</span><span class="dl">'</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">publicationList</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">publicationType</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">JOURNAL_SCIE</span><span class="dl">'</span> <span class="o">||</span> <span class="nx">publicationList</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">publicationType</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">JOURNAL_SCOPUS</span><span class="dl">'</span><span class="p">))</span> <span class="p">{</span>
                                <span class="nx">str</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">&lt;span class='btn-primary btn-sm'&gt;</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">capitalize</span><span class="p">(</span><span class="nx">publicationList</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">publishingArea</span><span class="p">)</span> <span class="o">+</span> <span class="dl">'</span><span class="s1"> </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">convertPublicationType</span><span class="p">(</span><span class="nx">publicationList</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">publicationType</span><span class="p">)</span> <span class="o">+</span>
                                    <span class="nx">convertImpactFactor</span><span class="p">(</span><span class="nx">publicationList</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">impactFactor</span><span class="p">)</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">&lt;/span&gt;</span><span class="dl">"</span><span class="p">;</span>
                            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">publicationList</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">publishingArea</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">INTERNATIONAL</span><span class="dl">'</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="p">(</span><span class="nx">publicationList</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">publicationType</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">JOURNAL_SCIE</span><span class="dl">'</span> <span class="o">||</span> <span class="nx">publicationList</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">publicationType</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">JOURNAL_SCOPUS</span><span class="dl">'</span><span class="p">))</span> <span class="p">{</span>
                                <span class="nx">str</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">&lt;span class='btn-info btn-sm'&gt;</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">capitalize</span><span class="p">(</span><span class="nx">publicationList</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">publishingArea</span><span class="p">)</span> <span class="o">+</span> <span class="dl">'</span><span class="s1"> </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">convertPublicationType</span><span class="p">(</span><span class="nx">publicationList</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">publicationType</span><span class="p">)</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">&lt;/span&gt;</span><span class="dl">"</span><span class="p">;</span>
                            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">publicationList</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">publishingArea</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">DOMESTIC</span><span class="dl">'</span> <span class="o">&amp;&amp;</span> <span class="nx">publicationList</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">publicationType</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">JOURNAL</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
                                <span class="nx">str</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">&lt;span class='btn-success btn-sm'&gt;</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">capitalize</span><span class="p">(</span><span class="nx">publicationList</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">publishingArea</span><span class="p">)</span> <span class="o">+</span> <span class="dl">'</span><span class="s1"> </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">convertPublicationType</span><span class="p">(</span><span class="nx">publicationList</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">publicationType</span><span class="p">)</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">&lt;/span&gt;</span><span class="dl">"</span><span class="p">;</span>
                            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">publicationList</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">publishingArea</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">DOMESTIC</span><span class="dl">'</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="p">(</span><span class="nx">publicationList</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">publicationType</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">JOURNAL</span><span class="dl">'</span><span class="p">))</span> <span class="p">{</span>
                                <span class="nx">str</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">&lt;span class='btn-warning btn-sm'&gt;</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">capitalize</span><span class="p">(</span><span class="nx">publicationList</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">publishingArea</span><span class="p">)</span> <span class="o">+</span> <span class="dl">'</span><span class="s1"> </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">convertPublicationType</span><span class="p">(</span><span class="nx">publicationList</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">publicationType</span><span class="p">)</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">&lt;/span&gt;</span><span class="dl">"</span><span class="p">;</span>
                            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                                <span class="nx">str</span> <span class="o">=</span> <span class="dl">""</span><span class="p">;</span>
                            <span class="p">}</span>

                            <span class="kd">var</span> <span class="nx">link</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">&lt;span class="my-1"&gt;</span><span class="dl">'</span><span class="p">;</span>

                            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">isEmpty</span><span class="p">(</span><span class="nx">publicationList</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">doi</span><span class="p">))</span> <span class="p">{</span>
                                <span class="nx">link</span> <span class="o">+=</span> <span class="dl">'</span><span class="s1">&lt;a id="publicationTitle"</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">publicationId</span> <span class="o">+</span> <span class="dl">'</span><span class="s1"> href="</span><span class="dl">'</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">https://doi.org/</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">publicationList</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">doi</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">" class="title" target="_blank"&gt;</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">publicationList</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">title</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">&lt;/a&gt;</span><span class="dl">'</span>
                            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">isEmpty</span><span class="p">(</span><span class="nx">publicationList</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">doi</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">isEmpty</span><span class="p">(</span><span class="nx">publicationList</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">uri</span><span class="p">))</span> <span class="p">{</span>
                                <span class="nx">link</span> <span class="o">+=</span> <span class="dl">'</span><span class="s1">&lt;a id="publicationTitle"</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">publicationId</span> <span class="o">+</span> <span class="dl">'</span><span class="s1"> href="</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">publicationList</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">uri</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">" class="title" target="_blank"&gt;</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">publicationList</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">title</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">&lt;/a&gt;</span><span class="dl">'</span>
                            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                                <span class="nx">link</span> <span class="o">+=</span> <span class="dl">'</span><span class="s1">&lt;span id="publicationTitle"</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">publicationId</span> <span class="o">+</span> <span class="dl">'</span><span class="s1"> class="title"&gt;</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">publicationList</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">title</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">&lt;/span&gt;</span><span class="dl">'</span>
                            <span class="p">}</span>

                            <span class="nx">link</span> <span class="o">+=</span> <span class="dl">'</span><span class="s1">&lt;/span&gt;&lt;br&gt;</span><span class="dl">'</span>

                            <span class="kd">var</span> <span class="nx">number</span> <span class="o">=</span> <span class="o">!</span><span class="nx">isEmpty</span><span class="p">(</span><span class="nx">publicationList</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">number</span><span class="p">)</span> <span class="p">?</span> <span class="dl">'</span><span class="s1">&lt;span&gt;, No. </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">publicationList</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">number</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">&lt;/span&gt;</span><span class="dl">'</span> <span class="p">:</span> <span class="dl">''</span><span class="p">;</span>
                            <span class="kd">var</span> <span class="nx">pages</span> <span class="o">=</span> <span class="o">!</span><span class="nx">isEmpty</span><span class="p">(</span><span class="nx">publicationList</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">pages</span><span class="p">)</span> <span class="p">?</span> <span class="dl">'</span><span class="s1">&lt;span&gt;, pp. </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">publicationList</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">pages</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">&lt;/span&gt;</span><span class="dl">'</span> <span class="p">:</span> <span class="dl">''</span><span class="p">;</span>
                            <span class="kd">var</span> <span class="nx">isbnIssn</span> <span class="o">=</span> <span class="o">!</span><span class="nx">isEmpty</span><span class="p">(</span><span class="nx">publicationList</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">isbnIssn</span><span class="p">)</span> <span class="p">?</span> <span class="dl">'</span><span class="s1">&lt;span&gt;, </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">publicationList</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">isbnIssn</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">&lt;/span&gt;</span><span class="dl">'</span> <span class="p">:</span> <span class="dl">''</span><span class="p">;</span>

                            <span class="nx">$</span><span class="p">(</span><span class="dl">"</span><span class="s2">#publications</span><span class="dl">"</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span>
                                <span class="dl">'</span><span class="s1">&lt;div id="publicationData</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">publicationId</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">" class="publication-wrap mt-4"&gt;</span><span class="dl">'</span>
                                <span class="o">+</span> <span class="nx">link</span>
                                <span class="o">+</span> <span class="dl">'</span><span class="s1">&lt;span id="publicationAuthors"</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">publicationId</span> <span class="o">+</span> <span class="dl">'</span><span class="s1"> class="authors my-1"&gt;</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">publicationList</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">authors</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">&lt;/span&gt;&lt;br&gt;</span><span class="dl">'</span>
                                <span class="o">+</span> <span class="dl">'</span><span class="s1">&lt;span&gt;</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">publicationList</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">publishedIn</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">&lt;/span&gt;</span><span class="dl">'</span>
                                <span class="o">+</span> <span class="dl">'</span><span class="s1">&lt;span&gt;, </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">publishedDate</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">&lt;/span&gt;</span><span class="dl">'</span>
                                <span class="o">+</span> <span class="dl">'</span><span class="s1">&lt;span&gt;, </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">publishedDate</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">&lt;/span&gt;</span><span class="dl">'</span>
                                <span class="o">+</span> <span class="dl">'</span><span class="s1">&lt;span&gt;, Vol. </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">publicationList</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">volume</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">&lt;/span&gt;</span><span class="dl">'</span>
                                <span class="o">+</span> <span class="nx">number</span>
                                <span class="o">+</span> <span class="nx">pages</span>
                                <span class="o">+</span> <span class="nx">isbnIssn</span>
                                <span class="o">+</span> <span class="dl">'</span><span class="s1">&lt;div class="mt-2"&gt;</span><span class="dl">'</span>
                                <span class="o">+</span> <span class="nx">str</span>
                                <span class="o">+</span> <span class="dl">'</span><span class="s1">&lt;/div&gt;</span><span class="dl">'</span>
                                <span class="o">+</span> <span class="dl">'</span><span class="s1">&lt;/div&gt;</span><span class="dl">'</span><span class="p">);</span>

                            <span class="nx">publicationId</span><span class="o">++</span><span class="p">;</span>
                        <span class="p">}</span>
                    <span class="p">})</span>
                    <span class="p">.</span><span class="nx">fail</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">msg</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">searchFail</span><span class="p">();</span>
                        <span class="nx">$</span><span class="p">(</span><span class="dl">'</span><span class="s1">#loadingScroll</span><span class="dl">'</span><span class="p">).</span><span class="nx">hide</span><span class="p">();</span>
                    <span class="p">})</span>
            <span class="p">}</span>
        <span class="p">});</span>
    <span class="p">});</span>

    <span class="nx">$</span><span class="p">(</span><span class="dl">"</span><span class="s2">#search</span><span class="dl">"</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="nb">document</span><span class="p">.</span><span class="nx">form</span><span class="p">.</span><span class="nx">action</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">/publication/list_scroll</span><span class="dl">"</span><span class="p">;</span>
        <span class="nb">document</span><span class="p">.</span><span class="nx">form</span><span class="p">.</span><span class="nx">method</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">get</span><span class="dl">"</span><span class="p">;</span>
        <span class="nb">document</span><span class="p">.</span><span class="nx">form</span><span class="p">.</span><span class="nx">submit</span><span class="p">();</span>
    <span class="p">});</span>
<span class="nt">&lt;/script&gt;</span>

<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></table></code></div></div><h2 id="util">Util</h2><ul><li>Javascript: URI 파라미터 반환 및 URI 생성 기능을 담당하는 함수다.</ul><p>출처: &lt;https://m.blog.naver.com/PostView.nhn?blogId=hay6308&amp;logNo=220958671660&amp;proxyReferer=https:%2F%2Fwww.google.com%2F</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span text-data=" JavaScript "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">module</span><span class="o">-</span><span class="nx">app</span><span class="o">-</span><span class="nx">web</span><span class="o">/</span><span class="nx">src</span><span class="o">/</span><span class="nx">main</span><span class="o">/</span><span class="nx">resources</span><span class="o">/</span><span class="kd">static</span><span class="sr">/js/u</span><span class="nx">til</span><span class="p">.</span><span class="nx">js</span><span class="o">&gt;</span>

<span class="cm">/* URI 파라미터 반환 */</span>
<span class="kd">function</span> <span class="nx">getUriParams</span><span class="p">()</span> <span class="p">{</span>
   <span class="kd">var</span> <span class="nx">params</span> <span class="o">=</span> <span class="p">{};</span>
   <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">search</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/</span><span class="se">[</span><span class="sr">?&amp;</span><span class="se">]</span><span class="sr">+</span><span class="se">([^</span><span class="sr">=&amp;</span><span class="se">]</span><span class="sr">+</span><span class="se">)</span><span class="sr">=</span><span class="se">([^</span><span class="sr">&amp;</span><span class="se">]</span><span class="sr">*</span><span class="se">)</span><span class="sr">/gi</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">str</span><span class="p">,</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span> <span class="nx">params</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span> <span class="p">});</span>
   <span class="k">return</span> <span class="nx">params</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/* URI 생성 */</span>
<span class="kd">function</span> <span class="nx">makeGetUri</span><span class="p">(</span><span class="nx">uri</span><span class="p">,</span> <span class="nx">params</span><span class="p">)</span> <span class="p">{</span>
   <span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">params</span><span class="p">).</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
       <span class="nx">uri</span> <span class="o">+=</span> <span class="p">(</span><span class="nx">index</span> <span class="o">===</span> <span class="mi">0</span> <span class="p">?</span> <span class="dl">"</span><span class="s2">?</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">&amp;</span><span class="dl">"</span><span class="p">)</span> <span class="o">+</span> <span class="nx">key</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">=</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">params</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span>
   <span class="p">});</span>

   <span class="k">return</span> <span class="nx">uri</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><div class="language-html highlighter-rouge"><div class="code-header"> <span text-data=" HTML "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="nt">&lt;module-app-web</span><span class="err">/</span><span class="na">src</span><span class="err">/</span><span class="na">main</span><span class="err">/</span><span class="na">resources</span><span class="err">/</span><span class="na">templates</span><span class="err">/</span><span class="na">layout</span><span class="err">/</span><span class="na">script.html</span><span class="nt">&gt;</span>

<span class="nt">&lt;script </span><span class="na">th:src=</span><span class="s">"@{/js/jquery.min.js}"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">th:src=</span><span class="s">"@{/js/jquery.serialize-object.min.js}"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">th:src=</span><span class="s">"@{/js/bootstrap.bundle.min.js}"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">th:src=</span><span class="s">"@{/js/fileUtil.js}"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">th:src=</span><span class="s">"@{/js/util.js}"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">th:src=</span><span class="s">"@{/summernote/summernote.min.js}"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">th:inline=</span><span class="s">"javascript"</span><span class="nt">&gt;</span>
   <span class="nx">$</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
       <span class="kd">var</span> <span class="nx">csrfToken</span> <span class="o">=</span> <span class="cm">/*[[${_csrf.token}]]*/</span> <span class="kc">null</span><span class="p">;</span>
       <span class="kd">var</span> <span class="nx">csrfHeader</span> <span class="o">=</span> <span class="cm">/*[[${_csrf.headerName}]]*/</span> <span class="kc">null</span><span class="p">;</span>
       <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ajaxSend</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">,</span> <span class="nx">xhr</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
           <span class="nx">xhr</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="nx">csrfHeader</span><span class="p">,</span> <span class="nx">csrfToken</span><span class="p">);</span>
       <span class="p">});</span>
   <span class="p">});</span>
<span class="nt">&lt;/script&gt;</span>
</pre></table></code></div></div><h2 id="프로젝트-실행-및-결과">프로젝트 실행 및 결과</h2><ul><li>다음 이미지와 같이 무한 스크롤 논문 게시판을 확인할 수 있다.<li>검색 조건을 변경하는 따른 데이터가 출력되는 것을 확인할 수 있다.</ul><p><img data-proofer-ignore data-src="/assets/img/2020-09-05-Project Lab13/image1.png" alt="image" /></p><ul><li>스크롤을 하단으로 내려서 이벤트가 발생하면 다음 이미지와 같이 숨겨진 loading 이미지가 보이게 되고 ajax를 통하여 새로운 데이터를 받아 출력한다.</ul><p><img data-proofer-ignore data-src="/assets/img/2020-09-05-Project Lab13/image2.png" alt="image" /></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/web/'>Web</a>, <a href='/categories/project-lab/'>Project Lab</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Project Lab 13. 게시판 개발(무한 스크롤) - 9 - 끄적이판&url=https://scribnote5.github.io/posts/Project-Lab13/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Project Lab 13. 게시판 개발(무한 스크롤) - 9 - 끄적이판&u=https://scribnote5.github.io/posts/Project-Lab13/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Project Lab 13. 게시판 개발(무한 스크롤) - 9 - 끄적이판&url=https://scribnote5.github.io/posts/Project-Lab13/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/MISRA-C3/">함수 호출 인자 및 함수 매개변수의 한정자 관계</a><li><a href="/posts/Project-SW-Test-Forum17/">Project SW Test Forum 17. 유지보수 - 5</a><li><a href="/posts/Project-SW-Test-Forum16/">Project SW Test Forum 16. 유지보수 - 4</a><li><a href="/posts/MISRA-C-02-03/">MISRA C 2012_02_03 - 사용하지 않는 자료형 선언 제거</a><li><a href="/posts/MISRA-C-02-04/">MISRA C 2012_02_04 - 사용하지 않는 태그(struct, union, enum) 선언 제거</a></ul></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Project-Lab0/"><div class="card-body"> <span class="timeago small" >Apr 14, 2020<i class="unloaded">2020-04-14T00:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Project Lab 0. 연구실 홈페이지 개발 프로젝트 소개</h3><div class="text-muted small"><p> 연구실 홈페이지 개발 프로젝트를 소개한다. 계기 대학원 재학 중일 때 노후화된 연구실 홈페이지 유지보수를 담당하였다. 연구실 홈페이지는 난잡하게 개발되어 있었고 관련 문서가 하나도 없었기에 유지보수에 큰 어려움을 겪었다. 과거 회사 재직 중일 때 Spring을 사용하여 업무 시스템을 개발한 경험이 있다. 당시 초급 개발자로서 요구사항...</p></div></div></a></div><div class="card"> <a href="/posts/Project-Lab1-1/"><div class="card-body"> <span class="timeago small" >Jul 15, 2020<i class="unloaded">2020-07-15T00:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Project Lab 1-1. 개발 환경 구축(IntelliJ)</h3><div class="text-muted small"><p> 연구실 홈페이지 개발 프로젝트의 인텔리제이 개발 환경 구축 과정을 소개한다. 이클립스를 사용하여 개발 환경을 구축 한다면 ‘Project Lab 1-1. 개발 환경 구축(IntelliJ)’ 게시글을 참고하면 된다. 개발 환경 Windows 10 64bit jdk11.0.7 IntelliJ Ultimate 2021.1 프로젝...</p></div></div></a></div><div class="card"> <a href="/posts/Project-Lab1-2/"><div class="card-body"> <span class="timeago small" >Jul 15, 2020<i class="unloaded">2020-07-15T00:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Project Lab 1-2. 개발 환경 구축(Eclipse)</h3><div class="text-muted small"><p> 연구실 홈페이지 개발 프로젝트의 이클립스 개발 환경 구축 과정을 소개한다. 인텔리제이 사용하여 개발 환경을 구축 한다면 ‘Project Lab 1-1. 개발 환경 구축(IntelliJ)’’ 게시글을 참고하면 된다. 개발 환경 Windows 10 64bit jdk11.0.7 Spring Tools 4 for Eclipse(sts...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Project-Lab12/" class="btn btn-outline-primary" prompt="Older"><p>Project Lab 12. 게시판 개발(댓글) - 8</p></a> <a href="/posts/Project-Lab14/" class="btn btn-outline-primary" prompt="Newer"><p>Project Lab 14. 유효성 검사(javascript) - 1</p></a></div><div id="disqus_thread" class="pt-2 pb-2"><p class="text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script type="text/javascript"> var disqus_config = function () { this.page.url = 'https://scribnote5.github.io/posts/Project-Lab13/'; this.page.identifier = '/posts/Project-Lab13/'; }; /* Lazy loading */ var disqus_observer = new IntersectionObserver(function (entries) { if(entries[0].isIntersecting) { (function () { var d = document, s = d.createElement('script'); s.src = 'https://scribnote5-github-io.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); disqus_observer.disconnect(); } }, { threshold: [0] }); disqus_observer.observe(document.querySelector('#disqus_thread')); /* Auto switch theme */ function reloadDisqus() { /* Disqus hasn't been loaded */ if (typeof DISQUS === "undefined") { return; } if (document.readyState == 'complete') { DISQUS.reset({ reload: true, config: disqus_config }); } } const modeToggle = document.querySelector(".mode-toggle"); if (modeToggle !== null) { modeToggle.addEventListener('click', reloadDisqus); window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', reloadDisqus); } </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://github.com/scribnote5">scribnote5</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
