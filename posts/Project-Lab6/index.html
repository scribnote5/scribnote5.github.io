<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Project Lab 6. 게시판 개발(DTO, MapStruct) - 3" /><meta property="og:locale" content="en" /><meta name="description" content="Object Mapping를 제공하는 MapStruct를 사용하여, Domain 모델에서 DTO 모델로 변환하는 과정을 소개한다." /><meta property="og:description" content="Object Mapping를 제공하는 MapStruct를 사용하여, Domain 모델에서 DTO 모델로 변환하는 과정을 소개한다." /><link rel="canonical" href="https://scribnote5.github.io/posts/Project-Lab6/" /><meta property="og:url" content="https://scribnote5.github.io/posts/Project-Lab6/" /><meta property="og:site_name" content="끄적이판" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-08-02T00:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Project Lab 6. 게시판 개발(DTO, MapStruct) - 3" /><meta name="twitter:site" content="@" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"Object Mapping를 제공하는 MapStruct를 사용하여, Domain 모델에서 DTO 모델로 변환하는 과정을 소개한다.","url":"https://scribnote5.github.io/posts/Project-Lab6/","headline":"Project Lab 6. 게시판 개발(DTO, MapStruct) - 3","@type":"BlogPosting","dateModified":"2021-04-19T00:00:00+09:00","datePublished":"2020-08-02T00:00:00+09:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://scribnote5.github.io/posts/Project-Lab6/"},"@context":"https://schema.org"}</script><title>Project Lab 6. 게시판 개발(DTO, MapStruct) - 3 | 끄적이판</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="끄적이판"><meta name="application-name" content="끄적이판"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/banners/home.jpeg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">끄적이판</a></div><div class="site-subtitle font-italic">지금까지 공부한 것을 끄적이는 블로그</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/scribnote5" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['scribnote5','gmail.com'].join('@')" aria-label="email" class="order-4" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-5" > <i class="fas fa-rss"></i> </a> <a href="https://www.linkedin.com/in/daeyoung-song-175486167" aria-label="linkedin" class="order-6" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Project Lab 6. 게시판 개발(DTO, MapStruct) - 3</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Project Lab 6. 게시판 개발(DTO, MapStruct) - 3</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> scribnote5 </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sun, Aug 2, 2020, 12:00 AM +0900" >Aug 2, 2020<i class="unloaded">2020-08-02T00:00:00+09:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Mon, Apr 19, 2021, 12:00 AM +0000" >Apr 19, 2021<i class="unloaded">2021-04-19T00:00:00+09:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2480 words">13 min read</span></div></div><div class="post-content"><ul><li><p>Object Mapping를 제공하는 MapStruct를 사용하여, Domain 모델에서 DTO 모델로 변환하는 과정을 소개한다.</p><li>github: <a href="https://github.com/scribnote5/lab">https://github.com/scribnote5/lab</a><li><p>github commit: <a href="https://github.com/scribnote5/lab/commit/f0d7ab13069ebdb5ec8018f8da510c03790a08c5">https://github.com/scribnote5/lab/commit/f0d7ab13069ebdb5ec8018f8da510c03790a08c5</a></p><li>최신 프로젝트 코드와 형상이 다를 수 있습니다. 게시글 코드는 참고만 하시되, 최신 코드는 github에서 확인 부탁드립니다.</ul><h2 id="dtodata-transfer-object">DTO(Data Transfer Object)</h2><ul><li>계층간 데이터 교환을 위한 객체(Java Beans)이다.<li>DTO는 데이터 접근만을 위해 사용하는 Domain Model을 복사한 형태로, view에서 부가적으로 사용하는 데이터(멤버 필드)를 추가한 객체다.</ul><h2 id="dto를-사용하는-이유">DTO를 사용하는 이유</h2><ul><li>기존 Domain Model은 개발하기 빠르다는 장점이 있다.<li>하지만 프로젝트의 로직이 복잡해지는 경우, DTO를 사용하면 객체지향 프로그래밍을 할 수 있고, 프론트엔드와 백엔드에서 사용하는 데이터를 명확하게 구분지을 수 있어 추후 유지보수가 쉬워지는 장점이 있다.</ul><h3 id="객체의-역할을-철저하게-분리하기-위해">객체의 역할을 철저하게 분리하기 위해</h3><ul><li>Domain에 view 로직에서 사용되는 데이터가 포함될 수 있다. 따라서 모든 클래스는 하나의 책임만 가지 객체의 ‘단일 책임 원칙’을 위반하게 된다.</ul><h3 id="domain-model은-view-계층의-요구사항을-모두-반영할-수-없음">Domain model은 View 계층의 요구사항을 모두 반영할 수 없음</h3><ul><li>Domain은 실제 DB 테이블과 매칭되기에, view의 요구사항을 모두 반영하여 표현하기 어렵다. 만약 요구사항을 모두 반영하게 된다면 객체 간의 결합도가 증가하기 때문에 객체에서 코드를 수정하는 경우 다른 객체에서 코드 수정이 불가피하게 발생할 수 있으며 이를 개발자가 놓치는 경우 버그로 이어질 수 있다.</ul><p>출처: <a href="https://netframework.tistory.com/entry/16-Model-%EA%B8%B0%EC%88%A0-%EC%A0%95%EB%A6%AC-%EB%B0%8F-%EB%B9%84%EA%B5%90">https://netframework.tistory.com/entry/16-Model-%EA%B8%B0%EC%88%A0-%EC%A0%95%EB%A6%AC-%EB%B0%8F-%EB%B9%84%EA%B5%90</a><br /> <a href="https://gmlwjd9405.github.io/2018/12/25/difference-dao-dto-entity.html">https://gmlwjd9405.github.io/2018/12/25/difference-dao-dto-entity.html</a></p><h2 id="dto-사용-범위">DTO 사용 범위?</h2><ul><li>구글링한 결과, 이미 많은 개발자들은 ‘DTO의 사용 범위를 어디까지 정해야 하는가?’에 대한 고민을 계속 하였다.<li>‘DTO를 controller에서만 사용한다? DTO를 service까지 사용한다?’ 등 다양한 의견들이 있었지만, 이에 대한 명확한 해답은 없었다.<li><span style="color:red; font-weight: bold"> 프로젝트에서는 service 계층까지 DTO를 사용할 것이며, DTO &lt;-&gt; domain 간 객체 mapping 과정 또한 service 계층에서만 수행할 것이다.</span></ul><p>출처: <a href="https://velog.io/@aidenshin/DTO%EC%97%90-%EA%B4%80%ED%95%9C-%EA%B3%A0%EC%B0%B0">https://velog.io/@aidenshin/DTO%EC%97%90-%EA%B4%80%ED%95%9C-%EA%B3%A0%EC%B0%B0</a><br /> <a href="https://os94.tistory.com/157">https://os94.tistory.com/157</a><br /> <a href="https://yonguri.tistory.com/m/entry/Entity-DTO-%EA%B7%B8-%EC%82%AC%EC%9D%B4%EC%9D%98-ModelMapper-%EC%9D%B4%EC%95%BC%EA%B8%B0">https://yonguri.tistory.com/m/entry/Entity-DTO-%EA%B7%B8-%EC%82%AC%EC%9D%B4%EC%9D%98-ModelMapper-%EC%9D%B4%EC%95%BC%EA%B8%B0</a></p><h2 id="mapstrcut">Mapstrcut</h2><ul><li>DTO &lt;-&gt; Entity간 객체 mapping 소스 코드를 자동으로 생성하는 라이브러리다.<li>하단 출처처럼 객체 간 mapping을 지원하는 라이브러리가 많이 존재하지만, 가장 많이 사용하는 ModelMapper와 MapStruct의 처리 속도를 비교한 결과 MapStruct의 속도가 더 빠른 것으로 확인되어 MapStruct를 선택하게 되었다.</ul><p>출처: <a href="https://www.baeldung.com/java-performance-mapping-frameworks">https://www.baeldung.com/java-performance-mapping-frameworks</a></p><h2 id="의존성-라이브러리-관리">의존성 라이브러리 관리</h2><ul><li>Mapstrcut 의존성 라이브러리를 추가한다.<li>해당 프로젝트에서 사용하는 mapstruct 버전은 1.3.1이며, lombok 버전은 1.18.12다.<li><span style="color:red; font-weight: bold">Mapstruct의 의존성이 lombok 보다 먼저 선언되어야 한다.</span> 원인은 모르겠지만 의존성 순서가 변경되면 JUnit 테스트시 Mapper 인터페이스의 구현체인 MapperImpl 클래스를 인식하지 못하는 문제가 발생한다.</ul><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Text "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>&lt;build.gradle&gt;

...
// mapstruct, lombok 의존성보다 먼저 선언되어야 한다.
implementation "org.mapstruct:mapstruct:1.3.1.Final"
annotationProcessor "org.mapstruct:mapstruct-processor:1.3.1.Final"

// lombok
implementation "org.projectlombok:lombok"
annotationProcessor "org.projectlombok:lombok"
...
</pre></table></code></div></div><p><br /></p><ul><li>만약 lombok 버전이 1.18.16 이후인 경우 mapstruct 이슈로 매핑 코드가 생성되지 않으므로 다음과 같이 의존성 라이브러리를 선언해야 한다.</ul><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Text "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>&lt;build.gradle&gt;

// Mapstruct
implementation "org.mapstruct:mapstruct:1.4.2.Final"
annotationProcessor "org.mapstruct:mapstruct-processor:1.4.2.Final"

// lombok
implementation "org.projectlombok:lombok"
implementation "org.projectlombok:lombok-mapstruct-binding:0.2.0"
annotationProcessor "org.projectlombok:lombok"
annotationProcessor "org.projectlombok:lombok-mapstruct-binding:0.2.0"
</pre></table></code></div></div><p>출처: <a href="https://huisam.tistory.com/entry/mapStruct">https://huisam.tistory.com/entry/mapStruct</a><br /> <a href="https://wise-develop.tistory.com/18">https://wise-develop.tistory.com/18</a></p><h2 id="domain-및-dto">Domain 및 DTO</h2><ul><li>모든 Mapper 클래스가 공통적으로 사용하는 인터페이스다.<li>DTO &lt;-&gt; Entity간 객체 mapping을 담당하는 MapperImpl 클래스는 EntityMapper 인터페이스를 구현받으며, EntityMapper 인터페이스의 메소드는 Mapstruct에 의해 자동으로 DTO &lt;-&gt; Entity간 객체 mapping 소스 코드가 생성된다.<li>Gradle build 할 때 MapStruct는 자동으로 MapeprImpl 소스 코드를 생성한다. MapperImpl 소스 코드는 Domain 그리고 DTO에 선언된 setter 또는 builder 패턴에 의하여 매핑 코드를 생성한다. setter와 builder 패턴이 동시에 존재하는 경우 setter을 우선적으로 사용한다. 본 프로젝트에서는 Domain에서는 builder 패턴을 사용하였으며, DTO에서는 setter를 사용하여 매핑 코드를 생성gks다.</ul><div class="language-java highlighter-rouge"><div class="code-header"> <span text-data=" Java "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="n">module</span><span class="o">-</span><span class="n">domain</span><span class="o">-</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">java</span><span class="o">/</span><span class="n">kr</span><span class="o">/</span><span class="n">ac</span><span class="o">/</span><span class="n">univ</span><span class="o">/</span><span class="n">common</span><span class="o">/</span><span class="n">dto</span><span class="o">/</span><span class="n">mapper</span><span class="o">/</span><span class="nc">EntityMapper</span><span class="o">&gt;</span>

<span class="kn">package</span> <span class="nn">kr.ac.univ.common.dto.mapper</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">EntityMapper</span> <span class="o">&lt;</span><span class="nc">Dto</span><span class="o">,</span> <span class="nc">Entity</span><span class="o">&gt;</span> <span class="o">{</span>
   <span class="nc">Entity</span> <span class="nf">toEntity</span><span class="o">(</span><span class="nc">Dto</span> <span class="n">dto</span><span class="o">);</span>
   <span class="nc">Dto</span> <span class="nf">toDto</span><span class="o">(</span><span class="nc">Entity</span> <span class="n">entity</span><span class="o">);</span>
   <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Entity</span><span class="o">&gt;</span> <span class="nf">toEntity</span><span class="o">(</span><span class="nc">List</span><span class="o">&lt;</span><span class="nc">Dto</span><span class="o">&gt;</span> <span class="n">dto</span><span class="o">);</span>
   <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Dto</span><span class="o">&gt;</span> <span class="nf">toDto</span><span class="o">(</span><span class="nc">List</span><span class="o">&lt;</span><span class="nc">Entity</span><span class="o">&gt;</span> <span class="n">entity</span><span class="o">);</span>
<span class="o">}</span>
</pre></table></code></div></div><p><br /></p><ul><li>NoticeBoard Entity&lt;-&gt;DTO간 객체 mapping 소스 코드가 Mapstruct에 의해 생성되도록 메소드를 선언 및 하는 클래스다.</ul><div class="language-java highlighter-rouge"><div class="code-header"> <span text-data=" Java "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="n">module</span><span class="o">-</span><span class="n">domain</span><span class="o">-</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">java</span><span class="o">/</span><span class="n">kr</span><span class="o">/</span><span class="n">ac</span><span class="o">/</span><span class="n">univ</span><span class="o">/</span><span class="n">noticeBoard</span><span class="o">/</span><span class="nc">NoticeBoardMapper</span><span class="o">&gt;</span>

<span class="kn">package</span> <span class="nn">kr.ac.univ.noticeBoard.dto.mapper</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">kr.ac.univ.common.dto.mapper.EntityMapper</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.noticeBoard.domain.NoticeBoard</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.noticeBoard.dto.NoticeBoardDto</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.mapstruct.Mapper</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.mapstruct.factory.Mappers</span><span class="o">;</span>

<span class="nd">@Mapper</span><span class="o">(</span><span class="n">componentModel</span> <span class="o">=</span> <span class="s">"spring"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">NoticeBoardMapper</span> <span class="kd">extends</span> <span class="nc">EntityMapper</span><span class="o">&lt;</span><span class="nc">NoticeBoardDto</span><span class="o">,</span> <span class="nc">NoticeBoard</span><span class="o">&gt;</span> <span class="o">{</span>
   <span class="nc">NoticeBoardMapper</span> <span class="no">INSTANCE</span> <span class="o">=</span> <span class="nc">Mappers</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="nc">NoticeBoardMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

<span class="o">}</span>
</pre></table></code></div></div><p><br /></p><ul><li>Domain 클래스가 공통적으로 사용하는 데이터를 담은 클래스다. 모든 Domain 클래스는 CommonAudit 클래스를 상속 받는다.</ul><div class="language-java highlighter-rouge"><div class="code-header"> <span text-data=" Java "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="n">module</span><span class="o">-</span><span class="n">domain</span><span class="o">-</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">java</span><span class="o">/</span><span class="n">kr</span><span class="o">/</span><span class="n">ac</span><span class="o">/</span><span class="n">univ</span><span class="o">/</span><span class="n">common</span><span class="o">/</span><span class="n">domain</span><span class="o">/</span><span class="nc">CommonAudit</span><span class="o">&gt;</span>

<span class="kn">package</span> <span class="nn">kr.ac.univ.common.domain</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">kr.ac.univ.common.domain.enums.ActiveStatus</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.Getter</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.Setter</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.ToString</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.data.annotation.CreatedDate</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.data.annotation.LastModifiedDate</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.data.jpa.domain.support.AuditingEntityListener</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.persistence.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.time.LocalDateTime</span><span class="o">;</span>

<span class="nd">@MappedSuperclass</span>
<span class="nd">@Getter</span>
<span class="nd">@Setter</span>
<span class="nd">@ToString</span>
<span class="nd">@EntityListeners</span><span class="o">(</span><span class="nc">AuditingEntityListener</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">CommonAudit</span> <span class="o">{</span>
   <span class="nd">@Id</span>
   <span class="nd">@GeneratedValue</span><span class="o">(</span><span class="n">strategy</span> <span class="o">=</span> <span class="nc">GenerationType</span><span class="o">.</span><span class="na">IDENTITY</span><span class="o">)</span>
   <span class="kd">private</span> <span class="nc">Long</span> <span class="n">idx</span><span class="o">;</span>

   <span class="nd">@Column</span><span class="o">(</span><span class="n">nullable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">,</span> <span class="n">updatable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span>
   <span class="nd">@CreatedDate</span>
   <span class="kd">private</span> <span class="nc">LocalDateTime</span> <span class="n">createdDate</span><span class="o">;</span>

   <span class="nd">@LastModifiedDate</span>
   <span class="kd">private</span> <span class="nc">LocalDateTime</span> <span class="n">lastModifiedDate</span><span class="o">;</span>

   <span class="kd">private</span> <span class="nc">String</span> <span class="n">createdBy</span><span class="o">;</span>

   <span class="kd">private</span> <span class="nc">String</span> <span class="n">lastModifiedBy</span><span class="o">;</span>

   <span class="nd">@Enumerated</span><span class="o">(</span><span class="nc">EnumType</span><span class="o">.</span><span class="na">STRING</span><span class="o">)</span>
   <span class="kd">private</span> <span class="nc">ActiveStatus</span> <span class="n">activeStatus</span><span class="o">;</span>

   <span class="kd">private</span> <span class="nc">Long</span> <span class="n">views</span> <span class="o">=</span> <span class="mi">0L</span><span class="o">;</span>
<span class="o">}</span>
</pre></table></code></div></div><p><br /></p><ul><li>NoticeBoard에서 사용하는 Domain다.</ul><div class="language-java highlighter-rouge"><div class="code-header"> <span text-data=" Java "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="n">module</span><span class="o">-</span><span class="n">domain</span><span class="o">-</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">java</span><span class="o">/</span><span class="n">kr</span><span class="o">/</span><span class="n">ac</span><span class="o">/</span><span class="n">univ</span><span class="o">/</span><span class="n">noticeBoard</span><span class="o">/</span><span class="n">dto</span><span class="o">/</span><span class="nc">NoticeBoard</span><span class="o">&gt;</span>

<span class="kn">package</span> <span class="nn">kr.ac.univ.noticeBoard.domain</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">kr.ac.univ.common.domain.CommonAudit</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.common.domain.enums.ActiveStatus</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.noticeBoard.listener.NoticeBoardListener</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.Builder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.Getter</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.NoArgsConstructor</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.ToString</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.persistence.Column</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.persistence.Entity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.persistence.EntityListeners</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.persistence.Table</span><span class="o">;</span>

<span class="nd">@Getter</span>
<span class="nd">@NoArgsConstructor</span>
<span class="nd">@Entity</span>
<span class="nd">@Table</span>
<span class="nd">@ToString</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">NoticeBoard</span> <span class="kd">extends</span> <span class="nc">CommonAudit</span> <span class="o">{</span>
   <span class="kd">private</span> <span class="nc">String</span> <span class="n">title</span><span class="o">;</span>

   <span class="kd">private</span> <span class="nc">Long</span> <span class="n">mainPagePriority</span><span class="o">;</span>

   <span class="kd">private</span> <span class="nc">String</span> <span class="n">content</span><span class="o">;</span>

   <span class="nd">@Builder</span>
   <span class="kd">public</span> <span class="nf">NoticeBoard</span><span class="o">(</span><span class="nc">Long</span> <span class="n">idx</span><span class="o">,</span> <span class="nc">String</span> <span class="n">createdBy</span><span class="o">,</span> <span class="nc">String</span> <span class="n">lastModifiedBy</span><span class="o">,</span> <span class="nc">ActiveStatus</span> <span class="n">activeStatus</span><span class="o">,</span> <span class="nc">String</span> <span class="n">title</span><span class="o">,</span> <span class="nc">Long</span> <span class="n">mainPagePriority</span><span class="o">,</span> <span class="nc">String</span> <span class="n">content</span><span class="o">)</span> <span class="o">{</span>
       <span class="n">setIdx</span><span class="o">(</span><span class="n">idx</span><span class="o">);</span>
       <span class="n">setCreatedBy</span><span class="o">(</span><span class="n">createdBy</span><span class="o">);</span>
       <span class="n">setLastModifiedBy</span><span class="o">(</span><span class="n">lastModifiedBy</span><span class="o">);</span>
       <span class="n">setActiveStatus</span><span class="o">(</span><span class="n">activeStatus</span><span class="o">);</span>
       <span class="k">this</span><span class="o">.</span><span class="na">title</span> <span class="o">=</span> <span class="n">title</span><span class="o">;</span>
       <span class="k">this</span><span class="o">.</span><span class="na">mainPagePriority</span> <span class="o">=</span> <span class="n">mainPagePriority</span><span class="o">;</span>
       <span class="k">this</span><span class="o">.</span><span class="na">content</span> <span class="o">=</span> <span class="n">content</span><span class="o">;</span>
   <span class="o">}</span>

   <span class="kd">public</span> <span class="kt">void</span> <span class="nf">update</span><span class="o">(</span><span class="nc">NoticeBoard</span> <span class="n">noticeBoard</span><span class="o">)</span> <span class="o">{</span>
       <span class="n">setActiveStatus</span><span class="o">(</span><span class="n">noticeBoard</span><span class="o">.</span><span class="na">getActiveStatus</span><span class="o">());</span>
       <span class="k">this</span><span class="o">.</span><span class="na">title</span> <span class="o">=</span> <span class="n">noticeBoard</span><span class="o">.</span><span class="na">getTitle</span><span class="o">();</span>
       <span class="k">this</span><span class="o">.</span><span class="na">mainPagePriority</span> <span class="o">=</span> <span class="n">noticeBoard</span><span class="o">.</span><span class="na">getMainPagePriority</span><span class="o">();</span>
       <span class="k">this</span><span class="o">.</span><span class="na">content</span> <span class="o">=</span> <span class="n">noticeBoard</span><span class="o">.</span><span class="na">getContent</span><span class="o">();</span>
   <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p><br /></p><ul><li>DTO 클래스가 공통적으로 사용하는 데이터를 담은 클래스다. 모든 DTO 클래스는 CommonDto 클래스를 상속 받는다.</ul><div class="language-java highlighter-rouge"><div class="code-header"> <span text-data=" Java "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="n">module</span><span class="o">-</span><span class="n">domain</span><span class="o">-</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">java</span><span class="o">/</span><span class="n">kr</span><span class="o">/</span><span class="n">ac</span><span class="o">/</span><span class="n">univ</span><span class="o">/</span><span class="n">common</span><span class="o">/</span><span class="n">dto</span><span class="o">/</span><span class="nc">CommonDto</span><span class="o">&gt;</span>

<span class="kn">package</span> <span class="nn">kr.ac.univ.common.dto</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">lombok.Getter</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.NoArgsConstructor</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.Setter</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.ToString</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.time.LocalDateTime</span><span class="o">;</span>

<span class="nd">@Getter</span>
<span class="nd">@Setter</span>
<span class="nd">@NoArgsConstructor</span>
<span class="nd">@ToString</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CommonDto</span> <span class="o">{</span>
   <span class="kd">private</span> <span class="nc">Long</span> <span class="n">idx</span><span class="o">;</span>
   <span class="kd">private</span> <span class="nc">LocalDateTime</span> <span class="n">createdDate</span><span class="o">;</span>
   <span class="kd">private</span> <span class="nc">LocalDateTime</span> <span class="n">lastModifiedDate</span><span class="o">;</span>
   <span class="kd">private</span> <span class="nc">String</span> <span class="n">createdBy</span><span class="o">;</span>
   <span class="kd">private</span> <span class="nc">String</span> <span class="n">lastModifiedBy</span><span class="o">;</span>
   <span class="kd">private</span> <span class="kt">boolean</span> <span class="n">isAccess</span><span class="o">;</span>
<span class="o">}</span>
</pre></table></code></div></div><p><br /></p><ul><li>NoticeBoard에서 사용하는 DTO다.</ul><div class="language-java highlighter-rouge"><div class="code-header"> <span text-data=" Java "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="n">module</span><span class="o">-</span><span class="n">domain</span><span class="o">-</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">java</span><span class="o">/</span><span class="n">kr</span><span class="o">/</span><span class="n">ac</span><span class="o">/</span><span class="n">univ</span><span class="o">/</span><span class="n">noticeBoard</span><span class="o">/</span><span class="n">dto</span><span class="o">/</span><span class="nc">NoticeBoardDto</span><span class="o">&gt;</span>

<span class="kn">import</span> <span class="nn">kr.ac.univ.common.domain.enums.ActiveStatus</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.common.dto.CommonDto</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.Getter</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.NoArgsConstructor</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.Setter</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.ToString</span><span class="o">;</span>

<span class="nd">@Getter</span>
<span class="nd">@Setter</span>
<span class="nd">@NoArgsConstructor</span>
<span class="nd">@ToString</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">NoticeBoardDto</span> <span class="kd">extends</span> <span class="nc">CommonDto</span> <span class="o">{</span>
   <span class="cm">/* CommonDto: JPA Audit */</span>

   <span class="cm">/* 기본 정보 */</span>
   <span class="kd">private</span> <span class="nc">String</span> <span class="n">title</span><span class="o">;</span>
   <span class="kd">private</span> <span class="nc">String</span> <span class="n">content</span><span class="o">;</span>
   <span class="kd">private</span> <span class="nc">ActiveStatus</span> <span class="n">activeStatus</span><span class="o">;</span>
   <span class="kd">private</span> <span class="nc">Long</span> <span class="n">viewCount</span><span class="o">;</span>
<span class="o">}</span>
</pre></table></code></div></div><p><br /></p><ul><li>Gradle build를 수행하면 다음 이미지와 같이 프로젝트에서 MapperImpl 경로를 자동으로 인식하고 Mapper 인터페이스가 구현되어 MapperImpl 클래스가 자동으로 생성한다.<li><span style="color:red; font-weight: bold">DTO &lt;-&gt; Entity간 객체 mapping을 담당하는 소스 코드가 MapperImpl에 자동으로 생성되기 위해서는, domain에 builder pattern이 구현되야 한다. 자동으로 생성된 MapperImpl 클래스를 확인해 보면, builder pattern을 사용하여 mapping을 수행하는 것을 확인할 수 있다.</span></ul><p><img data-proofer-ignore data-src="/assets/img/2020-08-02-Project Lab6/image1.png" alt="image" /></p><p><img data-proofer-ignore data-src="/assets/img/2020-08-02-Project Lab6/image2.png" alt="image" /></p><h2 id="junit-test">JUnit Test</h2><ul><li>MapperImpl 클래스의 DTO &lt;-&gt; Entity간 객체 mapping을 테스트 하였다.</ul><div class="language-java highlighter-rouge"><div class="code-header"> <span text-data=" Java "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="n">module</span><span class="o">-</span><span class="n">app</span><span class="o">-</span><span class="n">web</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">java</span><span class="o">/</span><span class="n">kr</span><span class="o">/</span><span class="n">ac</span><span class="o">/</span><span class="n">univ</span><span class="o">/</span><span class="nc">MapStructTest</span><span class="o">&gt;</span>

<span class="kn">package</span> <span class="nn">kr.ac.univ</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">kr.ac.univ.noticeBoard.domain.NoticeBoard</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.noticeBoard.dto.NoticeBoardDto</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.noticeBoard.dto.mapper.NoticeBoardMapper</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.extern.slf4j.Slf4j</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.Assert</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.DisplayName</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Test</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.extension.ExtendWith</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.boot.autoconfigure.EnableAutoConfiguration</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.boot.test.context.SpringBootTest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.test.context.junit.jupiter.SpringExtension</span><span class="o">;</span>


<span class="nd">@SpringBootTest</span>
<span class="nd">@EnableAutoConfiguration</span>
<span class="nd">@ExtendWith</span><span class="o">(</span><span class="nc">SpringExtension</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="nd">@Slf4j</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MapStructTest</span> <span class="o">{</span>

   <span class="nd">@Test</span>
   <span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"Mapstrcut 테스트"</span><span class="o">)</span>
   <span class="kd">public</span> <span class="kt">void</span> <span class="nf">Test</span><span class="o">()</span> <span class="o">{</span>
       <span class="nc">NoticeBoardDto</span> <span class="n">noticeBoardDto</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">NoticeBoardDto</span><span class="o">();</span>
       <span class="n">noticeBoardDto</span><span class="o">.</span><span class="na">setTitle</span><span class="o">(</span><span class="s">"제목입니다"</span><span class="o">);</span>
       <span class="n">noticeBoardDto</span><span class="o">.</span><span class="na">setContent</span><span class="o">(</span><span class="s">"글입니다"</span><span class="o">);</span>

       <span class="nc">NoticeBoard</span> <span class="n">noticeBoard</span> <span class="o">=</span> <span class="nc">NoticeBoardMapper</span><span class="o">.</span><span class="na">INSTANCE</span><span class="o">.</span><span class="na">toEntity</span><span class="o">(</span><span class="n">noticeBoardDto</span><span class="o">);</span> <span class="c1">// DTO -&gt; Entity</span>

       <span class="nc">Assert</span><span class="o">.</span><span class="na">assertEquals</span><span class="o">(</span><span class="n">noticeBoardDto</span><span class="o">.</span><span class="na">getTitle</span><span class="o">(),</span> <span class="n">noticeBoard</span><span class="o">.</span><span class="na">getTitle</span><span class="o">());</span>
       <span class="nc">Assert</span><span class="o">.</span><span class="na">assertEquals</span><span class="o">(</span><span class="n">noticeBoardDto</span><span class="o">.</span><span class="na">getContent</span><span class="o">(),</span> <span class="n">noticeBoard</span><span class="o">.</span><span class="na">getContent</span><span class="o">());</span>
   <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><h2 id="service">Service</h2><ul><li>NoticeBoard의 비즈니스 로직이다.<li>MapStruct를 사용하여 DTO &lt;-&gt; Entitiy간 객체 mapping 소스 코드를 추가하였다.<li>findNoticeBoardList는 페이징 처리하여 NoticeBoard 리스트를 반환하는 메소드다. 해당 메소드에서 Pageable 객체는 Paging을 담당하고 NoticeBoard 리스트를 반환하는 객체로 DTO 변환 과정이 기존과 다르다. 해당 객체를 DTO로 변환하는 소스 코드는 하단 출처를 참고하였다.</ul><p>출처: <a href="https://effectivecode.tistory.com/1220">https://effectivecode.tistory.com/1220</a></p><div class="language-java highlighter-rouge"><div class="code-header"> <span text-data=" Java "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="n">module</span><span class="o">-</span><span class="n">domain</span><span class="o">-</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">java</span><span class="o">/</span><span class="n">kr</span><span class="o">/</span><span class="n">ac</span><span class="o">/</span><span class="n">univ</span><span class="o">/</span><span class="n">noticeBoard</span><span class="o">/</span><span class="n">service</span><span class="o">/</span><span class="nc">NoticeBoardService</span><span class="o">&gt;</span>

<span class="kn">package</span> <span class="nn">kr.ac.univ.noticeBoard.service</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">kr.ac.univ.noticeBoard.domain.NoticeBoard</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.noticeBoard.dto.NoticeBoardDto</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.noticeBoard.dto.mapper.NoticeBoardMapper</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.noticeBoard.repository.NoticeBoardRepository</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.noticeBoard.repository.NoticeBoardRepositoryImpl</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.data.domain.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Service</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.transaction.Transactional</span><span class="o">;</span>

<span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">NoticeBoardService</span> <span class="o">{</span>
   <span class="kd">private</span> <span class="kd">final</span> <span class="nc">NoticeBoardRepository</span> <span class="n">noticeBoardRepository</span><span class="o">;</span>
   <span class="kd">private</span> <span class="kd">final</span> <span class="nc">NoticeBoardRepositoryImpl</span> <span class="n">noticeBoardRepositoryImpl</span><span class="o">;</span>

   <span class="kd">public</span> <span class="nf">NoticeBoardService</span><span class="o">(</span><span class="nc">NoticeBoardRepository</span> <span class="n">noticeBoardRepository</span><span class="o">,</span> <span class="nc">NoticeBoardRepositoryImpl</span> <span class="n">noticeBoardRepositoryImpl</span><span class="o">)</span> <span class="o">{</span>
       <span class="k">this</span><span class="o">.</span><span class="na">noticeBoardRepository</span> <span class="o">=</span> <span class="n">noticeBoardRepository</span><span class="o">;</span>
       <span class="k">this</span><span class="o">.</span><span class="na">noticeBoardRepositoryImpl</span> <span class="o">=</span> <span class="n">noticeBoardRepositoryImpl</span><span class="o">;</span>
   <span class="o">}</span>

   <span class="kd">public</span> <span class="nc">Page</span><span class="o">&lt;</span><span class="nc">NoticeBoardDto</span><span class="o">&gt;</span> <span class="nf">findNoticeBoardList</span><span class="o">(</span><span class="nc">Pageable</span> <span class="n">pageable</span><span class="o">)</span> <span class="o">{</span>
       <span class="nc">Page</span><span class="o">&lt;</span><span class="nc">NoticeBoard</span><span class="o">&gt;</span> <span class="n">noticeBoardList</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

       <span class="n">pageable</span> <span class="o">=</span> <span class="nc">PageRequest</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">pageable</span><span class="o">.</span><span class="na">getPageNumber</span><span class="o">()</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="n">pageable</span><span class="o">.</span><span class="na">getPageNumber</span><span class="o">()</span> <span class="o">-</span> <span class="mi">1</span><span class="o">,</span> <span class="n">pageable</span><span class="o">.</span><span class="na">getPageSize</span><span class="o">(),</span> <span class="nc">Sort</span><span class="o">.</span><span class="na">Direction</span><span class="o">.</span><span class="na">DESC</span><span class="o">,</span> <span class="s">"idx"</span><span class="o">);</span>
       <span class="n">noticeBoardList</span> <span class="o">=</span> <span class="n">noticeBoardRepository</span><span class="o">.</span><span class="na">findAll</span><span class="o">(</span><span class="n">pageable</span><span class="o">);</span>

       <span class="k">return</span> <span class="k">new</span> <span class="nc">PageImpl</span><span class="o">&lt;</span><span class="nc">NoticeBoardDto</span><span class="o">&gt;(</span><span class="nc">NoticeBoardMapper</span><span class="o">.</span><span class="na">INSTANCE</span><span class="o">.</span><span class="na">toDto</span><span class="o">(</span><span class="n">noticeBoardList</span><span class="o">.</span><span class="na">getContent</span><span class="o">()),</span> <span class="n">pageable</span><span class="o">,</span> <span class="n">noticeBoardList</span><span class="o">.</span><span class="na">getTotalElements</span><span class="o">());</span>
   <span class="o">}</span>

   <span class="kd">public</span> <span class="nc">Long</span> <span class="nf">insertNoticeBoard</span><span class="o">(</span><span class="nc">NoticeBoard</span> <span class="n">noticeBoard</span><span class="o">)</span> <span class="o">{</span>

       <span class="k">return</span> <span class="n">noticeBoardRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">noticeBoard</span><span class="o">).</span><span class="na">getIdx</span><span class="o">();</span>
   <span class="o">}</span>

   <span class="kd">public</span> <span class="nc">NoticeBoardDto</span> <span class="nf">findNoticeBoardByIdx</span><span class="o">(</span><span class="nc">Long</span> <span class="n">idx</span><span class="o">)</span> <span class="o">{</span>
       <span class="n">noticeBoardRepositoryImpl</span><span class="o">.</span><span class="na">updateViewCountById</span><span class="o">(</span><span class="n">idx</span><span class="o">);</span>

       <span class="k">return</span> <span class="nc">NoticeBoardMapper</span><span class="o">.</span><span class="na">INSTANCE</span><span class="o">.</span><span class="na">toDto</span><span class="o">(</span><span class="n">noticeBoardRepository</span><span class="o">.</span><span class="na">findById</span><span class="o">(</span><span class="n">idx</span><span class="o">).</span><span class="na">orElse</span><span class="o">(</span><span class="k">new</span> <span class="nc">NoticeBoard</span><span class="o">()));</span>
   <span class="o">}</span>

   <span class="nd">@Transactional</span>
   <span class="kd">public</span> <span class="nc">Long</span> <span class="nf">updateNoticeBoard</span><span class="o">(</span><span class="nc">Long</span> <span class="n">idx</span><span class="o">,</span> <span class="nc">NoticeBoard</span> <span class="n">noticeBoard</span><span class="o">)</span> <span class="o">{</span>
       <span class="n">noticeBoardRepository</span><span class="o">.</span><span class="na">getOne</span><span class="o">(</span><span class="n">idx</span><span class="o">).</span><span class="na">update</span><span class="o">(</span><span class="n">noticeBoard</span><span class="o">);</span>

       <span class="k">return</span> <span class="n">noticeBoardRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">noticeBoard</span><span class="o">).</span><span class="na">getIdx</span><span class="o">();</span>
   <span class="o">}</span>

   <span class="kd">public</span> <span class="kt">void</span> <span class="nf">deleteNoticeBoardByIdx</span><span class="o">(</span><span class="nc">Long</span> <span class="n">idx</span><span class="o">)</span> <span class="o">{</span>
       <span class="n">noticeBoardRepository</span><span class="o">.</span><span class="na">deleteById</span><span class="o">(</span><span class="n">idx</span><span class="o">);</span>
   <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><h2 id="controller">Controller</h2><ul><li>NoticeBoard 관련 클라이언트의 요청을 view로 매핑한다.<li>Controller에서 view로 전달하는 noticeBoard 변수명을 noticeBoardDto로 변경하였다.</ul><div class="language-java highlighter-rouge"><div class="code-header"> <span text-data=" Java "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="n">module</span><span class="o">-</span><span class="n">app</span><span class="o">-</span><span class="n">web</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">java</span><span class="o">/</span><span class="n">kr</span><span class="o">/</span><span class="n">ac</span><span class="o">/</span><span class="n">univ</span><span class="o">/</span><span class="n">controller</span><span class="o">/</span><span class="nc">NoticeBoardController</span><span class="o">&gt;</span>

<span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">"noticeBoardDtoList"</span><span class="o">,</span> <span class="n">noticeBoardService</span><span class="o">.</span><span class="na">findNoticeBoardByIdx</span><span class="o">(</span><span class="n">idx</span><span class="o">));</span>
</pre></table></code></div></div><h2 id="view">View</h2><ul><li>NoticeBoard 관련 데이터를 화면에 출력한다.</ul><div class="language-java highlighter-rouge"><div class="code-header"> <span text-data=" Java "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="n">module</span><span class="o">-</span><span class="n">app</span><span class="o">-</span><span class="n">web</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">resources</span><span class="o">/</span><span class="n">templates</span><span class="o">/</span><span class="n">noticeBoard</span><span class="o">/</span><span class="n">list</span><span class="o">,</span> <span class="n">form</span><span class="o">,</span> <span class="n">read</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="n">tr</span> <span class="nl">th:</span><span class="n">each</span><span class="o">=</span><span class="s">"noticeBoardDto : ${noticeBoardDtoList}"</span><span class="o">&gt;</span>
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/web/'>Web</a>, <a href='/categories/project-lab/'>Project Lab</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Project Lab 6. 게시판 개발(DTO, MapStruct) - 3 - 끄적이판&url=https://scribnote5.github.io/posts/Project-Lab6/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Project Lab 6. 게시판 개발(DTO, MapStruct) - 3 - 끄적이판&u=https://scribnote5.github.io/posts/Project-Lab6/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Project Lab 6. 게시판 개발(DTO, MapStruct) - 3 - 끄적이판&url=https://scribnote5.github.io/posts/Project-Lab6/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/MISRA-C3/">함수 호출 인자 및 함수 매개변수의 한정자 관계</a><li><a href="/posts/Project-SW-Test-Forum17/">Project SW Test Forum 17. 유지보수 - 5</a><li><a href="/posts/Project-SW-Test-Forum16/">Project SW Test Forum 16. 유지보수 - 4</a><li><a href="/posts/MISRA-C-02-03/">MISRA C 2012_02_03 - 사용하지 않는 자료형 선언 제거</a><li><a href="/posts/MISRA-C-02-04/">MISRA C 2012_02_04 - 사용하지 않는 태그(struct, union, enum) 선언 제거</a></ul></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Project-Lab0/"><div class="card-body"> <span class="timeago small" >Apr 14, 2020<i class="unloaded">2020-04-14T00:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Project Lab 0. 연구실 홈페이지 개발 프로젝트 소개</h3><div class="text-muted small"><p> 연구실 홈페이지 개발 프로젝트를 소개한다. 계기 대학원 재학 중일 때 노후화된 연구실 홈페이지 유지보수를 담당하였다. 연구실 홈페이지는 난잡하게 개발되어 있었고 관련 문서가 하나도 없었기에 유지보수에 큰 어려움을 겪었다. 과거 회사 재직 중일 때 Spring을 사용하여 업무 시스템을 개발한 경험이 있다. 당시 초급 개발자로서 요구사항...</p></div></div></a></div><div class="card"> <a href="/posts/Project-Lab1-1/"><div class="card-body"> <span class="timeago small" >Jul 15, 2020<i class="unloaded">2020-07-15T00:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Project Lab 1-1. 개발 환경 구축(IntelliJ)</h3><div class="text-muted small"><p> 연구실 홈페이지 개발 프로젝트의 인텔리제이 개발 환경 구축 과정을 소개한다. 이클립스를 사용하여 개발 환경을 구축 한다면 ‘Project Lab 1-1. 개발 환경 구축(IntelliJ)’ 게시글을 참고하면 된다. 개발 환경 Windows 10 64bit jdk11.0.7 IntelliJ Ultimate 2021.1 프로젝...</p></div></div></a></div><div class="card"> <a href="/posts/Project-Lab1-2/"><div class="card-body"> <span class="timeago small" >Jul 15, 2020<i class="unloaded">2020-07-15T00:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Project Lab 1-2. 개발 환경 구축(Eclipse)</h3><div class="text-muted small"><p> 연구실 홈페이지 개발 프로젝트의 이클립스 개발 환경 구축 과정을 소개한다. 인텔리제이 사용하여 개발 환경을 구축 한다면 ‘Project Lab 1-1. 개발 환경 구축(IntelliJ)’’ 게시글을 참고하면 된다. 개발 환경 Windows 10 64bit jdk11.0.7 Spring Tools 4 for Eclipse(sts...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Reliability-Test3/" class="btn btn-outline-primary" prompt="Older"><p>무기체계 소프트웨어의 정적시험 개요</p></a> <a href="/posts/Project-Lab7/" class="btn btn-outline-primary" prompt="Newer"><p>Project Lab 7. 게시판 개발(새로운 글 표시) - 4</p></a></div><div id="disqus_thread" class="pt-2 pb-2"><p class="text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script type="text/javascript"> var disqus_config = function () { this.page.url = 'https://scribnote5.github.io/posts/Project-Lab6/'; this.page.identifier = '/posts/Project-Lab6/'; }; /* Lazy loading */ var disqus_observer = new IntersectionObserver(function (entries) { if(entries[0].isIntersecting) { (function () { var d = document, s = d.createElement('script'); s.src = 'https://scribnote5-github-io.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); disqus_observer.disconnect(); } }, { threshold: [0] }); disqus_observer.observe(document.querySelector('#disqus_thread')); /* Auto switch theme */ function reloadDisqus() { /* Disqus hasn't been loaded */ if (typeof DISQUS === "undefined") { return; } if (document.readyState == 'complete') { DISQUS.reset({ reload: true, config: disqus_config }); } } const modeToggle = document.querySelector(".mode-toggle"); if (modeToggle !== null) { modeToggle.addEventListener('click', reloadDisqus); window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', reloadDisqus); } </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://github.com/scribnote5">scribnote5</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
