<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Project Lab 8. 게시판 개발(파일 업로드 및 다운로드) - 5" /><meta property="og:locale" content="en" /><meta name="description" content="드래그앤드랍 기능을 지원하는 다중 파일 업로드 및 파일 다운로드를 ajax로 개발한 과정을 소개한다." /><meta property="og:description" content="드래그앤드랍 기능을 지원하는 다중 파일 업로드 및 파일 다운로드를 ajax로 개발한 과정을 소개한다." /><link rel="canonical" href="https://scribnote5.github.io/posts/Project-Lab8/" /><meta property="og:url" content="https://scribnote5.github.io/posts/Project-Lab8/" /><meta property="og:site_name" content="끄적이판" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-08-05T00:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Project Lab 8. 게시판 개발(파일 업로드 및 다운로드) - 5" /><meta name="twitter:site" content="@" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"드래그앤드랍 기능을 지원하는 다중 파일 업로드 및 파일 다운로드를 ajax로 개발한 과정을 소개한다.","url":"https://scribnote5.github.io/posts/Project-Lab8/","headline":"Project Lab 8. 게시판 개발(파일 업로드 및 다운로드) - 5","@type":"BlogPosting","dateModified":"2021-04-19T00:00:00+09:00","datePublished":"2020-08-05T00:00:00+09:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://scribnote5.github.io/posts/Project-Lab8/"},"@context":"https://schema.org"}</script><title>Project Lab 8. 게시판 개발(파일 업로드 및 다운로드) - 5 | 끄적이판</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="끄적이판"><meta name="application-name" content="끄적이판"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/banners/home.jpeg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">끄적이판</a></div><div class="site-subtitle font-italic">지금까지 공부한 것을 끄적이는 블로그</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/scribnote5" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['scribnote5','gmail.com'].join('@')" aria-label="email" class="order-4" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-5" > <i class="fas fa-rss"></i> </a> <a href="https://www.linkedin.com/in/daeyoung-song-175486167" aria-label="linkedin" class="order-6" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Project Lab 8. 게시판 개발(파일 업로드 및 다운로드) - 5</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Project Lab 8. 게시판 개발(파일 업로드 및 다운로드) - 5</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> scribnote5 </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Wed, Aug 5, 2020, 12:00 AM +0900" >Aug 5, 2020<i class="unloaded">2020-08-05T00:00:00+09:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Mon, Apr 19, 2021, 12:00 AM +0000" >Apr 19, 2021<i class="unloaded">2021-04-19T00:00:00+09:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="4822 words">26 min read</span></div></div><div class="post-content"><ul><li><p>드래그 앤 드랍 기능을 지원하는 다중 파일 업로드 및 파일 다운로드를 ajax로 개발한 과정을 소개한다.</p><li>github: <a href="https://github.com/scribnote5/lab">https://github.com/scribnote5/lab</a><li><p>github commit: <a href="https://github.com/scribnote5/lab/commit/c7dd944785ff76133498ff6e95df748b140c717b">https://github.com/scribnote5/lab/commit/c7dd944785ff76133498ff6e95df748b140c717b</a></p><li>최신 프로젝트 코드와 형상이 다를 수 있습니다. 게시글 코드는 참고만 하시되, 최신 코드는 github에서 확인 부탁드립니다.</ul><h2 id="파일-업로드-및-다운로드-설계">파일 업로드 및 다운로드 설계</h2><ul><li>Spirng은 MultipartResolver 인터페이스와 Servlet Multipart Request 그리고 Apache Commons FileUpload API 두 개의 구현체로 파일 업로드를 지원한다. 본 프로젝트에서는 Servlet Multipart Request를 사용하여 파일 업로드를 구현한다.<li>module-app-web 모듈 서버에서 다중 파일 업로드를 하게 되면 ajax를 통하여 요청하며, REST api를 사용하는 module-app-api 모듈 서버가 응답한다.<li>다중 파일 업로드는 드래그앤드랍 기능을 지원한다.</ul><p>출처: <a href="https://advenoh.tistory.com/26">https://advenoh.tistory.com/26</a> <a href="https://mkyong.com/spring-boot/spring-boot-file-upload-example-ajax-and-rest/">https://mkyong.com/spring-boot/spring-boot-file-upload-example-ajax-and-rest/</a><br /> <a href="https://doublesprogramming.tistory.com/130">https://doublesprogramming.tistory.com/130</a><br /> <a href="https://sooin01.tistory.com/m/entry/jQuery-ajax-%ED%8C%8C%EC%9D%BC%EC%97%85%EB%A1%9C%EB%93%9C">https://sooin01.tistory.com/m/entry/jQuery-ajax-%ED%8C%8C%EC%9D%BC%EC%97%85%EB%A1%9C%EB%93%9C</a><br /> <a href="https://cofs.tistory.com/181">https://cofs.tistory.com/181</a><br /> <a href="https://offbyone.tistory.com/69">https://offbyone.tistory.com/69</a><br /> <a href="https://okky.kr/article/610701">https://okky.kr/article/610701</a><br /> <a href="https://gofnrk.tistory.com/80">https://gofnrk.tistory.com/80</a></p><h2 id="table-설계">Table 설계</h2><ul><li>프로젝트에서 사용할 게시판 첨부 파일 table을 생성한다.</ul><div class="language-sql highlighter-rouge"><div class="code-header"> <span text-data=" Sql "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="n">notice_board_attached_file</span><span class="o">&gt;</span>

<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">notice_board_attached_file</span> <span class="p">(</span>
  <span class="n">idx</span>               <span class="nb">bigint</span> <span class="n">auto_increment</span>    <span class="k">primary</span> <span class="k">key</span><span class="p">,</span>
  <span class="n">created_by</span>        <span class="nb">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span>    <span class="k">null</span><span class="p">,</span>
  <span class="n">created_date</span>      <span class="nb">datetime</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>     <span class="k">null</span><span class="p">,</span>
  <span class="n">file_name</span>         <span class="nb">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span>    <span class="k">null</span><span class="p">,</span>
  <span class="n">saved_file_name</span>   <span class="nb">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span>    <span class="k">null</span><span class="p">,</span>
  <span class="n">notice_board_idx</span>  <span class="nb">bigint</span>          <span class="k">null</span><span class="p">,</span>
  <span class="n">file_size</span>         <span class="nb">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span>    <span class="k">null</span>
<span class="p">);</span>
</pre></table></code></div></div><h2 id="config">Config</h2><ul><li>max-swallow-size: 요청 body의 크기를 설정한다. 업로드되는 파일 크기가 제한(20MB)을 초과하여 예외가 발생하는 경우, 사용자 정의 예외처리 방식으로 수행되도록 구현하였다.<li>max-file-size과 max-request-size: 업로드되는 파일 크기를 제한한다. 만약 제한된 파일 업로드 크기보다 큰 파일이 업로드되는 경우 예외가 발생한다.<li><span style="color:red; font-weight: bold">파일 업로드 되는 경로는 /upload 폴더이므로, 해당 경로에 upload 폴더를 필수로 생성해야 한다.(root 프로젝트에 upload 폴더를 생성하면 된다.)</span></ul><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Text "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>&lt;module-app-api/src/main/resources/application.yml&gt;

spring:
 servlet:
   multipart:
     # 한개의 파일의 최대 크기
     max-file-size: 20MB
     # form-data 요청에 따른 모든 파일의 최대 크기
     max-request-size: 20MB
server:
   tomcat:
     max-swallow-size: -1
...
</pre></table></code></div></div><h2 id="domain-및-dto-설계">Domain 및 DTO 설계</h2><ul><li>모든 Attachedfile에서 공통적으로 사용하는 Domain다.</ul><div class="language-java highlighter-rouge"><div class="code-header"> <span text-data=" Java "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="n">module</span><span class="o">-</span><span class="n">domain</span><span class="o">-</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">java</span><span class="o">/</span><span class="n">kr</span><span class="o">/</span><span class="n">ac</span><span class="o">/</span><span class="n">univ</span><span class="o">/</span><span class="n">common</span><span class="o">/</span><span class="n">domain</span><span class="o">/</span><span class="nc">AttachedFileAudit</span><span class="o">.</span><span class="na">java</span><span class="o">&gt;</span>

<span class="kn">import</span> <span class="nn">lombok.Getter</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.data.jpa.domain.support.AuditingEntityListener</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.persistence.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.time.LocalDateTime</span><span class="o">;</span>

<span class="nd">@MappedSuperclass</span>
<span class="nd">@Getter</span>
<span class="nd">@EntityListeners</span><span class="o">(</span><span class="nc">AuditingEntityListener</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">AttachedFileAudit</span> <span class="o">{</span>
   <span class="nd">@Id</span>
   <span class="nd">@GeneratedValue</span><span class="o">(</span><span class="n">strategy</span> <span class="o">=</span> <span class="nc">GenerationType</span><span class="o">.</span><span class="na">IDENTITY</span><span class="o">)</span>
   <span class="kd">protected</span> <span class="nc">Long</span> <span class="n">idx</span><span class="o">;</span>

   <span class="kd">private</span> <span class="nc">LocalDateTime</span> <span class="n">createdDate</span><span class="o">;</span>

   <span class="kd">private</span> <span class="nc">String</span> <span class="n">createdBy</span><span class="o">;</span>
<span class="o">}</span>
</pre></table></code></div></div><p><br /></p><ul><li>NoticeBoard attachedfile에서 사용하는 DTO다.</ul><div class="language-java highlighter-rouge"><div class="code-header"> <span text-data=" Java "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="n">module</span><span class="o">-</span><span class="n">domain</span><span class="o">-</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">java</span><span class="o">/</span><span class="n">kr</span><span class="o">/</span><span class="n">ac</span><span class="o">/</span><span class="n">univ</span><span class="o">/</span><span class="n">noticeBoard</span><span class="o">/</span><span class="n">domain</span><span class="o">/</span><span class="nc">NoticeBoardAttachedFile</span><span class="o">.</span><span class="na">java</span><span class="o">&gt;</span>

<span class="kn">package</span> <span class="nn">kr.ac.univ.noticeBoard.domain</span><span class="o">;</span>


<span class="kn">import</span> <span class="nn">javax.persistence.Column</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.persistence.Entity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.persistence.EntityListeners</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.persistence.Table</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">kr.ac.univ.common.domain.AttachedFileAudit</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.data.jpa.domain.support.AuditingEntityListener</span><span class="o">;</span>


<span class="kn">import</span> <span class="nn">lombok.Builder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.Getter</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.NoArgsConstructor</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.ToString</span><span class="o">;</span>

<span class="nd">@Getter</span>
<span class="nd">@NoArgsConstructor</span>
<span class="nd">@Entity</span>
<span class="nd">@Table</span>
<span class="nd">@ToString</span>
<span class="nd">@EntityListeners</span><span class="o">(</span><span class="nc">AuditingEntityListener</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">NoticeBoardAttachedFile</span> <span class="kd">extends</span> <span class="nc">AttachedFileAudit</span> <span class="o">{</span>
   <span class="nd">@Column</span>
   <span class="kd">private</span> <span class="nc">Long</span> <span class="n">noticeBoardIdx</span><span class="o">;</span>

   <span class="nd">@Column</span>
   <span class="kd">private</span> <span class="nc">String</span> <span class="n">fileName</span><span class="o">;</span>

   <span class="nd">@Column</span>
   <span class="kd">private</span> <span class="nc">String</span> <span class="n">savedFileName</span><span class="o">;</span>

   <span class="nd">@Column</span>
   <span class="kd">private</span> <span class="nc">String</span> <span class="n">fileSize</span><span class="o">;</span>

   <span class="nd">@Builder</span>
   <span class="kd">public</span> <span class="nf">NoticeBoardAttachedFile</span><span class="o">(</span><span class="nc">Long</span> <span class="n">noticeBoardIdx</span><span class="o">,</span> <span class="nc">String</span> <span class="n">fileName</span><span class="o">,</span> <span class="nc">String</span> <span class="n">savedFileName</span><span class="o">,</span> <span class="nc">String</span> <span class="n">fileSize</span><span class="o">)</span> <span class="o">{</span>
       <span class="k">this</span><span class="o">.</span><span class="na">fileName</span> <span class="o">=</span> <span class="n">fileName</span><span class="o">;</span>
       <span class="k">this</span><span class="o">.</span><span class="na">noticeBoardIdx</span> <span class="o">=</span> <span class="n">noticeBoardIdx</span><span class="o">;</span>
       <span class="k">this</span><span class="o">.</span><span class="na">savedFileName</span> <span class="o">=</span> <span class="n">savedFileName</span><span class="o">;</span>
       <span class="k">this</span><span class="o">.</span><span class="na">fileSize</span> <span class="o">=</span> <span class="n">fileSize</span><span class="o">;</span>
   <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p><br /></p><ul><li>NoticeBoard 파일 업로드에 사용하는 DTO다.</ul><div class="language-java highlighter-rouge"><div class="code-header"> <span text-data=" Java "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="n">module</span><span class="o">-</span><span class="n">domain</span><span class="o">-</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">java</span><span class="o">/</span><span class="n">kr</span><span class="o">/</span><span class="n">ac</span><span class="o">/</span><span class="n">univ</span><span class="o">/</span><span class="n">noticeBoard</span><span class="o">/</span><span class="n">dto</span><span class="o">/</span><span class="nc">NoticeBoardDto</span><span class="o">.</span><span class="na">java</span><span class="o">&gt;</span>

<span class="kn">package</span> <span class="nn">kr.ac.univ.noticeBoard.dto</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">kr.ac.univ.common.domain.enums.ActiveStatus</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.common.dto.CommonDto</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.noticeBoard.domain.NoticeBoardAttachedFile</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.Getter</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.NoArgsConstructor</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.Setter</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.ToString</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.ArrayList</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="nd">@Getter</span>
<span class="nd">@Setter</span>
<span class="nd">@NoArgsConstructor</span>
<span class="nd">@ToString</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">NoticeBoardDto</span> <span class="kd">extends</span> <span class="nc">CommonDto</span> <span class="o">{</span>
   <span class="cm">/* CommonDto: JPA Audit */</span>

   <span class="cm">/* 기본 정보 */</span>
   <span class="kd">private</span> <span class="nc">String</span> <span class="n">title</span><span class="o">;</span>
   <span class="kd">private</span> <span class="nc">String</span> <span class="n">content</span><span class="o">;</span>
   <span class="kd">private</span> <span class="nc">ActiveStatus</span> <span class="n">activeStatus</span><span class="o">;</span>
   <span class="kd">private</span> <span class="nc">Long</span> <span class="n">viewCount</span><span class="o">;</span>

   <span class="cm">/* newIcon */</span>
   <span class="kd">private</span> <span class="kt">boolean</span> <span class="n">isNewIcon</span><span class="o">;</span>

   <span class="cm">/* 첨부 파일 */</span>
   <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">NoticeBoardAttachedFile</span><span class="o">&gt;</span> <span class="n">attachedFileList</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">NoticeBoardAttachedFile</span><span class="o">&gt;();</span>

<span class="o">}</span>
</pre></table></code></div></div><p><br /></p><ul><li>NoticeBoard DTO &lt;-&gt; Entity간 객체 mapping 소스 코드가 Mapstruct에 의해 생성되도록 메소드를 선언 및 정의하는 클래스다.<li>default 메소드는 사용자가 정의한 메소드로, NoticeBoardAttachedFile 파일 리스트를 NoticeBoardDto의 파일 리스트로 매핑한다.</ul><div class="language-java highlighter-rouge"><div class="code-header"> <span text-data=" Java "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="n">module</span><span class="o">-</span><span class="n">domain</span><span class="o">-</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">java</span><span class="o">/</span><span class="n">kr</span><span class="o">/</span><span class="n">ac</span><span class="o">/</span><span class="n">univ</span><span class="o">/</span><span class="n">noticeBoard</span><span class="o">/</span><span class="n">dto</span><span class="o">/</span><span class="n">mapper</span><span class="o">/</span><span class="nc">NoticeBoardMapper</span><span class="o">.</span><span class="na">java</span><span class="o">&gt;</span>

<span class="kn">package</span> <span class="nn">kr.ac.univ.noticeBoard.dto.mapper</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">kr.ac.univ.common.dto.mapper.EntityMapper</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.noticeBoard.domain.NoticeBoard</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.noticeBoard.domain.NoticeBoardAttachedFile</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.noticeBoard.dto.NoticeBoardDto</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.mapstruct.Mapper</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.mapstruct.factory.Mappers</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="nd">@Mapper</span><span class="o">(</span><span class="n">componentModel</span> <span class="o">=</span> <span class="s">"spring"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">NoticeBoardMapper</span> <span class="kd">extends</span> <span class="nc">EntityMapper</span><span class="o">&lt;</span><span class="nc">NoticeBoardDto</span><span class="o">,</span> <span class="nc">NoticeBoard</span><span class="o">&gt;</span> <span class="o">{</span>
   <span class="nc">NoticeBoardMapper</span> <span class="no">INSTANCE</span> <span class="o">=</span> <span class="nc">Mappers</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="nc">NoticeBoardMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

   <span class="k">default</span> <span class="nc">NoticeBoardDto</span> <span class="nf">toDto</span><span class="o">(</span><span class="nc">NoticeBoardDto</span> <span class="n">noticeBoardDto</span><span class="o">,</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">NoticeBoardAttachedFile</span><span class="o">&gt;</span> <span class="n">attachedFileList</span><span class="o">)</span> <span class="o">{</span>
       <span class="k">for</span> <span class="o">(</span><span class="nc">NoticeBoardAttachedFile</span> <span class="n">attachedFile</span> <span class="o">:</span> <span class="n">attachedFileList</span><span class="o">)</span> <span class="o">{</span>
           <span class="n">noticeBoardDto</span><span class="o">.</span><span class="na">getAttachedFileList</span><span class="o">().</span><span class="na">add</span><span class="o">(</span><span class="n">attachedFile</span><span class="o">);</span>
       <span class="o">}</span>

       <span class="k">return</span> <span class="n">noticeBoardDto</span><span class="o">;</span>
   <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><h2 id="repository">Repository</h2><ul><li>QueryDsl를 사용하여 다음과 같은 쿼리를 작성하였다.(JPA로 대체 가능하다.)<li>findAttachedFileByNoticeBoardIdx: 매개변수의 게시글 idx와 같은 파일을 모두 검색한다.<li>deleteAttachedFileByNoticeBoardIdx: 매개변수의 게시글 idx와 같은 파일을 모두 삭제한다</ul><div class="language-java highlighter-rouge"><div class="code-header"> <span text-data=" Java "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="n">module</span><span class="o">-</span><span class="n">domain</span><span class="o">-</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">java</span><span class="o">/</span><span class="n">kr</span><span class="o">/</span><span class="n">ac</span><span class="o">/</span><span class="n">univ</span><span class="o">/</span><span class="n">noticeBoard</span><span class="o">/</span><span class="n">repository</span><span class="o">/</span><span class="nc">NoticeBoardAttachedFileRepositoryImpl</span><span class="o">.</span><span class="na">java</span><span class="o">&gt;</span>

<span class="kn">package</span> <span class="nn">kr.ac.univ.noticeBoard.repository</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.transaction.Transactional</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">kr.ac.univ.noticeBoard.domain.NoticeBoardAttachedFile</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.noticeBoard.domain.QNoticeBoardAttachedFile</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.data.jpa.repository.support.QuerydslRepositorySupport</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Repository</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.querydsl.jpa.impl.JPAQueryFactory</span><span class="o">;</span>

<span class="nd">@Repository</span>
<span class="nd">@Transactional</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">NoticeBoardAttachedFileRepositoryImpl</span> <span class="kd">extends</span> <span class="nc">QuerydslRepositorySupport</span> <span class="o">{</span>
   <span class="kd">private</span> <span class="kd">final</span> <span class="nc">JPAQueryFactory</span> <span class="n">queryFactory</span><span class="o">;</span>

   <span class="kd">public</span> <span class="nf">NoticeBoardAttachedFileRepositoryImpl</span><span class="o">(</span><span class="nc">JPAQueryFactory</span> <span class="n">queryFactory</span><span class="o">)</span> <span class="o">{</span>
       <span class="kd">super</span><span class="o">(</span><span class="nc">NoticeBoardAttachedFile</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
       <span class="k">this</span><span class="o">.</span><span class="na">queryFactory</span> <span class="o">=</span> <span class="n">queryFactory</span><span class="o">;</span>
   <span class="o">}</span>

   <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">NoticeBoardAttachedFile</span><span class="o">&gt;</span> <span class="nf">findAttachedFileByNoticeBoardIdx</span><span class="o">(</span><span class="nc">Long</span> <span class="n">noticeBoardIdx</span><span class="o">)</span> <span class="o">{</span>
       <span class="nc">QNoticeBoardAttachedFile</span> <span class="n">noticeBoardAttachedFile</span> <span class="o">=</span> <span class="nc">QNoticeBoardAttachedFile</span><span class="o">.</span><span class="na">noticeBoardAttachedFile</span><span class="o">;</span>

       <span class="cm">/* SELECT *
        *   FROM AttachedFile
        *  WHERE noticeBoardIdx = 'noticeBoardIdx'
        *  ORDER BY idx asc
        */</span>
       <span class="k">return</span> <span class="n">queryFactory</span>
               <span class="o">.</span><span class="na">selectFrom</span><span class="o">(</span><span class="n">noticeBoardAttachedFile</span><span class="o">)</span>
               <span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="n">noticeBoardAttachedFile</span><span class="o">.</span><span class="na">noticeBoardIdx</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="n">noticeBoardIdx</span><span class="o">))</span>
               <span class="o">.</span><span class="na">orderBy</span><span class="o">(</span><span class="n">noticeBoardAttachedFile</span><span class="o">.</span><span class="na">idx</span><span class="o">.</span><span class="na">asc</span><span class="o">())</span>
               <span class="o">.</span><span class="na">fetch</span><span class="o">();</span>
   <span class="o">}</span>

   <span class="kd">public</span> <span class="nc">Long</span> <span class="nf">deleteAttachedFileByNoticeBoardIdx</span><span class="o">(</span><span class="nc">Long</span> <span class="n">noticeBoardIdx</span><span class="o">)</span> <span class="o">{</span>
       <span class="nc">QNoticeBoardAttachedFile</span> <span class="n">noticeBoardAttachedFile</span> <span class="o">=</span> <span class="nc">QNoticeBoardAttachedFile</span><span class="o">.</span><span class="na">noticeBoardAttachedFile</span><span class="o">;</span>

       <span class="cm">/* DELETE FROM AttachedFile
        *  WHERE noticeBoardIdx = 'noticeBoardIdx'
        */</span>
       <span class="k">return</span> <span class="n">queryFactory</span>
               <span class="o">.</span><span class="na">delete</span><span class="o">(</span><span class="n">noticeBoardAttachedFile</span><span class="o">)</span>
               <span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="n">noticeBoardAttachedFile</span><span class="o">.</span><span class="na">noticeBoardIdx</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="n">noticeBoardIdx</span><span class="o">))</span>
               <span class="o">.</span><span class="na">execute</span><span class="o">();</span>
   <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><h2 id="service">Service</h2><ul><li>NoticeBoard attachedfile의 비즈니스 로직이다.<li>uploadAttachedFile: view에서 전달받은 파일을 저장하는 로직이다.<li>파일명 앞에 고유한 식별문자를 생성하는 UUID를 사용하여 파일명 중복이 발생하지 않도록 하였다.<li>자바에서는 입출력 방법으로 IO 라이브러리와 NIO(New IO) 라이브러리를 사용할 수 있다.<li>NIO 라이브러리는 연결 클라이언트 수가 많고 하나의 입출력 처리 작업이 오래 걸리지 않는 경우에 사용하는 것이 좋다.<li>IO 라이브러리는 연결 클라이언트 수가 적고 전송되는 데이터가 대용량이면서 순차적으로 처리될 필요성이 있는 경우 사용하는 것이 좋다.<li>프로젝트에서는 업로드하는 파일 크기를 20 MB로 제한할 예정이므로, 적은 시간이 소요되는 입출력 처리 작업이 많은 프로젝트의 특성상 NIO 라이브러리가 IO 라이브러리 보다 성능상 더 유리하다고 생각하였다. 따라서 NIO 라이브러리를 사용하여 파일 업로드 및 다운로드를 구현하였다.</ul><p>출처: <a href="https://m.blog.naver.com/PostView.nhn?blogId=rain483&amp;logNo=220636709530&amp;proxyReferer=https:%2F%2Fwww.google.com%2F">https://m.blog.naver.com/PostView.nhn?blogId=rain483&amp;logNo=220636709530&amp;proxyReferer=https:%2F%2Fwww.google.com%2F</a><br /> <a href="http://eincs.com/2009/08/java-nio-bytebuffer-performance/">http://eincs.com/2009/08/java-nio-bytebuffer-performance/</a></p><div class="language-java highlighter-rouge"><div class="code-header"> <span text-data=" Java "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="n">module</span><span class="o">-</span><span class="n">domain</span><span class="o">-</span><span class="n">core</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">java</span><span class="o">/</span><span class="n">kr</span><span class="o">/</span><span class="n">ac</span><span class="o">/</span><span class="n">univ</span><span class="o">/</span><span class="n">noticeBoard</span><span class="o">/</span><span class="n">service</span><span class="o">/</span><span class="nc">NoticeBoardAttachedFileService</span><span class="o">.</span><span class="na">java</span><span class="o">&gt;</span>

<span class="kn">package</span> <span class="nn">kr.ac.univ.noticeBoard.service</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">kr.ac.univ.noticeBoard.domain.NoticeBoardAttachedFile</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.noticeBoard.dto.NoticeBoardDto</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.noticeBoard.dto.mapper.NoticeBoardMapper</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.noticeBoard.repository.NoticeBoardAttachedFileRepository</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.noticeBoard.repository.NoticeBoardAttachedFileRepositoryImpl</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.util.FileUtil</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Service</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.multipart.MultipartFile</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.file.Files</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.file.Path</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.file.Paths</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.UUID</span><span class="o">;</span>

<span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">NoticeBoardAttachedFileService</span> <span class="o">{</span>
   <span class="kd">private</span> <span class="kd">final</span> <span class="nc">NoticeBoardAttachedFileRepository</span> <span class="n">noticeBoardAttachedFileRepository</span><span class="o">;</span>
   <span class="kd">private</span> <span class="kd">final</span> <span class="nc">NoticeBoardAttachedFileRepositoryImpl</span> <span class="n">noticeBoardAttachedFileRepositoryImpl</span><span class="o">;</span>

   <span class="kd">public</span> <span class="nf">NoticeBoardAttachedFileService</span><span class="o">(</span><span class="nc">NoticeBoardAttachedFileRepository</span> <span class="n">noticeBoardAttachedFileRepository</span><span class="o">,</span> <span class="nc">NoticeBoardAttachedFileRepositoryImpl</span> <span class="n">noticeBoardAttachedFileRepositoryImpl</span><span class="o">)</span> <span class="o">{</span>
       <span class="k">this</span><span class="o">.</span><span class="na">noticeBoardAttachedFileRepository</span> <span class="o">=</span> <span class="n">noticeBoardAttachedFileRepository</span><span class="o">;</span>
       <span class="k">this</span><span class="o">.</span><span class="na">noticeBoardAttachedFileRepositoryImpl</span> <span class="o">=</span> <span class="n">noticeBoardAttachedFileRepositoryImpl</span><span class="o">;</span>
   <span class="o">}</span>

   <span class="kd">public</span> <span class="nc">NoticeBoardDto</span> <span class="nf">findAttachedFileByNoticeBoardIdx</span><span class="o">(</span><span class="nc">Long</span> <span class="n">noticeBoardIdx</span><span class="o">,</span> <span class="nc">NoticeBoardDto</span> <span class="n">noticeBoardDto</span><span class="o">)</span> <span class="o">{</span>

       <span class="k">return</span> <span class="nc">NoticeBoardMapper</span><span class="o">.</span><span class="na">INSTANCE</span><span class="o">.</span><span class="na">toDto</span><span class="o">(</span><span class="n">noticeBoardDto</span><span class="o">,</span> <span class="n">noticeBoardAttachedFileRepositoryImpl</span><span class="o">.</span><span class="na">findAttachedFileByNoticeBoardIdx</span><span class="o">(</span><span class="n">noticeBoardIdx</span><span class="o">));</span>

   <span class="o">}</span>

   <span class="kd">public</span> <span class="kt">void</span> <span class="nf">insertAttachedFile</span><span class="o">(</span><span class="nc">NoticeBoardAttachedFile</span> <span class="n">attachedFile</span><span class="o">)</span> <span class="o">{</span>
       <span class="n">noticeBoardAttachedFileRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">attachedFile</span><span class="o">);</span>
   <span class="o">}</span>

   <span class="kd">public</span> <span class="nc">NoticeBoardAttachedFile</span> <span class="nf">findAttachedFileByIdx</span><span class="o">(</span><span class="nc">Long</span> <span class="n">idx</span><span class="o">)</span> <span class="o">{</span>
       <span class="k">return</span> <span class="n">noticeBoardAttachedFileRepository</span><span class="o">.</span><span class="na">findById</span><span class="o">(</span><span class="n">idx</span><span class="o">).</span><span class="na">orElse</span><span class="o">(</span><span class="k">new</span> <span class="nc">NoticeBoardAttachedFile</span><span class="o">());</span>
   <span class="o">}</span>

   <span class="kd">public</span> <span class="nc">NoticeBoardAttachedFile</span> <span class="nf">getAttachedFileByIdx</span><span class="o">(</span><span class="nc">Long</span> <span class="n">idx</span><span class="o">)</span> <span class="o">{</span>
       <span class="k">return</span> <span class="n">noticeBoardAttachedFileRepository</span><span class="o">.</span><span class="na">getOne</span><span class="o">(</span><span class="n">idx</span><span class="o">);</span>
   <span class="o">}</span>

   <span class="kd">public</span> <span class="kt">void</span> <span class="nf">deleteAttachedFileByIdx</span><span class="o">(</span><span class="nc">Long</span> <span class="n">idx</span><span class="o">)</span> <span class="o">{</span>
       <span class="n">noticeBoardAttachedFileRepository</span><span class="o">.</span><span class="na">deleteById</span><span class="o">(</span><span class="n">idx</span><span class="o">);</span>
   <span class="o">}</span>

   <span class="kd">public</span> <span class="nc">Long</span> <span class="nf">deleteAttachedFileByNoticeBoardIdx</span><span class="o">(</span><span class="nc">Long</span> <span class="n">idx</span><span class="o">)</span> <span class="o">{</span>
       <span class="k">return</span> <span class="n">noticeBoardAttachedFileRepositoryImpl</span><span class="o">.</span><span class="na">deleteAttachedFileByNoticeBoardIdx</span><span class="o">(</span><span class="n">idx</span><span class="o">);</span>
   <span class="o">}</span>

   <span class="cm">/**
    * 첨부 파일 업로드
    *
    * @param noticeBoardIdx
    * @param files
    */</span>
   <span class="kd">public</span> <span class="kt">void</span> <span class="nf">uploadAttachedFile</span><span class="o">(</span><span class="nc">Long</span> <span class="n">noticeBoardIdx</span><span class="o">,</span> <span class="nc">MultipartFile</span><span class="o">[]</span> <span class="n">files</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
       <span class="nc">NoticeBoardAttachedFile</span> <span class="n">uploadFile</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">NoticeBoardAttachedFile</span><span class="o">();</span>

       <span class="k">for</span> <span class="o">(</span><span class="nc">MultipartFile</span> <span class="n">file</span> <span class="o">:</span> <span class="n">files</span><span class="o">)</span> <span class="o">{</span>
           <span class="nc">String</span> <span class="n">uuid</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">randomUUID</span><span class="o">().</span><span class="na">toString</span><span class="o">().</span><span class="na">replaceAll</span><span class="o">(</span><span class="s">"-"</span><span class="o">,</span> <span class="s">""</span><span class="o">);</span>
           <span class="nc">String</span> <span class="n">savedFileName</span> <span class="o">=</span> <span class="n">uuid</span> <span class="o">+</span> <span class="s">"_"</span> <span class="o">+</span> <span class="n">file</span><span class="o">.</span><span class="na">getOriginalFilename</span><span class="o">();</span>

           <span class="c1">// 대체 가능</span>
           <span class="c1">// File savedFile = new File("./upload/", savedFileName);</span>
           <span class="c1">// FileCopyUtils.copy(file.getBytes(), savedFile);</span>

           <span class="nc">Path</span> <span class="n">path</span> <span class="o">=</span> <span class="nc">Paths</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"./upload/"</span> <span class="o">+</span> <span class="n">savedFileName</span><span class="o">);</span>
           <span class="nc">Files</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">path</span><span class="o">,</span> <span class="n">file</span><span class="o">.</span><span class="na">getBytes</span><span class="o">());</span>

           <span class="n">uploadFile</span> <span class="o">=</span> <span class="nc">NoticeBoardAttachedFile</span><span class="o">.</span><span class="na">builder</span><span class="o">()</span>
                   <span class="o">.</span><span class="na">noticeBoardIdx</span><span class="o">(</span><span class="n">noticeBoardIdx</span><span class="o">)</span>
                   <span class="o">.</span><span class="na">fileName</span><span class="o">(</span><span class="n">file</span><span class="o">.</span><span class="na">getOriginalFilename</span><span class="o">())</span>
                   <span class="o">.</span><span class="na">savedFileName</span><span class="o">(</span><span class="n">savedFileName</span><span class="o">)</span>
                   <span class="o">.</span><span class="na">fileSize</span><span class="o">(</span><span class="nc">FileUtil</span><span class="o">.</span><span class="na">convertFileSize</span><span class="o">(</span><span class="n">file</span><span class="o">.</span><span class="na">getSize</span><span class="o">()))</span>
                   <span class="o">.</span><span class="na">build</span><span class="o">();</span>

           <span class="n">insertAttachedFile</span><span class="o">(</span><span class="n">uploadFile</span><span class="o">);</span>
       <span class="o">}</span>
   <span class="o">}</span>

   <span class="cm">/**
    * 첨부 파일 삭제
    *
    * @param deleteAttachedFileIdxList
    */</span>
   <span class="kd">public</span> <span class="kt">void</span> <span class="nf">deleteAttachedFile</span><span class="o">(</span><span class="nc">List</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">&gt;</span> <span class="n">deleteAttachedFileIdxList</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
       <span class="k">for</span> <span class="o">(</span><span class="nc">Long</span> <span class="n">idx</span> <span class="o">:</span> <span class="n">deleteAttachedFileIdxList</span><span class="o">)</span> <span class="o">{</span>
           <span class="nc">NoticeBoardAttachedFile</span> <span class="n">attachedFile</span> <span class="o">=</span> <span class="n">findAttachedFileByIdx</span><span class="o">(</span><span class="n">idx</span><span class="o">);</span>

           <span class="nc">Path</span> <span class="n">path</span> <span class="o">=</span> <span class="nc">Paths</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"./upload/"</span> <span class="o">+</span> <span class="n">attachedFile</span><span class="o">.</span><span class="na">getSavedFileName</span><span class="o">());</span>
           <span class="nc">Files</span><span class="o">.</span><span class="na">delete</span><span class="o">(</span><span class="n">path</span><span class="o">);</span>

           <span class="n">deleteAttachedFileByIdx</span><span class="o">(</span><span class="n">attachedFile</span><span class="o">.</span><span class="na">getIdx</span><span class="o">());</span>
       <span class="o">}</span>
   <span class="o">}</span>

   <span class="cm">/**
    * 모든 첨부 파일 삭제
    *
    * @param noticeBoardIdx
    */</span>
   <span class="kd">public</span> <span class="kt">void</span> <span class="nf">deleteAllAttachedFile</span><span class="o">(</span><span class="nc">Long</span> <span class="n">noticeBoardIdx</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
       <span class="nc">List</span><span class="o">&lt;</span><span class="nc">NoticeBoardAttachedFile</span><span class="o">&gt;</span> <span class="n">attachedFileList</span> <span class="o">=</span> <span class="n">noticeBoardAttachedFileRepositoryImpl</span><span class="o">.</span><span class="na">findAttachedFileByNoticeBoardIdx</span><span class="o">(</span><span class="n">noticeBoardIdx</span><span class="o">);</span>

       <span class="k">for</span> <span class="o">(</span><span class="nc">NoticeBoardAttachedFile</span> <span class="n">attachedFile</span> <span class="o">:</span> <span class="n">attachedFileList</span><span class="o">)</span> <span class="o">{</span>
           <span class="nc">Path</span> <span class="n">path</span> <span class="o">=</span> <span class="nc">Paths</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"./upload/"</span> <span class="o">+</span> <span class="n">attachedFile</span><span class="o">.</span><span class="na">getSavedFileName</span><span class="o">());</span>
           <span class="nc">Files</span><span class="o">.</span><span class="na">delete</span><span class="o">(</span><span class="n">path</span><span class="o">);</span>
       <span class="o">}</span>

       <span class="n">deleteAttachedFileByNoticeBoardIdx</span><span class="o">(</span><span class="n">noticeBoardIdx</span><span class="o">);</span>
   <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><h2 id="controller">Controller</h2><ul><li>NoticeBoard attachedfile 관련 클라이언트의 요청을 view로 매핑한다.<li>noticeBoardForm, noticeBoardRead: noticeBoard와 연관된 noticeBoard attachedfile을 데이터를 조회 후 noticeBoard 데이터와 함께 view에 전달한다.</ul><div class="language-java highlighter-rouge"><div class="code-header"> <span text-data=" Java "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="n">module</span><span class="o">-</span><span class="n">app</span><span class="o">-</span><span class="n">web</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">java</span><span class="o">/</span><span class="n">kr</span><span class="o">/</span><span class="n">ac</span><span class="o">/</span><span class="n">univ</span><span class="o">/</span><span class="n">controller</span><span class="o">/</span><span class="nc">NoticeBoardController</span><span class="o">.</span><span class="na">java</span><span class="o">&gt;</span>

<span class="kn">package</span> <span class="nn">kr.ac.univ.controller</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">kr.ac.univ.noticeBoard.dto.NoticeBoardDto</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.noticeBoard.dto.mapper.NoticeBoardMapper</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.noticeBoard.service.NoticeBoardAttachedFileService</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.noticeBoard.service.NoticeBoardService</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.data.domain.Pageable</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.data.web.PageableDefault</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Controller</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.ui.Model</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.GetMapping</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMapping</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestParam</span><span class="o">;</span>

<span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/notice-board"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">NoticeBoardController</span> <span class="o">{</span>
   <span class="kd">private</span> <span class="kd">final</span> <span class="nc">NoticeBoardService</span> <span class="n">noticeBoardService</span><span class="o">;</span>
   <span class="kd">private</span> <span class="kd">final</span> <span class="nc">NoticeBoardAttachedFileService</span> <span class="n">noticeBoardAttachedFileService</span><span class="o">;</span>

   <span class="kd">public</span> <span class="nf">NoticeBoardController</span><span class="o">(</span><span class="nc">NoticeBoardService</span> <span class="n">noticeBoardService</span><span class="o">,</span> <span class="nc">NoticeBoardAttachedFileService</span> <span class="n">noticeBoardAttachedFileService</span><span class="o">)</span> <span class="o">{</span>
       <span class="k">this</span><span class="o">.</span><span class="na">noticeBoardService</span> <span class="o">=</span> <span class="n">noticeBoardService</span><span class="o">;</span>
       <span class="k">this</span><span class="o">.</span><span class="na">noticeBoardAttachedFileService</span> <span class="o">=</span> <span class="n">noticeBoardAttachedFileService</span><span class="o">;</span>
   <span class="o">}</span>

   <span class="c1">// List</span>
   <span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/list"</span><span class="o">)</span>
   <span class="kd">public</span> <span class="nc">String</span> <span class="nf">noticeBoardList</span><span class="o">(</span><span class="nd">@PageableDefault</span> <span class="nc">Pageable</span> <span class="n">pageable</span><span class="o">,</span> <span class="nc">Model</span> <span class="n">model</span><span class="o">)</span> <span class="o">{</span>
       <span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">"noticeBoardDtoList"</span><span class="o">,</span> <span class="n">noticeBoardService</span><span class="o">.</span><span class="na">findNoticeBoardList</span><span class="o">(</span><span class="n">pageable</span><span class="o">));</span>

       <span class="k">return</span> <span class="s">"/noticeBoard/list"</span><span class="o">;</span>
   <span class="o">}</span>

   <span class="c1">// Form Update</span>
   <span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/form{idx}"</span><span class="o">)</span>
   <span class="kd">public</span> <span class="nc">String</span> <span class="nf">noticeBoardForm</span><span class="o">(</span><span class="nd">@RequestParam</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"idx"</span><span class="o">,</span> <span class="n">defaultValue</span> <span class="o">=</span> <span class="s">"0"</span><span class="o">)</span> <span class="nc">Long</span> <span class="n">idx</span><span class="o">,</span> <span class="nc">Model</span> <span class="n">model</span><span class="o">)</span> <span class="o">{</span>
       <span class="nc">NoticeBoardDto</span> <span class="n">noticeBoardDto</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

       <span class="n">noticeBoardDto</span> <span class="o">=</span> <span class="n">noticeBoardService</span><span class="o">.</span><span class="na">findNoticeBoardByIdx</span><span class="o">(</span><span class="n">idx</span><span class="o">);</span>
       <span class="n">noticeBoardDto</span> <span class="o">=</span> <span class="n">noticeBoardAttachedFileService</span><span class="o">.</span><span class="na">findAttachedFileByNoticeBoardIdx</span><span class="o">(</span><span class="n">idx</span><span class="o">,</span> <span class="n">noticeBoardDto</span><span class="o">);</span>

       <span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">"noticeBoardDto"</span><span class="o">,</span> <span class="n">noticeBoardDto</span><span class="o">);</span>

       <span class="k">return</span> <span class="s">"/noticeBoard/form"</span><span class="o">;</span>
   <span class="o">}</span>

   <span class="c1">// Read</span>
   <span class="nd">@GetMapping</span><span class="o">({</span><span class="s">""</span><span class="o">,</span> <span class="s">"/"</span><span class="o">})</span>
   <span class="kd">public</span> <span class="nc">String</span> <span class="nf">noticeBoardRead</span><span class="o">(</span><span class="nd">@RequestParam</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"idx"</span><span class="o">,</span> <span class="n">defaultValue</span> <span class="o">=</span> <span class="s">"0"</span><span class="o">)</span> <span class="nc">Long</span> <span class="n">idx</span><span class="o">,</span> <span class="nc">Model</span> <span class="n">model</span><span class="o">)</span> <span class="o">{</span>
       <span class="nc">NoticeBoardDto</span> <span class="n">noticeBoardDto</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

       <span class="n">noticeBoardDto</span> <span class="o">=</span> <span class="n">noticeBoardService</span><span class="o">.</span><span class="na">findNoticeBoardByIdx</span><span class="o">(</span><span class="n">idx</span><span class="o">);</span>
       <span class="n">noticeBoardDto</span> <span class="o">=</span> <span class="n">noticeBoardAttachedFileService</span><span class="o">.</span><span class="na">findAttachedFileByNoticeBoardIdx</span><span class="o">(</span><span class="n">idx</span><span class="o">,</span> <span class="n">noticeBoardDto</span><span class="o">);</span>

       <span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">"noticeBoardDto"</span><span class="o">,</span> <span class="n">noticeBoardDto</span><span class="o">);</span>

       <span class="k">return</span> <span class="s">"/noticeBoard/read"</span><span class="o">;</span>
   <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><h2 id="restcontroller">RestController</h2><ul><li>NoticeBoard attachedfile 관련 클라이언트의 요청을 처리 후 json 타입으로 응답한다.</ul><div class="language-java highlighter-rouge"><div class="code-header"> <span text-data=" Java "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="n">module</span><span class="o">-</span><span class="n">app</span><span class="o">-</span><span class="n">api</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">java</span><span class="o">/</span><span class="n">kr</span><span class="o">/</span><span class="n">ac</span><span class="o">/</span><span class="n">univ</span><span class="o">/</span><span class="n">controller</span><span class="o">/</span><span class="nc">NoticeBoardRestController</span><span class="o">.</span><span class="na">java</span><span class="o">&gt;</span>

<span class="kn">package</span> <span class="nn">kr.ac.univ.controller</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">kr.ac.univ.noticeBoard.dto.NoticeBoardDto</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.noticeBoard.service.NoticeBoardAttachedFileService</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">kr.ac.univ.noticeBoard.service.NoticeBoardService</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.http.HttpStatus</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.http.ResponseEntity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.multipart.MultipartFile</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="nd">@RestController</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/api/notice-boards"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">NoticeBoardRestController</span> <span class="o">{</span>
   <span class="kd">private</span> <span class="kd">final</span> <span class="nc">NoticeBoardService</span> <span class="n">noticeBoardService</span><span class="o">;</span>
   <span class="kd">private</span> <span class="kd">final</span> <span class="nc">NoticeBoardAttachedFileService</span> <span class="n">noticeBoardAttachedFileService</span><span class="o">;</span>

   <span class="kd">public</span> <span class="nf">NoticeBoardRestController</span><span class="o">(</span><span class="nc">NoticeBoardService</span> <span class="n">noticeBoardService</span><span class="o">,</span> <span class="nc">NoticeBoardAttachedFileService</span> <span class="n">noticeBoardAttachedFileService</span><span class="o">)</span> <span class="o">{</span>
       <span class="k">this</span><span class="o">.</span><span class="na">noticeBoardService</span> <span class="o">=</span> <span class="n">noticeBoardService</span><span class="o">;</span>
       <span class="k">this</span><span class="o">.</span><span class="na">noticeBoardAttachedFileService</span> <span class="o">=</span> <span class="n">noticeBoardAttachedFileService</span><span class="o">;</span>
   <span class="o">}</span>

   <span class="nd">@PostMapping</span>
   <span class="kd">public</span> <span class="nc">ResponseEntity</span><span class="o">&lt;?&gt;</span> <span class="n">postNoticeBoard</span><span class="o">(</span><span class="nd">@RequestBody</span> <span class="nc">NoticeBoardDto</span> <span class="n">noticeBoardDto</span><span class="o">)</span> <span class="o">{</span>
       <span class="nc">Long</span> <span class="n">idx</span> <span class="o">=</span> <span class="n">noticeBoardService</span><span class="o">.</span><span class="na">insertNoticeBoard</span><span class="o">(</span><span class="n">noticeBoardDto</span><span class="o">);</span>

       <span class="k">return</span> <span class="k">new</span> <span class="nc">ResponseEntity</span><span class="o">&lt;&gt;(</span><span class="n">idx</span><span class="o">,</span> <span class="nc">HttpStatus</span><span class="o">.</span><span class="na">CREATED</span><span class="o">);</span>
   <span class="o">}</span>

   <span class="nd">@PutMapping</span><span class="o">(</span><span class="s">"/{idx}"</span><span class="o">)</span>
   <span class="kd">public</span> <span class="nc">ResponseEntity</span><span class="o">&lt;?&gt;</span> <span class="n">putNoticeBoard</span><span class="o">(</span><span class="nd">@PathVariable</span><span class="o">(</span><span class="s">"idx"</span><span class="o">)</span> <span class="nc">Long</span> <span class="n">idx</span><span class="o">,</span> <span class="nd">@RequestBody</span> <span class="nc">NoticeBoardDto</span> <span class="n">noticeBoardDto</span><span class="o">)</span> <span class="o">{</span>
       <span class="n">noticeBoardService</span><span class="o">.</span><span class="na">updateNoticeBoard</span><span class="o">(</span><span class="n">idx</span><span class="o">,</span> <span class="n">noticeBoardDto</span><span class="o">);</span>

       <span class="k">return</span> <span class="k">new</span> <span class="nc">ResponseEntity</span><span class="o">&lt;&gt;(</span><span class="s">"{}"</span><span class="o">,</span> <span class="nc">HttpStatus</span><span class="o">.</span><span class="na">OK</span><span class="o">);</span>
   <span class="o">}</span>

   <span class="nd">@DeleteMapping</span><span class="o">(</span><span class="s">"/{idx}"</span><span class="o">)</span>
   <span class="kd">public</span> <span class="nc">ResponseEntity</span><span class="o">&lt;?&gt;</span> <span class="n">deleteNoticeBoard</span><span class="o">(</span><span class="nd">@PathVariable</span><span class="o">(</span><span class="s">"idx"</span><span class="o">)</span> <span class="nc">Long</span> <span class="n">idx</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
       <span class="n">noticeBoardService</span><span class="o">.</span><span class="na">deleteNoticeBoardByIdx</span><span class="o">(</span><span class="n">idx</span><span class="o">);</span>
       <span class="n">noticeBoardAttachedFileService</span><span class="o">.</span><span class="na">deleteAllAttachedFile</span><span class="o">(</span><span class="n">idx</span><span class="o">);</span>

       <span class="k">return</span> <span class="k">new</span> <span class="nc">ResponseEntity</span><span class="o">&lt;&gt;(</span><span class="s">"{}"</span><span class="o">,</span> <span class="nc">HttpStatus</span><span class="o">.</span><span class="na">OK</span><span class="o">);</span>
   <span class="o">}</span>

   <span class="c1">// 첨부 파일 업로드</span>
   <span class="nd">@PostMapping</span><span class="o">(</span><span class="s">"/attachedFile"</span><span class="o">)</span>
   <span class="kd">public</span> <span class="nc">ResponseEntity</span><span class="o">&lt;?&gt;</span> <span class="n">uploadAttachedFile</span><span class="o">(</span><span class="nc">Long</span> <span class="n">idx</span><span class="o">,</span> <span class="nc">MultipartFile</span><span class="o">[]</span> <span class="n">files</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
       <span class="n">noticeBoardAttachedFileService</span><span class="o">.</span><span class="na">uploadAttachedFile</span><span class="o">(</span><span class="n">idx</span><span class="o">,</span> <span class="n">files</span><span class="o">);</span>

       <span class="k">return</span> <span class="k">new</span> <span class="nc">ResponseEntity</span><span class="o">&lt;&gt;(</span><span class="s">"{}"</span><span class="o">,</span> <span class="nc">HttpStatus</span><span class="o">.</span><span class="na">CREATED</span><span class="o">);</span>
   <span class="o">}</span>

   <span class="c1">// 첨부 파일 삭제</span>
   <span class="nd">@DeleteMapping</span><span class="o">(</span><span class="s">"/attachedFile"</span><span class="o">)</span>
   <span class="kd">public</span> <span class="nc">ResponseEntity</span><span class="o">&lt;?&gt;</span> <span class="n">deleteAttachedFile</span><span class="o">(</span><span class="nd">@RequestBody</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">&gt;</span> <span class="n">deleteAttachedFileIdxList</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
       <span class="n">noticeBoardAttachedFileService</span><span class="o">.</span><span class="na">deleteAttachedFile</span><span class="o">(</span><span class="n">deleteAttachedFileIdxList</span><span class="o">);</span>

       <span class="k">return</span> <span class="k">new</span> <span class="nc">ResponseEntity</span><span class="o">&lt;&gt;(</span><span class="s">"{}"</span><span class="o">,</span> <span class="nc">HttpStatus</span><span class="o">.</span><span class="na">OK</span><span class="o">);</span>
   <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><ul><li>Attachedfile 다운로드 클라이언트의 요청을 응답한다.<li>downloadAttachedFile: 모든 파일 다운로드는 요청은 하나의 URL에서 담당하며, 파일 이름을 같이 전달한다.<li>헤더, MimeType(웹을 통해 전달되는 다양한 형태의 파일 정보), 다운로드 파일의 bytes 총 3개의 정보로 구성되어 파일 다운로드 요청에 응답한다.</ul><div class="language-java highlighter-rouge"><div class="code-header"> <span text-data=" Java "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="n">module</span><span class="o">-</span><span class="n">app</span><span class="o">-</span><span class="n">api</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">java</span><span class="o">/</span><span class="n">kr</span><span class="o">/</span><span class="n">ac</span><span class="o">/</span><span class="n">univ</span><span class="o">/</span><span class="n">controller</span><span class="o">/</span><span class="nc">AttachedFileRestController</span><span class="o">.</span><span class="na">java</span><span class="o">&gt;</span>

<span class="kn">package</span> <span class="nn">kr.ac.univ.controller</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.core.io.ByteArrayResource</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.http.HttpHeaders</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.http.MediaType</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.http.ResponseEntity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.GetMapping</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.PathVariable</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMapping</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RestController</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.net.URLEncoder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.file.Files</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.file.Path</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.file.Paths</span><span class="o">;</span>

<span class="nd">@RestController</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/api/attachedFiles"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">AttachedFileRestController</span> <span class="o">{</span>
   <span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/download/{savedFileName}"</span><span class="o">)</span>
   <span class="kd">public</span> <span class="nc">ResponseEntity</span><span class="o">&lt;?&gt;</span> <span class="n">downloadAttachedFile</span><span class="o">(</span><span class="nd">@PathVariable</span><span class="o">(</span><span class="s">"savedFileName"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">savedFileName</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
       <span class="c1">// 파일 이름이 한글인 경우 인코딩이 깨지지 않도록 변경</span>
       <span class="nc">String</span> <span class="n">encordedSavedFileName</span> <span class="o">=</span> <span class="nc">URLEncoder</span><span class="o">.</span><span class="na">encode</span><span class="o">(</span><span class="n">savedFileName</span><span class="o">,</span> <span class="s">"UTF-8"</span><span class="o">).</span><span class="na">replace</span><span class="o">(</span><span class="s">"+"</span><span class="o">,</span> <span class="s">"%20"</span><span class="o">);</span>

       <span class="c1">// 헤더 추가</span>
       <span class="nc">HttpHeaders</span> <span class="n">header</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HttpHeaders</span><span class="o">();</span>
       <span class="n">header</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="nc">HttpHeaders</span><span class="o">.</span><span class="na">CONTENT_DISPOSITION</span><span class="o">,</span> <span class="s">"attachment;filename="</span> <span class="o">+</span> <span class="n">encordedSavedFileName</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">33</span><span class="o">));</span>
       <span class="n">header</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"Cache-Control"</span><span class="o">,</span> <span class="s">"no-cache, no-store, must-revalidate"</span><span class="o">);</span>
       <span class="n">header</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"Pragma"</span><span class="o">,</span> <span class="s">"no-cache"</span><span class="o">);</span>
       <span class="n">header</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"Expires"</span><span class="o">,</span> <span class="s">"0"</span><span class="o">);</span>

       <span class="c1">// MimeType 추가, application/octet-stream은 text/plain 타입을 제외한 기본 값</span>
       <span class="nc">MediaType</span> <span class="n">mediaType</span> <span class="o">=</span> <span class="nc">MediaType</span><span class="o">.</span><span class="na">parseMediaType</span><span class="o">(</span><span class="s">"application/octet-stream"</span><span class="o">);</span>

       <span class="c1">// 다운로드 파일 추가</span>
       <span class="nc">Path</span> <span class="n">path</span> <span class="o">=</span> <span class="nc">Paths</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"./upload/"</span> <span class="o">+</span> <span class="n">savedFileName</span><span class="o">);</span>
       <span class="nc">ByteArrayResource</span> <span class="n">resource</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ByteArrayResource</span><span class="o">(</span><span class="nc">Files</span><span class="o">.</span><span class="na">readAllBytes</span><span class="o">(</span><span class="n">path</span><span class="o">));</span>

       <span class="k">return</span> <span class="nc">ResponseEntity</span><span class="o">.</span><span class="na">ok</span><span class="o">()</span>
               <span class="o">.</span><span class="na">headers</span><span class="o">(</span><span class="n">header</span><span class="o">)</span>
               <span class="o">.</span><span class="na">contentType</span><span class="o">(</span><span class="n">mediaType</span><span class="o">)</span>
               <span class="o">.</span><span class="na">body</span><span class="o">(</span><span class="n">resource</span><span class="o">);</span>
   <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><h2 id="view">View</h2><ul><li>NoticeBoard attachedfiled 관련 데이터를 화면에 출력한다.<li>input tag를 사용하거나, 파일 업로드 영역으로 파일을 드래그앤드랍 하면 파일을 업로드 할 수 있다.<li>파일을 업로드 하면 파일 데이터가 insertFileArray 배열에 추가되고 attachedFileList div 태그 내에 파일 데이터가 출력된다. 파일 데이터 오른쪽에 있는 X 아이콘을 클릭하면 해당되는 insertFileArray 배열의 요소와 attachedFileList div 태그내에 파일 데이터가 삭제되어 업로드 하는 파일을 취소할 수 있다.<li>게시글을 수정하는 경우 업로드된 파일 데이터가 uploadedAttachedFileList div 태그내에 파일 데이터가 출력된다. 파일 데이터 오른쪽에 있는 X 아이콘을 클릭하면 해당되는 파일 idx(pk)가 deleteFileArray 배열의 요소에 추가되고 uploadedAttachedFileList div 태그내에 파일 데이터가 삭제되어 업로드된 파일을 삭제할 수 있다.<li>게시글이 먼저 업로드된 다음 파일을 업로드가 진행되도록 구현하였다.(파일 업로드 수행시 게시글의 idx가 필요하기 때문이다.) 또한 파일을 수정하는 모든 경우를 고려하여 알고리즘 로직을 구현하였으며, 자세한 알고리즘 로직은 주석을 참고하면 된다.(3개의 첨부 파일 중 2개를 삭제하고 1개를 새로 업로드 하는 경우, 3개의 첨부 파일을 모두 삭제하는 경우, 첨부 파일이 없을 때 파일을 업로드하는 경우 등)<li>formdata 객체는 서버 전송에 필요한 데이터를 저장할 수 있다. 하지만 해당 객체는 보안상의 이유로 console.log(formdata);을 사용하여 객체 정보를 확인할 수 없다. formdata 객체의 정보를 확인하는 방법은 다음과 같다.</ul><div class="language-javascript highlighter-rouge"><div class="code-header"> <span text-data=" JavaScript "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">key</span> <span class="k">of</span> <span class="nx">formData</span><span class="p">.</span><span class="nx">keys</span><span class="p">())</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">key</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">value</span> <span class="k">of</span> <span class="nx">formData</span><span class="p">.</span><span class="nx">values</span><span class="p">())</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p>출처: <a href="https://programmerpsk.tistory.com/177">https://programmerpsk.tistory.com/177</a></p><div class="language-html highlighter-rouge"><div class="code-header"> <span text-data=" HTML "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
</pre><td class="rouge-code"><pre><span class="nt">&lt;module-app-web</span><span class="err">/</span><span class="na">src</span><span class="err">/</span><span class="na">main</span><span class="err">/</span><span class="na">resources</span><span class="err">/</span><span class="na">templates</span><span class="err">/</span><span class="na">noticeBoard</span><span class="err">/</span><span class="na">form.html</span><span class="nt">&gt;</span>

<span class="nt">&lt;tr&gt;</span>
   <span class="nt">&lt;th&gt;</span>Attached File<span class="nt">&lt;/th&gt;</span>
   <span class="nt">&lt;td&gt;</span>
       <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"file"</span> <span class="na">multiple=</span><span class="s">"multiple"</span> <span class="na">name=</span><span class="s">"file"</span> <span class="na">id=</span><span class="s">"file"</span><span class="nt">/&gt;</span>
       <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"fileDrop"</span> <span class="na">class=</span><span class="s">"fileDrop"</span><span class="nt">&gt;&lt;/div&gt;</span>
   <span class="nt">&lt;/td&gt;</span>
<span class="nt">&lt;/tr&gt;</span>
<span class="nt">&lt;tr&gt;</span>
   <span class="nt">&lt;th&gt;</span>Total file size<span class="nt">&lt;/th&gt;</span>
   <span class="nt">&lt;td&gt;</span>
       <span class="nt">&lt;div&gt;&lt;span</span> <span class="na">id=</span><span class="s">"totalFileSize"</span><span class="nt">&gt;</span> 0 MB<span class="nt">&lt;/span&gt;</span>, Up to 20 MB<span class="nt">&lt;/div&gt;</span>
   <span class="nt">&lt;/td&gt;</span>
<span class="nt">&lt;tr&gt;</span>
   <span class="nt">&lt;th&gt;</span>Uplaod Attached File<span class="nt">&lt;/th&gt;</span>
   <span class="nt">&lt;td&gt;</span>
       <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"attachedFileList"</span><span class="nt">&gt;&lt;/div&gt;</span>
   <span class="nt">&lt;/td&gt;</span>
<span class="nt">&lt;/tr&gt;</span>
<span class="nt">&lt;tr&gt;</span>
   <span class="nt">&lt;th&gt;</span>Uploaded Attached File<span class="nt">&lt;/th&gt;</span>
   <span class="nt">&lt;td&gt;</span>
       <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"uploadedAttachedFileList"</span> <span class="na">th:each=</span><span class="s">"attachedFile : *{attachedFileList}"</span><span class="nt">&gt;</span>
           <span class="nt">&lt;div</span> <span class="na">th:id=</span><span class="s">"imgData + ${attachedFileStat.index}"</span><span class="nt">&gt;</span>
               <span class="nt">&lt;span</span> <span class="na">th:text=</span><span class="s">"${attachedFile.fileName} + ',&amp;nbsp;' + 'File Size: ' + ${attachedFile.fileSize} + '&amp;nbsp;'"</span><span class="nt">&gt;&lt;/span&gt;</span>
               <span class="nt">&lt;img</span> <span class="na">th:attr=</span><span class="s">"src=@{|/images/cancel.png|}, onclick=|deleteFile('${attachedFileStat.index}','${attachedFile.idx}','${attachedFile.savedFileName}')|"</span>
                    <span class="na">th:style=</span><span class="s">"'width: 16px; height: 16px'"</span><span class="nt">/&gt;</span>
           <span class="nt">&lt;/div&gt;</span>
       <span class="nt">&lt;/div&gt;</span>
   <span class="nt">&lt;/td&gt;</span>
<span class="nt">&lt;/tr&gt;</span>

...

<span class="nt">&lt;script&gt;</span>
   <span class="kd">var</span> <span class="nx">totalFileSize</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
   <span class="kd">var</span> <span class="nx">insertFileArray</span> <span class="o">=</span> <span class="p">[];</span>
   <span class="kd">var</span> <span class="nx">deleteFileArray</span> <span class="o">=</span> <span class="p">[];</span>
   <span class="kd">var</span> <span class="nx">imgDataId</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
   <span class="kd">var</span> <span class="nx">exit</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

   <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
       <span class="o">&lt;!--</span> <span class="nx">summernote</span> <span class="nx">setting</span> <span class="o">--&gt;</span>
       <span class="nx">$</span><span class="p">(</span><span class="dl">'</span><span class="s1">#summernote</span><span class="dl">'</span><span class="p">).</span><span class="nx">summernote</span><span class="p">({</span>
           <span class="na">height</span><span class="p">:</span> <span class="mi">250</span><span class="p">,</span>   <span class="c1">// 에디터 높이</span>
           <span class="na">minHeight</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>   <span class="c1">// 최소 높이</span>
           <span class="na">maxHeight</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>   <span class="c1">// 최대 높이</span>
           <span class="c1">// focus: true,    // 에디터 로딩후 포커스를 맞출지 여부</span>
           <span class="na">lang</span><span class="p">:</span> <span class="dl">"</span><span class="s2">ko-KR</span><span class="dl">"</span><span class="p">,</span><span class="c1">// 한글 설정</span>
           <span class="na">placeholder</span><span class="p">:</span> <span class="dl">"</span><span class="s2">The editor's max input size of bytes is 16777215.</span><span class="dl">"</span>   <span class="c1">//placeholder 설정</span>

       <span class="p">});</span>

       <span class="o">&lt;!--</span> <span class="nx">File</span> <span class="nx">Drop</span> <span class="o">--&gt;</span>
       <span class="nx">$</span><span class="p">(</span><span class="dl">"</span><span class="s2">#fileDrop</span><span class="dl">"</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="dl">"</span><span class="s2">dragenter dragover</span><span class="dl">"</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
           <span class="nx">event</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span> <span class="c1">// 기본 이벤트 발생을 막음</span>
       <span class="p">});</span>
   <span class="p">});</span>

   <span class="cm">/* input tag event */</span>
   <span class="nx">$</span><span class="p">(</span><span class="dl">'</span><span class="s1">#file</span><span class="dl">'</span><span class="p">).</span><span class="nx">change</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
       <span class="kd">var</span> <span class="nx">files</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByName</span><span class="p">(</span><span class="dl">"</span><span class="s2">file</span><span class="dl">"</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">files</span><span class="p">;</span>

       <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">files</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
           <span class="nx">insertFileArray</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">files</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
           <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">totalFileSize</span><span class="dl">"</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">convertFileSize</span><span class="p">(</span><span class="nx">totalFileSize</span><span class="p">);</span>

           <span class="nx">$</span><span class="p">(</span><span class="dl">"</span><span class="s2">#attachedFileList</span><span class="dl">"</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="dl">'</span><span class="s1">&lt;div id="imgData</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">imgDataId</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">"&gt;</span><span class="dl">'</span>
               <span class="o">+</span> <span class="dl">'</span><span class="s1">&lt;span&gt;</span><span class="dl">'</span>
               <span class="o">+</span> <span class="nx">files</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">name</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">,&amp;nbsp; File Size: </span><span class="dl">"</span> <span class="o">+</span> <span class="nx">convertFileSize</span><span class="p">(</span><span class="nx">files</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">size</span><span class="p">)</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">&amp;nbsp;</span><span class="dl">"</span>
               <span class="o">+</span> <span class="dl">'</span><span class="s1">&lt;img src="/images/cancel.png" style="width: 16px; height: 16px" onClick="cancelFile(</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">imgDataId</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">)" /&gt;</span><span class="dl">'</span>
               <span class="o">+</span> <span class="dl">'</span><span class="s1">&lt;/span&gt;</span><span class="dl">'</span>
               <span class="o">+</span> <span class="dl">'</span><span class="s1">&lt;/div&gt;</span><span class="dl">'</span><span class="p">);</span>

           <span class="nx">imgDataId</span><span class="o">++</span><span class="p">;</span>
       <span class="p">}</span>
   <span class="p">});</span>

   <span class="cm">/* Drag &amp; drop event */</span>
   <span class="nx">$</span><span class="p">(</span><span class="dl">"</span><span class="s2">#fileDrop</span><span class="dl">"</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="dl">"</span><span class="s2">drop</span><span class="dl">"</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
       <span class="nx">event</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span> <span class="c1">// 기본 효과를 막음</span>
       <span class="c1">// 드래그된 파일의 정보</span>
       <span class="c1">// event : jQuery의 이벤트</span>
       <span class="c1">// originalEvent : javascript의 이벤트</span>
       <span class="kd">var</span> <span class="nx">files</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">originalEvent</span><span class="p">.</span><span class="nx">dataTransfer</span><span class="p">.</span><span class="nx">files</span><span class="p">;</span>

       <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">files</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
           <span class="nx">insertFileArray</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">files</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
           <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">totalFileSize</span><span class="dl">"</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">convertFileSize</span><span class="p">(</span><span class="nx">totalFileSize</span><span class="p">);</span>

           <span class="nx">$</span><span class="p">(</span><span class="dl">"</span><span class="s2">#attachedFileList</span><span class="dl">"</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="dl">'</span><span class="s1">&lt;div id="imgData</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">imgDataId</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">"&gt;</span><span class="dl">'</span>
               <span class="o">+</span> <span class="dl">'</span><span class="s1">&lt;span&gt;</span><span class="dl">'</span>
               <span class="o">+</span> <span class="nx">files</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">name</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">,&amp;nbsp; File Size: </span><span class="dl">"</span> <span class="o">+</span> <span class="nx">convertFileSize</span><span class="p">(</span><span class="nx">files</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">size</span><span class="p">)</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">&amp;nbsp;</span><span class="dl">"</span>
               <span class="o">+</span> <span class="dl">'</span><span class="s1">&lt;img src="/images/cancel.png" style="width: 16px; height: 16px" onClick="cancelFile(</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">imgDataId</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">)" /&gt;</span><span class="dl">'</span>
               <span class="o">+</span> <span class="dl">'</span><span class="s1">&lt;/span&gt;</span><span class="dl">'</span>
               <span class="o">+</span> <span class="dl">'</span><span class="s1">&lt;/div&gt;</span><span class="dl">'</span><span class="p">);</span>

           <span class="nx">imgDataId</span><span class="o">++</span><span class="p">;</span>
       <span class="p">}</span>
   <span class="p">});</span>

   <span class="c1">// 새로 업로드한 파일을 취소하는 경우</span>
   <span class="kd">function</span> <span class="nx">cancelFile</span><span class="p">(</span><span class="nx">fileId</span><span class="p">)</span> <span class="p">{</span>
       <span class="nx">$</span><span class="p">(</span><span class="dl">'</span><span class="s1">#imgData</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">fileId</span><span class="p">).</span><span class="nx">remove</span><span class="p">();</span>

       <span class="nx">insertFileArray</span><span class="p">[</span><span class="nx">fileId</span><span class="p">]</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
   <span class="p">}</span>

   <span class="c1">// 기존 업로드한 파일을 삭제하는 경우</span>
   <span class="kd">function</span> <span class="nx">deleteFile</span><span class="p">(</span><span class="nx">fileId</span><span class="p">,</span> <span class="nx">idx</span><span class="p">,</span> <span class="nx">savedFileName</span><span class="p">)</span> <span class="p">{</span>
       <span class="nx">$</span><span class="p">(</span><span class="dl">'</span><span class="s1">#imgData</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">fileId</span><span class="p">).</span><span class="nx">remove</span><span class="p">();</span>

       <span class="nx">deleteFileArray</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">idx</span><span class="p">);</span>
   <span class="p">}</span>

   <span class="kd">function</span> <span class="nx">deleteNoticeBoard</span><span class="p">(</span><span class="nx">noticeBoardIdx</span><span class="p">)</span> <span class="p">{</span>
       <span class="c1">// 게시글 삭제</span>
       <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
           <span class="na">url</span><span class="p">:</span> <span class="dl">"</span><span class="s2">/api/notice-boards/</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">noticeBoardIdx</span><span class="p">,</span>
           <span class="na">type</span><span class="p">:</span> <span class="dl">"</span><span class="s2">delete</span><span class="dl">"</span><span class="p">,</span>
           <span class="na">dataType</span><span class="p">:</span> <span class="dl">"</span><span class="s2">text</span><span class="dl">"</span><span class="p">,</span>
           <span class="na">contentType</span><span class="p">:</span> <span class="dl">"</span><span class="s2">application/json</span><span class="dl">"</span><span class="p">,</span>
           <span class="na">async</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
       <span class="p">})</span>
           <span class="p">.</span><span class="nx">done</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">msg</span><span class="p">)</span> <span class="p">{</span>
               <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">NoticeBoard delete success.</span><span class="dl">"</span><span class="p">);</span>
           <span class="p">})</span>
           <span class="p">.</span><span class="nx">fail</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">msg</span><span class="p">)</span> <span class="p">{</span>
               <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">NoticeBoard delete fail.</span><span class="dl">"</span><span class="p">);</span>
           <span class="p">});</span>
   <span class="p">}</span>
<span class="nt">&lt;/script&gt;</span>

<span class="nt">&lt;script </span><span class="na">th:if=</span><span class="s">"!${noticeBoardDto?.idx}"</span><span class="nt">&gt;</span>
   <span class="nx">$</span><span class="p">(</span><span class="dl">'</span><span class="s1">#insert</span><span class="dl">'</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
       <span class="kd">var</span> <span class="nx">jsonData</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="dl">"</span><span class="s2">#form</span><span class="dl">"</span><span class="p">).</span><span class="nx">serializeObject</span><span class="p">();</span>
       <span class="kd">var</span> <span class="nx">noticeBoardIdx</span><span class="p">;</span>

       <span class="c1">// 게시글 업로드</span>
       <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
           <span class="na">url</span><span class="p">:</span> <span class="dl">"</span><span class="s2">http://localhost:8081/api/notice-boards</span><span class="dl">"</span><span class="p">,</span>
           <span class="na">type</span><span class="p">:</span> <span class="dl">"</span><span class="s2">post</span><span class="dl">"</span><span class="p">,</span>
           <span class="na">data</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">jsonData</span><span class="p">),</span>
           <span class="na">dataType</span><span class="p">:</span> <span class="dl">"</span><span class="s2">text</span><span class="dl">"</span><span class="p">,</span>
           <span class="na">contentType</span><span class="p">:</span> <span class="dl">"</span><span class="s2">application/json</span><span class="dl">"</span><span class="p">,</span>
           <span class="na">async</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
       <span class="p">})</span>
           <span class="p">.</span><span class="nx">done</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">msg</span><span class="p">)</span> <span class="p">{</span>
               <span class="nx">noticeBoardIdx</span> <span class="o">=</span> <span class="nx">msg</span><span class="p">;</span>
               <span class="nx">exit</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
           <span class="p">})</span>
           <span class="p">.</span><span class="nx">fail</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">msg</span><span class="p">)</span> <span class="p">{</span>
               <span class="nx">exit</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
           <span class="p">});</span>

       <span class="k">if</span> <span class="p">(</span><span class="nx">exit</span><span class="p">)</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>

       <span class="c1">// 파일 업로드</span>
       <span class="kd">var</span> <span class="nx">formData</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">FormData</span><span class="p">();</span>

       <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">insertFileArray</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
           <span class="nx">formData</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="dl">"</span><span class="s2">files</span><span class="dl">"</span><span class="p">,</span> <span class="nx">insertFileArray</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
       <span class="p">}</span>

       <span class="nx">formData</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="dl">"</span><span class="s2">idx</span><span class="dl">"</span><span class="p">,</span> <span class="nx">noticeBoardIdx</span><span class="p">);</span>

       <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
           <span class="na">url</span><span class="p">:</span> <span class="dl">"</span><span class="s2">http://localhost:8081/api/notice-boards/attachedFile</span><span class="dl">"</span><span class="p">,</span>
           <span class="na">type</span><span class="p">:</span> <span class="dl">"</span><span class="s2">post</span><span class="dl">"</span><span class="p">,</span>
           <span class="na">data</span><span class="p">:</span> <span class="nx">formData</span><span class="p">,</span>
           <span class="na">dataType</span><span class="p">:</span> <span class="dl">"</span><span class="s2">text</span><span class="dl">"</span><span class="p">,</span>
           <span class="na">enctype</span><span class="p">:</span> <span class="dl">'</span><span class="s1">multipart/form-data</span><span class="dl">'</span><span class="p">,</span>
           <span class="na">processData</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
           <span class="na">contentType</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
           <span class="na">async</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
       <span class="p">})</span>
           <span class="p">.</span><span class="nx">done</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">msg</span><span class="p">)</span> <span class="p">{</span>
               <span class="nx">location</span><span class="p">.</span><span class="nx">href</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">/notice-board?idx=</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">noticeBoardIdx</span><span class="p">;</span>
           <span class="p">})</span>
           <span class="p">.</span><span class="nx">fail</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">msg</span><span class="p">)</span> <span class="p">{</span>
               <span class="nx">deleteNoticeBoard</span><span class="p">(</span><span class="nx">noticeBoardIdx</span><span class="p">);</span>
           <span class="p">});</span>

   <span class="p">});</span>
<span class="nt">&lt;/script&gt;</span>

<span class="nt">&lt;script </span><span class="na">th:if=</span><span class="s">"${noticeBoardDto?.idx}"</span> <span class="na">th:inline=</span><span class="s">"javascript"</span><span class="nt">&gt;</span>
   <span class="nx">$</span><span class="p">(</span><span class="dl">'</span><span class="s1">#update</span><span class="dl">'</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
       <span class="kd">var</span> <span class="nx">jsonData</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="dl">"</span><span class="s2">#form</span><span class="dl">"</span><span class="p">).</span><span class="nx">serializeObject</span><span class="p">();</span>
       <span class="kd">var</span> <span class="nx">idx</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByName</span><span class="p">(</span><span class="dl">"</span><span class="s2">idx</span><span class="dl">"</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">value</span><span class="p">;</span>

       <span class="c1">// 게시글 수정</span>
       <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
           <span class="na">url</span><span class="p">:</span> <span class="dl">"</span><span class="s2">http://localhost:8081/api/notice-boards/</span><span class="dl">"</span> <span class="o">+</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByName</span><span class="p">(</span><span class="dl">"</span><span class="s2">idx</span><span class="dl">"</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">value</span><span class="p">,</span>
           <span class="na">type</span><span class="p">:</span> <span class="dl">"</span><span class="s2">put</span><span class="dl">"</span><span class="p">,</span>
           <span class="na">data</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">jsonData</span><span class="p">),</span>
           <span class="na">dataType</span><span class="p">:</span> <span class="dl">"</span><span class="s2">text</span><span class="dl">"</span><span class="p">,</span>
           <span class="na">contentType</span><span class="p">:</span> <span class="dl">"</span><span class="s2">application/json</span><span class="dl">"</span><span class="p">,</span>
           <span class="na">async</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
       <span class="p">})</span>
           <span class="p">.</span><span class="nx">done</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">msg</span><span class="p">)</span> <span class="p">{</span>
               <span class="nx">exit</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

           <span class="p">})</span>
           <span class="p">.</span><span class="nx">fail</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">msg</span><span class="p">)</span> <span class="p">{</span>
               <span class="nx">exit</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
           <span class="p">});</span>

       <span class="k">if</span> <span class="p">(</span><span class="nx">exit</span><span class="p">)</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>

       <span class="c1">// 만일 파일이 수정되지 않은 경우 '파일 업로드' 및 '파일 삭제'를 수행하지 않음</span>
       <span class="k">if</span> <span class="p">(</span><span class="nx">insertFileArray</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">deleteFileArray</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
           <span class="nx">location</span><span class="p">.</span><span class="nx">href</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">/notice-board?idx=</span><span class="dl">'</span> <span class="o">+</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByName</span><span class="p">(</span><span class="dl">"</span><span class="s2">idx</span><span class="dl">"</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">value</span><span class="p">;</span>
       <span class="p">}</span>

       <span class="c1">// 파일 삭제</span>
       <span class="k">if</span> <span class="p">(</span><span class="nx">deleteFileArray</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
           <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
               <span class="na">url</span><span class="p">:</span> <span class="dl">"</span><span class="s2">http://localhost:8081/api/notice-boards/attachedFile</span><span class="dl">"</span><span class="p">,</span>
               <span class="na">type</span><span class="p">:</span> <span class="dl">"</span><span class="s2">delete</span><span class="dl">"</span><span class="p">,</span>
               <span class="na">data</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">deleteFileArray</span><span class="p">),</span>
               <span class="na">contentType</span><span class="p">:</span> <span class="dl">"</span><span class="s2">application/json</span><span class="dl">"</span><span class="p">,</span>
               <span class="na">async</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
           <span class="p">})</span>
               <span class="p">.</span><span class="nx">done</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">msg</span><span class="p">)</span> <span class="p">{</span>
                   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">AttachedFile delete success.</span><span class="dl">"</span><span class="p">);</span>
                   <span class="nx">exit</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
               <span class="p">})</span>
               <span class="p">.</span><span class="nx">fail</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">msg</span><span class="p">)</span> <span class="p">{</span>
                   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">AttachedFile delete fail.</span><span class="dl">"</span><span class="p">);</span>
                   <span class="nx">exit</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
               <span class="p">});</span>
       <span class="p">}</span>

       <span class="k">if</span> <span class="p">(</span><span class="nx">exit</span><span class="p">)</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>

       <span class="k">if</span> <span class="p">(</span><span class="nx">insertFileArray</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="nx">location</span><span class="p">.</span><span class="nx">href</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">/notice-board?idx=</span><span class="dl">"</span> <span class="o">+</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByName</span><span class="p">(</span><span class="dl">"</span><span class="s2">idx</span><span class="dl">"</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">value</span><span class="p">;</span>

       <span class="c1">// 파일 업로드</span>
       <span class="kd">var</span> <span class="nx">formData</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">FormData</span><span class="p">();</span>

       <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">insertFileArray</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
           <span class="nx">formData</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="dl">"</span><span class="s2">files</span><span class="dl">"</span><span class="p">,</span> <span class="nx">insertFileArray</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
       <span class="p">}</span>

       <span class="nx">formData</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="dl">"</span><span class="s2">idx</span><span class="dl">"</span><span class="p">,</span> <span class="nx">idx</span><span class="p">);</span>

       <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
           <span class="na">url</span><span class="p">:</span> <span class="dl">"</span><span class="s2">http://localhost:8081/api/notice-boards/attachedFile</span><span class="dl">"</span><span class="p">,</span>
           <span class="na">type</span><span class="p">:</span> <span class="dl">"</span><span class="s2">post</span><span class="dl">"</span><span class="p">,</span>
           <span class="na">data</span><span class="p">:</span> <span class="nx">formData</span><span class="p">,</span>
           <span class="na">dataType</span><span class="p">:</span> <span class="dl">"</span><span class="s2">text</span><span class="dl">"</span><span class="p">,</span>
           <span class="na">enctype</span><span class="p">:</span> <span class="dl">'</span><span class="s1">multipart/form-data</span><span class="dl">'</span><span class="p">,</span>
           <span class="na">processData</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
           <span class="na">contentType</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
           <span class="na">async</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
       <span class="p">})</span>
           <span class="p">.</span><span class="nx">done</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">msg</span><span class="p">)</span> <span class="p">{</span>
               <span class="nx">location</span><span class="p">.</span><span class="nx">href</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">/notice-board?idx=</span><span class="dl">"</span> <span class="o">+</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByName</span><span class="p">(</span><span class="dl">"</span><span class="s2">idx</span><span class="dl">"</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">value</span><span class="p">;</span>
           <span class="p">})</span>
           <span class="p">.</span><span class="nx">fail</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">msg</span><span class="p">)</span> <span class="p">{</span>

           <span class="p">})</span>

   <span class="p">});</span>
<span class="nt">&lt;/script&gt;</span>

<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></table></code></div></div><p><br /></p><ul><li>업로드된 파일 데이터를 클릭하면 api 서버가 요청에 응답하여, 파일을 다운로드 한다.</ul><div class="language-html highlighter-rouge"><div class="code-header"> <span text-data=" HTML "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="nt">&lt;module-app-web</span><span class="err">/</span><span class="na">src</span><span class="err">/</span><span class="na">main</span><span class="err">/</span><span class="na">resources</span><span class="err">/</span><span class="na">templates</span><span class="err">/</span><span class="na">noticeBoard</span><span class="err">/</span><span class="na">read.html</span><span class="nt">&gt;</span>

<span class="nt">&lt;tr&gt;</span>
   <span class="nt">&lt;th&gt;</span>Uploaded Attached File<span class="nt">&lt;/th&gt;</span>
   <span class="nt">&lt;td&gt;</span>
       <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"attachedFileList"</span> <span class="na">th:each=</span><span class="s">"attachedFile : *{attachedFileList}"</span><span class="nt">&gt;</span>
           <span class="nt">&lt;span</span> <span class="na">th:attr=</span><span class="s">"onclick=|location.href='http://localhost:8081/api/attachedFiles/download/${attachedFile.savedFileName}'|"</span>
                 <span class="na">th:text=</span><span class="s">"${attachedFile.fileName} + ',&amp;nbsp;' + 'File size: ' + ${attachedFile.fileSize}"</span><span class="nt">&gt;&lt;/span&gt;</span>
       <span class="nt">&lt;/div&gt;</span>
   <span class="nt">&lt;/td&gt;</span>
<span class="nt">&lt;/tr&gt;</span>
</pre></table></code></div></div><h2 id="util">Util</h2><ul><li>Java: 파일 업로드할 때 저장되는 파일의 크기 단위를 변경한다.</ul><div class="language-java highlighter-rouge"><div class="code-header"> <span text-data=" Java "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="n">module</span><span class="o">-</span><span class="n">system</span><span class="o">-</span><span class="n">common</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">java</span><span class="o">/</span><span class="n">kr</span><span class="o">/</span><span class="n">ac</span><span class="o">/</span><span class="n">univ</span><span class="o">/</span><span class="n">util</span><span class="o">/</span><span class="nc">FileUtil</span><span class="o">.</span><span class="na">java</span><span class="o">&gt;</span>

<span class="kn">package</span> <span class="nn">kr.ac.univ.util</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.text.DecimalFormat</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">FileUtil</span> <span class="o">{</span>
   <span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="nf">getExtension</span><span class="o">(</span><span class="nc">String</span> <span class="n">fileName</span><span class="o">)</span> <span class="o">{</span>
       <span class="k">return</span> <span class="o">(</span><span class="n">fileName</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="n">fileName</span><span class="o">.</span><span class="na">lastIndexOf</span><span class="o">(</span><span class="s">"."</span><span class="o">))).</span><span class="na">toLowerCase</span><span class="o">();</span>
   <span class="o">}</span>

   <span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="nf">convertFileSize</span><span class="o">(</span><span class="kt">long</span> <span class="n">fileSize</span><span class="o">)</span> <span class="o">{</span>
       <span class="nc">String</span> <span class="n">retFormat</span> <span class="o">=</span> <span class="s">"0"</span><span class="o">;</span>
       <span class="nc">String</span><span class="o">[]</span> <span class="n">s</span> <span class="o">=</span> <span class="o">{</span> <span class="s">"bytes"</span><span class="o">,</span> <span class="s">"KB"</span><span class="o">,</span> <span class="s">"MB"</span><span class="o">,</span> <span class="s">"GB"</span><span class="o">,</span> <span class="s">"TB"</span><span class="o">,</span> <span class="s">"PB"</span> <span class="o">};</span>
       <span class="nc">DecimalFormat</span> <span class="n">df</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DecimalFormat</span><span class="o">(</span><span class="s">"#,###.##"</span><span class="o">);</span>

       <span class="k">if</span> <span class="o">(</span><span class="n">fileSize</span> <span class="o">!=</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
           <span class="kt">int</span> <span class="n">idx</span> <span class="o">=</span> <span class="o">(</span><span class="kt">int</span><span class="o">)</span> <span class="nc">Math</span><span class="o">.</span><span class="na">floor</span><span class="o">(</span><span class="nc">Math</span><span class="o">.</span><span class="na">log</span><span class="o">(</span><span class="n">fileSize</span><span class="o">)</span> <span class="o">/</span> <span class="nc">Math</span><span class="o">.</span><span class="na">log</span><span class="o">(</span><span class="mi">1024</span><span class="o">));</span>
           <span class="kt">double</span> <span class="n">ret</span> <span class="o">=</span> <span class="o">((</span><span class="n">fileSize</span> <span class="o">/</span> <span class="nc">Math</span><span class="o">.</span><span class="na">pow</span><span class="o">(</span><span class="mi">1024</span><span class="o">,</span> <span class="nc">Math</span><span class="o">.</span><span class="na">floor</span><span class="o">(</span><span class="n">idx</span><span class="o">))));</span>
           <span class="n">retFormat</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="n">ret</span><span class="o">)</span> <span class="o">+</span> <span class="s">" "</span> <span class="o">+</span> <span class="n">s</span><span class="o">[</span><span class="n">idx</span><span class="o">];</span>
       <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
           <span class="n">retFormat</span> <span class="o">+=</span> <span class="s">" "</span> <span class="o">+</span> <span class="n">s</span><span class="o">[</span><span class="mi">0</span><span class="o">];</span>
       <span class="o">}</span>

       <span class="k">return</span> <span class="n">retFormat</span><span class="o">;</span>
   <span class="o">}</span>

<span class="o">}</span>
</pre></table></code></div></div><p><br /></p><ul><li>Javascript: 업로드 하는 파일의 크기 단위를 변경한다.(Byte 단위를 KB, MB 단위로 변경한다.)</ul><div class="language-javascript highlighter-rouge"><div class="code-header"> <span text-data=" JavaScript "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">module</span><span class="o">-</span><span class="nx">app</span><span class="o">-</span><span class="nx">web</span><span class="o">/</span><span class="nx">src</span><span class="o">/</span><span class="nx">main</span><span class="o">/</span><span class="nx">resources</span><span class="o">/</span><span class="kd">static</span><span class="sr">/js/</span><span class="nx">fileUtil</span><span class="p">.</span><span class="nx">js</span><span class="o">&gt;</span>

<span class="cm">/* 파일 크기 변환 */</span>
<span class="kd">function</span> <span class="nx">convertFileSize</span><span class="p">(</span><span class="nx">fileSize</span><span class="p">)</span> <span class="p">{</span>
   <span class="kd">var</span> <span class="nx">retFormat</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">0</span><span class="dl">"</span><span class="p">;</span>
   <span class="kd">var</span> <span class="nx">s</span> <span class="o">=</span> <span class="p">[</span><span class="dl">'</span><span class="s1">bytes</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">KB</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">MB</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">GB</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">TB</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">PB</span><span class="dl">'</span><span class="p">];</span>
   <span class="kd">var</span> <span class="nx">e</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">fileSize</span><span class="p">)</span> <span class="o">/</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">1024</span><span class="p">));</span>

   <span class="k">if</span> <span class="p">(</span><span class="nx">fileSize</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
       <span class="nx">retFormat</span> <span class="o">=</span> <span class="p">(</span><span class="nx">fileSize</span> <span class="o">/</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="nx">e</span><span class="p">)).</span><span class="nx">toFixed</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="dl">"</span><span class="s2"> </span><span class="dl">"</span> <span class="o">+</span> <span class="nx">s</span><span class="p">[</span><span class="nx">e</span><span class="p">];</span>
   <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
       <span class="nx">retFormat</span> <span class="o">=</span> <span class="nx">fileSize</span> <span class="o">+</span> <span class="dl">"</span><span class="s2"> </span><span class="dl">"</span> <span class="o">+</span> <span class="nx">s</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
   <span class="p">}</span>

   <span class="k">return</span> <span class="nx">retFormat</span><span class="p">;</span>
<span class="p">};</span>
</pre></table></code></div></div><p><br /></p><ul><li>Javascript: fileUtil.js 파일을 다른 파일에서 사용할 수 있도록 포함시킨다.</ul><div class="language-html highlighter-rouge"><div class="code-header"> <span text-data=" HTML "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="nt">&lt;module-app-web</span><span class="err">/</span><span class="na">src</span><span class="err">/</span><span class="na">main</span><span class="err">/</span><span class="na">resources</span><span class="err">/</span><span class="na">templates</span><span class="err">/</span><span class="na">layout</span><span class="err">/</span><span class="na">script.html</span><span class="nt">&gt;</span>

...
<span class="nt">&lt;script </span><span class="na">th:src=</span><span class="s">"@{/js/fileUtil.js}"</span><span class="nt">&gt;&lt;/script&gt;</span>
...
</pre></table></code></div></div><h2 id="프로젝트-실행-결과">프로젝트 실행 결과</h2><ul><li>NoticeBoard form 페이지에서 파일을 업로드 하면 다음 이미지 처럼 프로젝트의 upload 폴더에 파일이 업로드 된다.</ul><p><img data-proofer-ignore data-src="/assets/img/2020-08-05-Project Lab8/image1.png" alt="image" /></p><p><img data-proofer-ignore data-src="/assets/img/2020-08-05-Project Lab8/image2.png" alt="image" /></p><p><br /></p><ul><li>드래그앤드랍으로 파일을 이동시키는 경우 파일 업로드가 된다.<li>첨부 파일의 삭제(X 버튼 클릭) 클릭한 경우 업로드 하는 파일이 취소되며, 해당 상태에서 Update 버튼을 클릭하면 upload 폴더에 실제 파일이 삭제된다.</ul><p><img data-proofer-ignore data-src="/assets/img/2020-08-05-Project Lab8/image3.png" alt="image" /></p><p><img data-proofer-ignore data-src="/assets/img/2020-08-05-Project Lab8/image4.png" alt="image" /></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/web/'>Web</a>, <a href='/categories/project-lab/'>Project Lab</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Project Lab 8. 게시판 개발(파일 업로드 및 다운로드) - 5 - 끄적이판&url=https://scribnote5.github.io/posts/Project-Lab8/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Project Lab 8. 게시판 개발(파일 업로드 및 다운로드) - 5 - 끄적이판&u=https://scribnote5.github.io/posts/Project-Lab8/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Project Lab 8. 게시판 개발(파일 업로드 및 다운로드) - 5 - 끄적이판&url=https://scribnote5.github.io/posts/Project-Lab8/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/MISRA-C3/">함수 호출 인자 및 함수 매개변수의 한정자 관계</a><li><a href="/posts/Project-SW-Test-Forum17/">Project SW Test Forum 17. 유지보수 - 5</a><li><a href="/posts/Project-SW-Test-Forum16/">Project SW Test Forum 16. 유지보수 - 4</a><li><a href="/posts/MISRA-C-02-03/">MISRA C 2012_02_03 - 사용하지 않는 자료형 선언 제거</a><li><a href="/posts/MISRA-C-02-04/">MISRA C 2012_02_04 - 사용하지 않는 태그(struct, union, enum) 선언 제거</a></ul></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Project-Lab0/"><div class="card-body"> <span class="timeago small" >Apr 14, 2020<i class="unloaded">2020-04-14T00:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Project Lab 0. 연구실 홈페이지 개발 프로젝트 소개</h3><div class="text-muted small"><p> 연구실 홈페이지 개발 프로젝트를 소개한다. 계기 대학원 재학 중일 때 노후화된 연구실 홈페이지 유지보수를 담당하였다. 연구실 홈페이지는 난잡하게 개발되어 있었고 관련 문서가 하나도 없었기에 유지보수에 큰 어려움을 겪었다. 과거 회사 재직 중일 때 Spring을 사용하여 업무 시스템을 개발한 경험이 있다. 당시 초급 개발자로서 요구사항...</p></div></div></a></div><div class="card"> <a href="/posts/Project-Lab1-1/"><div class="card-body"> <span class="timeago small" >Jul 15, 2020<i class="unloaded">2020-07-15T00:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Project Lab 1-1. 개발 환경 구축(IntelliJ)</h3><div class="text-muted small"><p> 연구실 홈페이지 개발 프로젝트의 인텔리제이 개발 환경 구축 과정을 소개한다. 이클립스를 사용하여 개발 환경을 구축 한다면 ‘Project Lab 1-1. 개발 환경 구축(IntelliJ)’ 게시글을 참고하면 된다. 개발 환경 Windows 10 64bit jdk11.0.7 IntelliJ Ultimate 2021.1 프로젝...</p></div></div></a></div><div class="card"> <a href="/posts/Project-Lab1-2/"><div class="card-body"> <span class="timeago small" >Jul 15, 2020<i class="unloaded">2020-07-15T00:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Project Lab 1-2. 개발 환경 구축(Eclipse)</h3><div class="text-muted small"><p> 연구실 홈페이지 개발 프로젝트의 이클립스 개발 환경 구축 과정을 소개한다. 인텔리제이 사용하여 개발 환경을 구축 한다면 ‘Project Lab 1-1. 개발 환경 구축(IntelliJ)’’ 게시글을 참고하면 된다. 개발 환경 Windows 10 64bit jdk11.0.7 Spring Tools 4 for Eclipse(sts...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/MISRA-CPP1/" class="btn btn-outline-primary" prompt="Older"><p>MISRA C++ 2008 가이드라인 개요</p></a> <a href="/posts/MISRA-CPP2/" class="btn btn-outline-primary" prompt="Newer"><p>MISRA C++ 2008 가이드라인 표기 방식</p></a></div><div id="disqus_thread" class="pt-2 pb-2"><p class="text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script type="text/javascript"> var disqus_config = function () { this.page.url = 'https://scribnote5.github.io/posts/Project-Lab8/'; this.page.identifier = '/posts/Project-Lab8/'; }; /* Lazy loading */ var disqus_observer = new IntersectionObserver(function (entries) { if(entries[0].isIntersecting) { (function () { var d = document, s = d.createElement('script'); s.src = 'https://scribnote5-github-io.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); disqus_observer.disconnect(); } }, { threshold: [0] }); disqus_observer.observe(document.querySelector('#disqus_thread')); /* Auto switch theme */ function reloadDisqus() { /* Disqus hasn't been loaded */ if (typeof DISQUS === "undefined") { return; } if (document.readyState == 'complete') { DISQUS.reset({ reload: true, config: disqus_config }); } } const modeToggle = document.querySelector(".mode-toggle"); if (modeToggle !== null) { modeToggle.addEventListener('click', reloadDisqus); window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', reloadDisqus); } </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://github.com/scribnote5">scribnote5</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
